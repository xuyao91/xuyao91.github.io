<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[è€å¾]]></title>
  <link href="http://xuyao.club/atom.xml" rel="self"/>
  <link href="http://xuyao.club/"/>
  <updated>2019-02-15T16:04:30+08:00</updated>
  <id>http://xuyao.club/</id>
  <author>
    <name><![CDATA[Peter Xu]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[ES6ä¸­å¦‚ä½•åˆ é™¤æ•°ç»„ä¸­çš„é‡å¤é¡¹]]></title>
    <link href="http://xuyao.club/blog/2019/02/15/how-to-remove-array-duplicates-in-es6/"/>
    <updated>2019-02-15T16:00:59+08:00</updated>
    <id>http://xuyao.club/blog/2019/02/15/how-to-remove-array-duplicates-in-es6</id>
    <content type="html"><![CDATA[<p>&emsp; ES6ä¸­ï¼Œå¦‚ä½•åˆ é™¤ä¸€ä¸ªæ•°ç»„ä¸­çš„é‡å¤æ•°æ®å‘¢ï¼Œä»¥ä¸‹æ˜¯æˆ‘æ€»ç»“çš„ï¼Œä»æ•°ç»„ä¸­è¿‡æ»¤æ‰é‡å¤é¡¹å¹¶ä¸”è¿”å›å”¯ä¸€å€¼çš„ä¸‰ç§æ–¹æ³•ã€‚æˆ‘æœ€å–œæ¬¢çš„æ˜¯ä½¿ç”¨Setå› ä¸ºå®ƒæ˜¯æœ€ç®€å•å’Œæœ€ç®€å•çš„ğŸ˜</p>

<!-- more -->


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>const array = ['ğŸ·',1, 2,'ğŸ·','ğŸ·', 3]
</span><span class='line'>
</span><span class='line'>// 1: 'Set'
</span><span class='line'>[... new Set(array)]
</span><span class='line'>
</span><span class='line'>// 2: 'Filter'
</span><span class='line'>array.filter((item, index) =&gt; array.indexOf(item) === index)
</span><span class='line'>
</span><span class='line'>// 3: 'Reduce'
</span><span class='line'>array.reduce((unique, item) =&gt; unique.includes(item) ? unique : [...unique, item], [])
</span><span class='line'>
</span><span class='line'>// è¿”å›ç»“æœ
</span><span class='line'>[ 'ğŸ·', 1, 2, 3 ]</span></code></pre></td></tr></table></div></figure>


<h4>1. ä½¿ç”¨Set</h4>

<p>æˆ‘å…ˆè§£é‡Šä¸€ä¸‹ä»€ä¹ˆæ˜¯Set:</p>

<blockquote><p>Setæ˜¯ES6ä¸­å¼•å…¥çš„æ–°æ•°æ®å¯¹è±¡ã€‚Setåªå…è®¸æ‚¨å­˜å‚¨å”¯ä¸€å€¼ã€‚å½“ä¼ å…¥æ•°ç»„æ—¶ï¼Œå®ƒä¼šåˆ é™¤ä»»ä½•é‡å¤çš„å€¼ã€‚</p></blockquote>

<p>okï¼Œæˆ‘ä»¬é‡æ–°å›åˆ°åˆšæ‰çš„ä»£ç æ¥åˆ†æä¸€ä¸‹å‘ç”Ÿäº†ä»€ä¹ˆäº‹æƒ…ï¼Œï¼ˆä¸Šé¢çš„ä»£ç ï¼‰åšäº†ä¸¤ä»¶äº‹æƒ…ã€‚
1ã€é¦–å…ˆï¼Œæˆ‘ä»¬é€šè¿‡ä¼ é€’ä¸€ä¸ªæ•°ç»„æ¥åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„Setï¼Œå› ä¸ºSetåªå…è®¸å­˜å‚¨å”¯ä¸€çš„å€¼ï¼Œæ‰€ä»¥æ•°ç»„ä¸­é‚£äº›é‡å¤çš„å€¼ä¼šè¢«åˆ é™¤ã€‚
2ã€åˆ›å»ºä¸€ä¸ªæ–°çš„Setå¯¹è±¡åï¼Œé‡å¤å€¼å·²ç»è¢«åˆ é™¤äº†ï¼Œç°åœ¨æˆ‘ä»¬ä½¿ç”¨&hellip;è¿ç®—ç¬¦ï¼Œå°†å…¶è½¬æ¢å›æ•°ç»„ã€‚</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>const array = ['ğŸ·',1, 2,'ğŸ·','ğŸ·', 3]
</span><span class='line'>
</span><span class='line'>// Step 1
</span><span class='line'>const uniqueSet = new Set(array)
</span><span class='line'># Set { 'ğŸ·', 1, 2, 3 }
</span><span class='line'>
</span><span class='line'>// Step 2
</span><span class='line'>const backToArray = [...uniqueSet]
</span><span class='line'># [ 'ğŸ·', 1, 2, 3 ]</span></code></pre></td></tr></table></div></figure>


<h5>ä½¿ç”¨Array.from å°†Setè½¬æ¢ä¸ºArray</h5>

<p>æˆ–è€…ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨Array.fromå°†Setè½¬åŒ–ä¸ºæ•°ç»„</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>const array = ['ğŸ·',1, 2,'ğŸ·','ğŸ·', 3]
</span><span class='line'>
</span><span class='line'>Array.from(new Set(array))
</span><span class='line'># [ 'ğŸ·', 1, 2, 3 ]</span></code></pre></td></tr></table></div></figure>


<h4>2.ä½¿ç”¨Filter</h4>

<p>ä¸ºäº†ä¾¿äºç†è§£ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹ä¸‹indexOfå’Œfilterä¼šåšä»€ä¹ˆäº‹æƒ…</p>

<h5>indexOf</h5>

<p>indexOfæ–¹æ³•ä¼šå°†æˆ‘ä»¬æä¾›çš„å‚æ•°ï¼Œåœ¨æ•°ç»„ä¸­æ‰¾åˆ°è¯¥å…ƒç´ çš„ç¬¬ä¸€ä¸ªç´¢å¼•å€¼å¹¶è¿”å›ã€‚</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>const array = ['ğŸ·',1, 2,'ğŸ·','ğŸ·', 3]
</span><span class='line'>
</span><span class='line'>array.indexOf('ğŸ·') #=&gt; 0
</span><span class='line'>array.indexOf(1) #=&gt; 1
</span><span class='line'>array.indexOf(2) #=&gt; 2
</span><span class='line'>array.indexOf(3) #=&gt; 5</span></code></pre></td></tr></table></div></figure>


<h4>filter</h4>

<p>filter()æ–¹æ³•ä¼šæ ¹æ®æˆ‘ä»¬ä¼ é€’çš„æ¡ä»¶ï¼Œæ¥åˆ›å»ºä¸€ä¸ªæ–°çš„å…ƒç´ æ•°ç»„ã€‚æ¢å¥è¯è¯´ï¼Œå¦‚æœå…ƒç´ é€šè¿‡å¹¶è¿”å›trueï¼Œå®ƒå°†åŒ…å«åœ¨å·²ç»è¿‡æ»¤çš„æ•°ç»„ä¸­ã€‚ä»»ä½•å¤±è´¥å…ƒç´ æˆ–è€…è¿”å›ä¸ºfalseçš„ï¼Œéƒ½ä¸ä¼šåœ¨è¿‡æ»¤åçš„æ•°ç»„ä¸­ã€‚
è®©æˆ‘ä»¬ä¸€æ­¥æ­¥æ¥åˆ†ææ•°ç»„å¾ªç¯æ—¶å‘ç”Ÿçš„äº‹æƒ…</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>const array = ['ğŸ·',1, 2,'ğŸ·','ğŸ·', 3]
</span><span class='line'>
</span><span class='line'>array.filter((item, index) =&gt; {
</span><span class='line'>  console.log(
</span><span class='line'>      // a. Item
</span><span class='line'>      item,
</span><span class='line'>      // b. Index
</span><span class='line'>      index,
</span><span class='line'>      // c. IndexOf
</span><span class='line'>      array.indexOf(item),
</span><span class='line'>      // d. Condition
</span><span class='line'>      array.indexOf(item) === index,
</span><span class='line'>  );
</span><span class='line'>  return array.indexOf(item) === index
</span><span class='line'>})</span></code></pre></td></tr></table></div></figure>


<p>ä»¥ä¸‹æ˜¯ä¸Šé¢æ˜¾ç¤ºçš„console.logçš„è¾“å‡ºã€‚é‡å¤é¡¹æ˜¯ç´¢å¼•ä¸indexOfä¸åŒ¹é…çš„ä½ç½®ã€‚å› æ­¤ï¼Œåœ¨è¿™äº›æƒ…å†µä¸‹ï¼Œæ¡ä»¶å°†ä¸ºfalseï¼Œä¸ä¼šåŒ…å«åœ¨æˆ‘ä»¬çš„è¿‡æ»¤æ•°ç»„ä¸­ã€‚
<img src="https://upload-images.jianshu.io/upload_images/1796624-e1340356c5bd98fe.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png" /></p>

<h4>æ£€ç´¢é‡å¤å€¼</h4>

<p>æˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨filteræ–¹æ³•ä»æ•°ç»„ä¸­æ£€ç´¢é‡å¤å€¼ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ç®€å•åœ°ä¿®æ”¹æˆ‘ä»¬çš„æ¡ä»¶å°±å¯ä»¥åšåˆ°ï¼š</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>const array = ['ğŸ·',1, 2,'ğŸ·','ğŸ·', 3]
</span><span class='line'>array.filter((item, index) =&gt; array.indexOf(item) !== index)
</span><span class='line'># [ 'ğŸ·', 'ğŸ·' ]</span></code></pre></td></tr></table></div></figure>


<p>å†æ¬¡ï¼Œå¦‚æœæˆ‘ä»¬ä¸€æ­¥ä¸€æ¥æ‰§è¡Œä¸Šé¢çš„ä»£ç ï¼Œå¯ä»¥æŸ¥çœ‹è¾“å‡ºï¼š
<img src="https://upload-images.jianshu.io/upload_images/1796624-37f124574645e5c6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png" /></p>

<h4>3.ä½¿ç”¨ reduce</h4>

<p>reduceæ–¹æ³•ç”¨äºå‡å°‘æ•°ç»„çš„å…ƒç´ ï¼Œå¹¶æ ¹æ®æ‚¨ä¼ é€’çš„æŸäº›reducerå‡½æ•°å°†å®ƒä»¬ç»„åˆæˆæœ€ç»ˆæ•°ç»„ã€‚</p>

<p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬çš„reducerå‡½æ•°æ£€æŸ¥æˆ‘ä»¬çš„æœ€ç»ˆæ•°ç»„æ˜¯å¦åŒ…å«è¯¥é¡¹ã€‚å¦‚æœæ²¡æœ‰ï¼Œè¯·å°†è¯¥é¡¹ç›®æ¨é€åˆ°æˆ‘ä»¬çš„æœ€ç»ˆæ•°ç»„ä¸­ã€‚å¦åˆ™ï¼Œè·³è¿‡è¯¥å…ƒç´ å¹¶æŒ‰åŸæ ·è¿”å›æˆ‘ä»¬çš„æœ€ç»ˆæ•°ç»„ï¼ˆåŸºæœ¬ä¸Šè·³è¿‡è¯¥å…ƒç´ ï¼‰ã€‚</p>

<p>reduceæ€»æ˜¯æœ‰ç‚¹éš¾ä»¥ç†è§£ï¼Œæ‰€ä»¥è®©æˆ‘ä»¬è¿›å…¥æ¯ä¸ªæ¡ˆä¾‹å¹¶æŸ¥çœ‹è¾“å‡ºï¼š</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>array.reduce((unique, item) =&gt; {
</span><span class='line'>  console.log(
</span><span class='line'>      // a. Item
</span><span class='line'>      item,
</span><span class='line'>      // b. Final Array (Accumulator)
</span><span class='line'>      unique,
</span><span class='line'>      // c. Condition (Remember it only get pushed if this return 'false')
</span><span class='line'>      unique.includes(item),
</span><span class='line'>      // d. Reducer Function Result
</span><span class='line'>      unique.includes(item) ? unique : [...unique, item],
</span><span class='line'>  );
</span><span class='line'>  unique.includes(item) ? unique : [...unique, item]
</span><span class='line'>}, [])
</span><span class='line'>
</span><span class='line'># [ 'ğŸ·', 'ğŸ·' ]</span></code></pre></td></tr></table></div></figure>


<p>è¿™æ˜¯console.logçš„è¾“å‡ºï¼š
<img src="https://upload-images.jianshu.io/upload_images/1796624-8de3d95d35e6bf25.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png" /></p>

<h4>å‚è€ƒèµ„æ–™</h4>

<ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Set">MDN Web Docsâ€Šâ€”â€ŠSet</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/filter">MDN Web Docsâ€Šâ€”â€ŠFilter</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/reduce">MDN Web Docsâ€Šâ€”â€ŠReduce</a></li>
<li><a href="https://gist.github.com/telekosmos/3b62a31a5c43f40849bb">GitHubGist: Remove duplicates from JS array</a></li>
<li><a href="https://codehandbook.org/how-to-remove-duplicates-from-javascript-array/">CodeHandbook: How to Remove Duplicates from JavaScript Array</a></li>
</ul>


<h4>è¯´æ˜</h4>

<p>æœ¬æ–‡ç¿»è¯‘è‡ª<a href="https://medium.com/@samanthaming">Samantha Ming</a>çš„åšå®¢ï¼ŒåŸæ–‡åœ°å€<br/>
<a href="https://medium.com/dailyjs/how-to-remove-array-duplicates-in-es6-5daa8789641c">https://medium.com/dailyjs/how-to-remove-array-duplicates-in-es6-5daa8789641c</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[FabricåŠ¨æ€å¢åŠ èŠ‚ç‚¹ï¼ˆPeerï¼‰]]></title>
    <link href="http://xuyao.club/blog/2019/01/10/fabric-adds-nodes-dynamically/"/>
    <updated>2019-01-10T11:00:22+08:00</updated>
    <id>http://xuyao.club/blog/2019/01/10/fabric-adds-nodes-dynamically</id>
    <content type="html"><![CDATA[<h5>å‰è¨€</h5>

<p> &emsp; åœ¨å®é™…é¡¹ç›®ä¸­ï¼Œå› ä¸ºé¡¹ç›®çš„éœ€æ±‚å˜åŠ¨ï¼Œä¸€èˆ¬éƒ½ä¼šå¯¹fabricç½‘ç»œåšä¸€ä¸ªä¿®æ”¹ï¼Œæœ€å¸¸è§çš„å˜åŠ¨å°±æ˜¯åœ¨ç°æœ‰çš„Fabricç½‘ç»œä¸­å¢åŠ ä¸€ä¸ªèŠ‚ç‚¹ï¼Œç°åœ¨ä»¥ä¹‹å‰æ­å»ºçš„fabricç½‘ç»œï¼ˆç‰ˆæœ¬1.1ï¼‰ï¼Œbalance-transferä¸ºä¾‹åšä¸ªä»‹ç»ï¼Œæ•´ä¸ªè¿‡ç¨‹å…¶å®ä¹Ÿå¾ˆç®€å•ï¼Œç”ŸæˆèŠ‚ç‚¹è¯ä¹¦ï¼Œå¢åŠ æ–°èŠ‚ç‚¹çš„dockeré…ç½®æ–‡ä»¶å¹¶å¯åŠ¨ç›¸åº”çš„æœåŠ¡ï¼Œç„¶åå°†æ–°èŠ‚ç‚¹åŠ åˆ°ç°æœ‰çš„channelå½“ä¸­ï¼Œå¹¶åœ¨èŠ‚ç‚¹ä¸Šå®‰è£…æ™ºèƒ½åˆçº¦ï¼ˆChaincodeï¼‰ï¼Œä¸‹åˆè¯¦æƒ…è®²ä¸€ä¸‹å…·ä½“çš„æ“ä½œæ­¥éª¤ã€‚</p>

<h4>1ã€ä¿®æ”¹crypto-config.yamlæ–‡ä»¶å¹¶ç”Ÿæˆå¯¹åº”çš„èŠ‚ç‚¹è¯ä¹¦ã€‚</h4>

<p>é¦–å…ˆæˆ‘ä»¬ç¡®è®¤æˆ‘ä»¬éœ€è¦åœ¨Org2é‡Œå¢åŠ èŠ‚ç‚¹ï¼Œé‚£ä¹ˆæˆ‘ä»¬åœ¨crypto-config.yamlæ–‡ä»¶é‡Œæ‰¾åˆ°å¯¹åº”Org2çš„é…ç½®ï¼ŒæŠŠTemplateå­—æ®µé‡Œçš„countå‚æ•°ä¿®æ”¹æˆ2ï¼Œæ„æ€å°±æ˜¯åœ¨æ­¤ç»„ç»‡ä¸‹ç”Ÿæˆä¸¤ä¸ªèŠ‚ç‚¹ï¼Œé…ç½®æ–‡ä»¶å¦‚ä¸‹</p>

<!-- more -->


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>- Name: Org2
</span><span class='line'>    Domain: org2.xuyao.com
</span><span class='line'>    EnableNodeOUs: true
</span><span class='line'>    Template:
</span><span class='line'>      Count: 2
</span><span class='line'>    Users:
</span><span class='line'>      Count: 1</span></code></pre></td></tr></table></div></figure>


<p>ä¿®æ”¹å¥½é…ç½®æ–‡ä»¶åï¼Œæˆ‘ä»¬ç°åœ¨ä½¿ç”¨cryptogenæ¥ç”Ÿæˆè¯ä¹¦ï¼Œåœ¨åœ¨artifacts/channelç›®å½•ä¸‹æ‰§è¡Œï¼š</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>./cryptogen extend --config=./crypto-config.yaml</span></code></pre></td></tr></table></div></figure>


<p>è¿™æ ·æˆ‘ä»¬å°±ä¸ºæ–°èŠ‚ç‚¹ç”Ÿæˆäº†è¯ä¹¦ï¼Œå¯ä»¥åˆ°Org2ç›¸åº”çš„ç›®å½•ä¸ŠæŸ¥çœ‹ï¼Œå‘ç°å·²ç»æ–°ç”Ÿæˆäº†ä¸€ä¸ªèŠ‚ç‚¹ï¼ŒåŠ ä¸Šä¹‹å‰é‚£ä¸ªï¼Œä¸€å…±æœ‰ä¸¤ä¸ªèŠ‚ç‚¹ã€‚</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>peer0.org2.mbasechain.com peer1.org2.mbasechain.com</span></code></pre></td></tr></table></div></figure>


<h4>2ã€é…ç½®docker-composeæ–‡ä»¶å¹¶å¯åŠ¨èŠ‚ç‚¹å®¹å™¨</h4>

<p>æ¥ä¸‹æ¥æˆ‘ä»¬éœ€è¦æ–°å¢ä¸€ä¸ªdoceker-composeæœ‰é…ç½®æ–‡ä»¶ï¼Œç”¨æ¥å¯åŠ¨ä¸€ä¸ªæ–°èŠ‚ç‚¹å®¹å™¨ï¼Œæˆ‘ä»¬å°†æ–°èŠ‚ç‚¹çš„é…ç½®æ–‡ä»¶å…¨åä¸ºï¼šOrg2Peer1.yaml</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>version: '2'
</span><span class='line'>
</span><span class='line'>services:
</span><span class='line'>
</span><span class='line'>  couchdb:
</span><span class='line'>    container_name: couchdb
</span><span class='line'>    image: hyperledger/fabric-couchdb:latest
</span><span class='line'>    ports:
</span><span class='line'>      - "5984:5984"
</span><span class='line'>
</span><span class='line'>  peer1.org1.xuyao.com:
</span><span class='line'>    container_name: peer1.org1.xuyao.com
</span><span class='line'>    image: hyperledger/fabric-peer:latest
</span><span class='line'>    environment:
</span><span class='line'>      - CORE_PEER_ID=peer1.org1.xuyao.com
</span><span class='line'>      - CORE_PEER_LOCALMSPID=Org1MSP
</span><span class='line'>      - CORE_PEER_ADDRESS=peer1.org1.xuyao.com:7051
</span><span class='line'>      - CORE_LEDGER_STATE_STATEDATABASE=CouchDB
</span><span class='line'>      - CORE_LEDGER_STATE_COUCHDBCONFIG_COUCHDBADDRESS=couchdb:5984
</span><span class='line'>      - CORE_VM_ENDPOINT=unix:///host/var/run/docker.sock
</span><span class='line'>      - CORE_VM_DOCKER_HOSTCONFIG_NETWORKMODE=artifacts_default
</span><span class='line'>      - CORE_LOGGING_LEVEL=debug
</span><span class='line'>      - CORE_PEER_GOSSIP_USELEADERELECTION=true
</span><span class='line'>      - CORE_PEER_GOSSIP_ORGLEADER=false
</span><span class='line'>      - GODEBUG=netdns=go
</span><span class='line'>      # The following setting skips the gossip handshake since we are
</span><span class='line'>      # are not doing mutual TLS
</span><span class='line'>      - CORE_PEER_GOSSIP_SKIPHANDSHAKE=true
</span><span class='line'>      - CORE_PEER_MSPCONFIGPATH=/etc/hyperledger/crypto/peer/msp
</span><span class='line'>      - CORE_PEER_TLS_ENABLED=true
</span><span class='line'>      - CORE_PEER_TLS_KEY_FILE=/etc/hyperledger/crypto/peer/tls/server.key
</span><span class='line'>      - CORE_PEER_TLS_CERT_FILE=/etc/hyperledger/crypto/peer/tls/server.crt
</span><span class='line'>      - CORE_PEER_TLS_ROOTCERT_FILE=/etc/hyperledger/crypto/peer/tls/ca.crt
</span><span class='line'>    working_dir: /opt/gopath/src/github.com/hyperledger/fabric/peer
</span><span class='line'>    command: peer node start
</span><span class='line'>    ports:
</span><span class='line'>      - 7051:7051
</span><span class='line'>      - 7053:7053
</span><span class='line'>    volumes:
</span><span class='line'>        - /var/run/:/host/var/run/
</span><span class='line'>        - ./channel/crypto-config/peerOrganizations/org1.mbasechain.com/peers/peer0.org1.xuyao.com/:/etc/hyperledger/crypto/peer
</span><span class='line'>        - ../mount/peer0.org1.xuyao.com/var/hyperledger/production:/var/hyperledger/production
</span><span class='line'>    depends_on:
</span><span class='line'>        - couchdb</span></code></pre></td></tr></table></div></figure>


<p>è¿™ä¸ªé…ç½®æ–‡ä»¶è·Ÿä¹‹å‰çš„peerèŠ‚ç‚¹çš„é…ç½®ä¸€æ ·ï¼Œåªè¦æ”¹ä¸‹ç›¸åº”çš„å‚æ•°å³å¯ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°±æ¥å¯åŠ¨è¿™ä¸ªèŠ‚ç‚¹ã€‚</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>docker-compose -f Org2Peer1.yaml up -d</span></code></pre></td></tr></table></div></figure>


<p>å¯åŠ¨è¿‡ç¨‹ä¹Ÿå’Œä¹‹å‰çš„ä¸€æ ·ã€‚</p>

<h4>3ã€ä¿®æ”¹network-config.jsoné…ç½®æ–‡ä»¶</h4>

<p>å¯åŠ¨èŠ‚ç‚¹åï¼Œæˆ‘ä»¬éœ€è¦é…ç½®network-config.jsonï¼Œè®©åº”ç”¨ä¸èŠ‚ç‚¹ä¹‹å‰é€šä¿¡ï¼Œåœ¨peersé‚£å—å¢åŠ ä¸€ä¸ªé€šè®¯èŠ‚ç‚¹å°±å¯ä»¥</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>peer1.org2.xuyao.com:
</span><span class='line'>    url: grpcs://127.0.0.1:10051
</span><span class='line'>    eventUrl: grpcs://127.0.0.1:10053
</span><span class='line'>    grpcOptions:
</span><span class='line'>      ssl-target-name-override: peer1.org2.xuyao.com
</span><span class='line'>    tlsCACerts:
</span><span class='line'>      path: artifacts/channel/crypto-config/peerOrganizations/org4.mbasechain.com/peers/peer1.org2.xuyao.com/tls/ca.crt</span></code></pre></td></tr></table></div></figure>


<p>ä¿®æ”¹é…ç½®åï¼Œæˆ‘ä»¬å¯åŠ¨balance-transfer,è¿è¡ŒrunApp.sh,å°†é¡¹ç›®è·‘èµ·æ¥ã€‚</p>

<h4>4ã€å°†æ–°èŠ‚ç‚¹åŠ å…¥åˆ°æ‰€éœ€çš„Channelä¸­</h4>

<p>æ¥ä¸‹æ¥æˆ‘ä»¬éœ€è¦å°†æ–°èŠ‚ç‚¹åŠ åˆ°æŸä¸ªChannelé‡Œï¼Œé¦–å…ˆæˆ‘ä»¬é€šè¿‡æ³¨å†Œæ¥å£ï¼Œåœ¨Org2é‡Œæ‹¿åˆ°ç”¨æˆ·çš„Token,å†æ‹¿æ­¤Tokenè¯·æ±‚ä¸­å…¥Channelæ¥å£</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>curl -s -X POST \
</span><span class='line'>  http://localhost:4000/channels/mychannel/peers \
</span><span class='line'>  -H "authorization: Bearer $ORG2_TOKEN" \
</span><span class='line'>  -H "content-type: application/json" \
</span><span class='line'>  -d '{
</span><span class='line'>  "peers": ["peer1.org2.xuyao.com"]
</span><span class='line'>}'</span></code></pre></td></tr></table></div></figure>


<h4>5ã€å®‰è£…Chaincode</h4>

<p>åŠ å…¥channelåï¼Œpeer3å·²ç»å¯ä»¥å‚ä¸è®°è´¦ï¼Œä½†æ˜¯ä¸èƒ½æŒ‡å®šè¯¥èŠ‚ç‚¹è¿›è¡ŒæŸ¥è¯¢æˆ–äº¤æ˜“ï¼Œè¿™æ—¶å€™éœ€è¦å‘èµ·è¯·æ±‚å®‰è£…chaincodeï¼š</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>curl -s -X POST \
</span><span class='line'>    http://localhost:$PORT/chaincodes \
</span><span class='line'>    -H "authorization: Bearer $ORG1_TOKEN" \
</span><span class='line'>    -H "content-type: application/json" \
</span><span class='line'>    -d '{
</span><span class='line'>    "peers": ["peer1.org2.xuyao.com"],
</span><span class='line'>    "chaincodeName":"mycc",
</span><span class='line'>    "chaincodePath":"github.com/example_cc",
</span><span class='line'>    "chaincodeVersion":"v0"
</span><span class='line'>  }'</span></code></pre></td></tr></table></div></figure>


<p>å®‰è£…æˆåŠŸåæŒ‡å®šæ–°èŠ‚ç‚¹è¿›è¡ŒæŸ¥è¯¢æˆ–äº¤æ˜“æ“ä½œï¼Œä¼šè‡ªåŠ¨ç”Ÿæˆè¯¥èŠ‚ç‚¹çš„chaincodeé•œåƒï¼Œå¹¶å¯åŠ¨å®¹å™¨è¿è¡Œchaincodeã€‚åœ¨å·²æœ‰ç»„ç»‡ä¸­æ–°åŠ èŠ‚ç‚¹çš„æ“ä½œåˆ°è¿™é‡Œå°±å…¨éƒ¨å®Œæˆäº†ï¼</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Fabricå¤šå°æœåŠ¡å™¨çš„éƒ¨ç½²(äº”)]]></title>
    <link href="http://xuyao.club/blog/2018/12/29/deployment-of-fabric-multiple-servers-iiiii/"/>
    <updated>2018-12-29T16:57:34+08:00</updated>
    <id>http://xuyao.club/blog/2018/12/29/deployment-of-fabric-multiple-servers-iiiii</id>
    <content type="html"><![CDATA[<h4>8ã€Fabric æµè§ˆå™¨çš„éƒ¨ç½²</h4>

<h6>8.1 ç¯å¢ƒå‡†å¤‡</h6>

<p>1ã€nodejså®‰è£…ï¼Œåœ¨ç¬¬1èŠ‚é‡Œå·²ç»è¯´è¿‡nodeçš„å®‰è£…ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯nodeç‰ˆæœ¬åº”è¯¥æ˜¯v9.xä»¥ä¸‹ã€‚<br/>
2ã€PostgreSQLçš„å®‰è£…ï¼Œæµè§ˆå™¨ä¼šæŠŠç›‘å¬åˆ°çš„æ•°æ®å­˜å‚¨åœ¨pgé‡Œï¼Œæ‰€ä»¥éœ€è¦å®‰è£…pgæ•°æ®ã€‚</p>

<!-- more -->


<p>ubuntuä½¿ç”¨ç›´æ¥å®‰è£…</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>sudo apt update
</span><span class='line'>sudo apt install postgresql postgresql-contrib</span></code></pre></td></tr></table></div></figure>


<p>å®‰è£…å¥½åï¼Œå¯ä»¥ä½¿ç”¨cliæŸ¥çœ‹ä¸€ä¸‹</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>#åˆ‡æ¢ç”¨æˆ·
</span><span class='line'>sudo -i -u postgres
</span><span class='line'>#è¿›å…¥æ§åˆ¶å°
</span><span class='line'>psql
</span><span class='line'>#é€€å‡º
</span><span class='line'>postgres=# \q</span></code></pre></td></tr></table></div></figure>


<p>3ã€å®‰è£…Jqï¼Œjqæ˜¯ä¸€ä¸ªè½»é‡çº§ä¸”çµæ´»çš„å‘½ä»¤è¡ŒJSONå¤„ç†å™¨ï¼Œå®‰è£…å¾ˆç®€å•ï¼Œè§å®˜ç½‘<a href="https://stedolan.github.io/jq/download/">https://stedolan.github.io/jq/download/</a></p>

<h5>8.2ã€ä¸‹è½½æµè§ˆå™¨æºç </h5>

<p>&emsp; åœ¨githubä¸Šä¸‹è½½fabric æµè§ˆå™¨çš„æºç ï¼Œ<a href="https://github.com/hyperledger/blockchain-explorer">https://github.com/hyperledger/blockchain-explorer</a>ï¼ŒæŠŠæºç æ‹‰ä¸‹æ¥ï¼Œæ ¹æ®è‡ªå·±çš„éœ€è¦é€‰æ‹©ä¸ç”¨çš„ç‰ˆæœ¬ï¼Œæˆ‘ç›®å‰ä½¿ç”¨çš„æ˜¯1.1ç‰ˆæœ¬ï¼Œæ‰€ä»¥æˆ‘åˆ‡æ¢åˆ°å¯¹åº”çš„1.1åˆ†æ”¯ä¸Šã€‚</p>

<h5>8.3ã€ä¿®æ”¹é…ç½®</h5>

<h6>8.3.1 é…ç½®postgresqlæ•°æ®åº“</h6>

<p>&emsp; è¿›å…¥ app/persistence/postgreSQL/db/æ–‡ä»¶å¤¹ï¼Œæ‰¾åˆ°pgconfig.jsoné…ç½®æ–‡ä»¶ï¼Œä¿®æ”¹è¿æ¥pgæ•°æ®åº“çš„é…ç½®ï¼Œé»˜è®¤é…ç½®ä¸º</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>{
</span><span class='line'>  "pg": {
</span><span class='line'>    "host": "127.0.0.1",
</span><span class='line'>    "port": "5432",
</span><span class='line'>    "database": "fabricexplorer",
</span><span class='line'>    "username": "hppoc",
</span><span class='line'>    "passwd": "password"
</span><span class='line'>  }
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p>ä¿®æ”¹æ”¯è¿è¡Œcreatedb.shè„šæœ¬æ–‡ä»¶ï¼Œåˆ›å»ºæµè§ˆå™¨æ‰€éœ€çš„æ•°æ®åº“å’Œè¡¨åã€‚</p>

<h6>8.3.2ã€é…ç½®å¯åŠ¨abricæµè§ˆå™¨æ–‡ä»¶</h6>

<p>è¿›å…¥ blockchain-explorer/app/platform/fabricï¼Œæ‰¾åˆ°å¯¹åº”çš„config.jsonæ–‡ä»¶ï¼Œé…ç½®å¯¹åº”çš„fabricç½‘ç»œä¿¡æ¯ï¼ŒåŒ…æ‹¬èŠ‚ç‚¹çš„è¯·æ±‚æ¥å£ï¼ŒåŠç›‘å¬æ¥å£ï¼Œä¸åŒæµè§ˆå™¨ç‰ˆæœ¬è¿™ä¸ªé…ç½®æ–‡ä»¶ä¸å¤ªä¸€æ ·ï¼Œ1.1ç‰ˆæœ¬çš„é…ç½®æ–‡ä»¶å¦‚ä¸‹ï¼š</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>{
</span><span class='line'>  "network-config": {
</span><span class='line'>    "org1": {
</span><span class='line'>      "name": "peerOrg1",
</span><span class='line'>      "mspid": "Org1MSP",
</span><span class='line'>      "peer1": {
</span><span class='line'>        "requests": "grpcs://localhost:7051",
</span><span class='line'>        "events": "grpcs://localhost:7053",
</span><span class='line'>        "server-hostname": "peer0.org1.mbasechain.com",
</span><span class='line'>        "tls_cacerts": "/Users/xuyao/Workspaces/trace_kingland/artifacts/channel/crypto-config/peerOrganizations/org1.mbasechain.com/peers/peer0.org1.mbasechain.com/tls/ca.crt"
</span><span class='line'>      },
</span><span class='line'>      "admin": {
</span><span class='line'>        "key": "/Users/xuyao/Workspaces/trace_kingland/artifacts/channel/crypto-config/peerOrganizations/org1.mbasechain.com/users/Admin@org1.mbasechain.com/msp/keystore",
</span><span class='line'>        "cert": "/Users/xuyao/Workspaces/trace_kingland/artifacts/channel/crypto-config/peerOrganizations/org1.mbasechain.com/users/Admin@org1.mbasechain.com/msp/signcerts"
</span><span class='line'>      }
</span><span class='line'>    },
</span><span class='line'>    "org2": {
</span><span class='line'>      "name": "peerOrg2",
</span><span class='line'>      "mspid": "Org2MSP",
</span><span class='line'>      "peer1": {
</span><span class='line'>        "requests": "grpcs://localhost:7056",
</span><span class='line'>        "events": "grpcs://localhost:7058",
</span><span class='line'>        "server-hostname": "peer0.org2.mbasechain.com",
</span><span class='line'>        "tls_cacerts": "/Users/xuyao/Workspaces/trace_kingland/artifacts/channel/crypto-config/peerOrganizations/org2.mbasechain.com/peers/peer0.org2.mbasechain.com/tls/ca.crt"
</span><span class='line'>      },
</span><span class='line'>      "admin": {
</span><span class='line'>        "key": "/Users/xuyao/Workspaces/trace_kingland/artifacts/channel/crypto-config/peerOrganizations/org2.mbasechain.com/users/Admin@org2.mbasechain.com/msp/keystore",
</span><span class='line'>        "cert": "/Users/xuyao/Workspaces/trace_kingland/artifacts/channel/crypto-config/peerOrganizations/org2.mbasechain.com/users/Admin@org2.mbasechain.com/msp/signcerts"
</span><span class='line'>      }
</span><span class='line'>    },
</span><span class='line'>    "org3": {
</span><span class='line'>      "name": "peerOrg3",
</span><span class='line'>      "mspid": "Org3MSP",
</span><span class='line'>      "peer1": {
</span><span class='line'>        "requests": "grpcs://localhost:8051",
</span><span class='line'>        "events": "grpcs://localhost:8053",
</span><span class='line'>        "server-hostname": "peer0.org3.mbasechain.com",
</span><span class='line'>        "tls_cacerts": "/Users/xuyao/Workspaces/trace_kingland/artifacts/channel/crypto-config/peerOrganizations/org3.mbasechain.com/peers/peer0.org3.mbasechain.com/tls/ca.crt"
</span><span class='line'>      },
</span><span class='line'>      "admin": {
</span><span class='line'>        "key": "/Users/xuyao/Workspaces/trace_kingland/artifacts/channel/crypto-config/peerOrganizations/org3.mbasechain.com/users/Admin@org3.mbasechain.com/msp/keystore",
</span><span class='line'>        "cert": "/Users/xuyao/Workspaces/trace_kingland/artifacts/channel/crypto-config/peerOrganizations/org3.mbasechain.com/users/Admin@org3.mbasechain.com/msp/signcerts"
</span><span class='line'>      }
</span><span class='line'>    },
</span><span class='line'>    "org4": {
</span><span class='line'>      "name": "peerOrg4",
</span><span class='line'>      "mspid": "Org4MSP",
</span><span class='line'>      "peer1": {
</span><span class='line'>        "requests": "grpcs://localhost:8056",
</span><span class='line'>        "events": "grpcs://localhost:9058",
</span><span class='line'>        "server-hostname": "peer0.org4.mbasechain.com",
</span><span class='line'>        "tls_cacerts": "/Users/xuyao/Workspaces/trace_kingland/artifacts/channel/crypto-config/peerOrganizations/org4.mbasechain.com/peers/peer0.org4.mbasechain.com/tls/ca.crt"
</span><span class='line'>      },
</span><span class='line'>      "admin": {
</span><span class='line'>        "key": "/Users/xuyao/Workspaces/trace_kingland/artifacts/channel/crypto-config/peerOrganizations/org4.mbasechain.com/users/Admin@org4.mbasechain.com/msp/keystore",
</span><span class='line'>        "cert": "/Users/xuyao/Workspaces/trace_kingland/artifacts/channel/crypto-config/peerOrganizations/org4.mbasechain.com/users/Admin@org4.mbasechain.com/msp/signcerts"
</span><span class='line'>      }
</span><span class='line'>    }
</span><span class='line'>  },
</span><span class='line'>  "channel": "mychannel",
</span><span class='line'>  "orderers":[
</span><span class='line'>    {
</span><span class='line'>      "mspid": "OrdererMSP",
</span><span class='line'>      "server-hostname":"orderer1.mbasechain.com",
</span><span class='line'>      "requests":"grpcs://localhost:7050",
</span><span class='line'>      "tls_cacerts":"/Users/xuyao/Workspaces/trace_kingland/artifacts/channel/crypto-config/ordererOrganizations/mbasechain.com/orderers/orderer1.mbasechain.com/tls/ca.crt"
</span><span class='line'>    },
</span><span class='line'>    {
</span><span class='line'>      "mspid": "OrdererMSP",
</span><span class='line'>      "server-hostname":"orderer2.mbasechain.com",
</span><span class='line'>      "requests":"grpcs://localhost:8050",
</span><span class='line'>      "tls_cacerts":"/Users/xuyao/Workspaces/trace_kingland/artifacts/channel/crypto-config/ordererOrganizations/mbasechain.com/orderers/orderer2.mbasechain.com/tls/ca.crt"
</span><span class='line'>    }
</span><span class='line'>  ],
</span><span class='line'>  "keyValueStore": "/tmp/fabric-client-kvs",
</span><span class='line'>  "configtxgenToolPath": "/Users/xuyao/Workspaces/goworkspace/src/blockchain/fabric/v1.2.0/fabric-samples/bin",
</span><span class='line'>  "SYNC_START_DATE_FORMAT":"YYYY/MM/DD",
</span><span class='line'>  "syncStartDate":"2018/01/01",
</span><span class='line'>  "eventWaitTime": "30000",
</span><span class='line'>  "license": "Apache-2.0",
</span><span class='line'>  "version": "1.1"
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p>é…ç½®å„èŠ‚ç‚¹çš„ä¿¡æ¯åŠtlsçš„caè¯ä¹¦ï¼Œç®¡ç†å‘˜çš„ç§é’¥åŠè¯ä¹¦ç­‰ä¿¡æ¯ã€‚</p>

<h6>8.3.3ã€æ„å»ºnodeé¡¹ç›®</h6>

<p>1ã€è¿›å…¥blockchain-explorer/ ä¸‹ï¼Œä½¿ç”¨npm install å®‰è£…é¡¹ç›®æ‰€éœ€packageï¼Œ<br/>
2ã€å†è¿›å…¥blockchain-explorer/app/test/ä¸‹ï¼Œä½¿ç”¨npm install å®‰è£…æµ‹è¯•é¡¹ç›®é‡Œçš„æ‰€éœ€åŒ…ï¼Œå†è·‘æµ‹è¯•è„šæœ¬</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>#å®‰è£…åŒ…
</span><span class='line'>npm install
</span><span class='line'>
</span><span class='line'>#è¿è¡Œæµ‹è¯•è„šæœ¬
</span><span class='line'>npm run test</span></code></pre></td></tr></table></div></figure>


<p>3ã€è¿›å…¥client/ ä½¿ç”¨npm install å‘½ä»¤å®‰è£…åŒ…</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>npm install
</span><span class='line'>
</span><span class='line'>npm test -- -u --coverage
</span><span class='line'>
</span><span class='line'>npm run build</span></code></pre></td></tr></table></div></figure>


<h5>8.4ã€å¯åŠ¨fabricæµè§ˆå™¨</h5>

<p>&emsp; ä½¿ç”¨è„šæœ¬./start.shæ¥å¯åŠ¨é¡¹ç›®ï¼Œå¯åŠ¨æˆåŠŸåï¼Œå¯ä»¥æ‰“å¼€æµè§ˆå™¨æŸ¥çœ‹ä¸€ä¸‹.
<img src="https://upload-images.jianshu.io/upload_images/1796624-c1112936dd3eabf3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="æµè§ˆå™¨æˆªå›¾" />
å…¶ä¸­åšäº†ä¸€äº›æ±‰åŒ–ã€‚</p>

<h5>å·²å®Œç»“</h5>

<h5>å‚è€ƒèµ„æ–™</h5>

<p>1ã€<a href="https://www.digitalocean.com/community/tutorials/how-to-install-and-use-postgresql-on-ubuntu-18-04">https://www.digitalocean.com/community/tutorials/how-to-install-and-use-postgresql-on-ubuntu-18-04</a><br/>
2ã€<a href="https://github.com/hyperledger/blockchain-explorer">https://github.com/hyperledger/blockchain-explorer</a><br/>
3ã€<a href="https://stedolan.github.io/jq/download/">https://stedolan.github.io/jq/download/</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Fabricå¤šå°æœåŠ¡å™¨çš„éƒ¨ç½²(å››)]]></title>
    <link href="http://xuyao.club/blog/2018/12/29/deployment-of-fabric-multiple-servers-iiii/"/>
    <updated>2018-12-29T16:51:08+08:00</updated>
    <id>http://xuyao.club/blog/2018/12/29/deployment-of-fabric-multiple-servers-iiii</id>
    <content type="html"><![CDATA[<h4>7ã€åˆ›å»ºchannelå’Œchaincode</h4>

<p> &emsp; ä¹‹å‰æˆ‘ä»¬è¯´è¿‡ï¼Œæœ¬é¡¹ç›®æ˜¯ä¸€ä¸ªnodejsçš„é¡¹ç›®ï¼Œæ˜¯æ ¹æ®<a href="https://github.com/hyperledger/fabric-samples">https://github.com/hyperledger/fabric-samples</a>é‡Œçš„balance_transferç¨ä½œä¿®æ”¹æ¥çš„ï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘ä»¬åˆ›å»ºchannelå’Œchaincodeï¼ŒåŒ…æ‹¬æ•°æ®ä¸Šé“¾éƒ½ä¼šç”¨nodejs sdkæ¥åšã€‚</p>

<h6>7.1ã€å¯åŠ¨nodejsæœåŠ¡</h6>

<p> &emsp;è¿›å…¥æˆ‘ä»¬çš„trace_wineé¡¹ç›®ï¼Œä½¿ç”¨npmå®‰è£…é¡¹ç›®æ‰€éœ€çš„package,</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>npm install</span></code></pre></td></tr></table></div></figure>


<p>å®‰è£…å®Œåï¼Œæˆ‘ä»¬ç°åœ¨è¦å¯åŠ¨nodeæœåŠ¡ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹ä¸‹ï¼Œå½“å‰ç›®å½•ä¸‹é¢çš„ä¸ªrunApp.shçš„è„šæœ¬æ–‡ä»¶ï¼Œçœ‹ä¸‹é‡Œé¢å†…å®¹å°±çŸ¥é“ï¼Œè¿™æ˜¯ä¸ªå¯åŠ¨nodeæœåŠ¡çš„è„šæœ¬</p>

<!-- more -->


<p><img src="https://upload-images.jianshu.io/upload_images/1796624-895fa4b8dae442f8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="é¡¹ç›®çš„åŸºæœ¬æ–‡ä»¶" />
ç°åœ¨æˆ‘ä»¬æ¥è¿è¡Œä¸€ä¸‹è¿™ä¸ªè„šæœ¬æ–‡ä»¶ï¼Œä½¿ç”¨å‘½ä»¤</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>./runApp.sh</span></code></pre></td></tr></table></div></figure>


<p>æŸ¥çœ‹æ˜¯å¦å¯åŠ¨æˆåŠŸï¼Œè¿›å…¥é¡¹ç›®ä¸‹çš„logsæ–‡ä»¶å¤¹ï¼Œæ‰¾åˆ°å½“å‰çš„æ—¥å¿—æ–‡ä»¶ï¼Œæ‰“å¼€çœ‹ä¸€ä¸‹</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>tail -f 2018-11-28.log
</span><span class='line'>
</span><span class='line'>[2018-11-28 15:06:48.699] [INFO] Helper - Successfully loaded member from persistence
</span><span class='line'>[2018-11-28 15:07:15.485] [INFO] app - ****************** SERVER STARTED ************************
</span><span class='line'>[2018-11-28 15:07:15.488] [INFO] app - ***************  http://localhost:4000  ******************</span></code></pre></td></tr></table></div></figure>


<p>å¯ä»¥çœ‹åˆ°nodeæœåŠ¡å·²ç»å¯åŠ¨æˆåŠŸï¼Œä¸”ç«¯å£å·ä¸º4000ï¼Œå…·ä½“çš„æ–‡æ¡£å¯æŸ¥çœ‹å®˜æ–¹çš„<a href="https://github.com/hyperledger/fabric-samples/blob/release-1.3/balance-transfer/README.md">readme</a></p>

<h6>7.2ã€åˆ›å»ºCaç”¨æˆ·</h6>

<p> &emsp;Fabric CAä¸ºæ¯ä¸ªä¸Šé“¾ã€æŸ¥è¯¢è€…æä¾›äº†æ³¨å†Œç”¨æˆ·ï¼Œç”Ÿæˆç”¨æˆ·è¯ä¹¦(ECerts)çš„åŠŸèƒ½ï¼Œæˆ‘ä»¬ç°åœ¨å¯ä»¥é€šè¿‡REST APIsæ¥ä¸ca serveräº¤äº’ï¼Œæˆ‘ä»¬å…ˆçœ‹ä¸‹nodeé‡Œæ³¨å†Œç”¨æˆ·ï¼Œç”Ÿæˆè¯ä¹¦çš„ä»£ç </p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>///////////////////////////////////////////////////////////////////////////////
</span><span class='line'>///////////////////////// REST ENDPOINTS START HERE ///////////////////////////
</span><span class='line'>///////////////////////////////////////////////////////////////////////////////
</span><span class='line'>// Register and enroll user
</span><span class='line'>app.post('/users', async function(req, res) {
</span><span class='line'>  var username = req.body.username;
</span><span class='line'>  var orgName = req.body.orgName;
</span><span class='line'>  logger.debug('End point : /users');
</span><span class='line'>  logger.debug('User name : ' + username);
</span><span class='line'>  logger.debug('Org name  : ' + orgName);
</span><span class='line'>  if (!username) {
</span><span class='line'>      res.json(getErrorMessage('\'username\''));
</span><span class='line'>      return;
</span><span class='line'>  }
</span><span class='line'>  if (!orgName) {
</span><span class='line'>      res.json(getErrorMessage('\'orgName\''));
</span><span class='line'>      return;
</span><span class='line'>  }
</span><span class='line'>  var token = jwt.sign({
</span><span class='line'>      exp: Math.floor(Date.now() / 1000) + parseInt(hfc.getConfigSetting('jwt_expiretime')),
</span><span class='line'>      username: username,
</span><span class='line'>      orgName: orgName
</span><span class='line'>  }, app.get('secret'));
</span><span class='line'>  let response = await helper.getRegisteredUser(username, orgName, true);
</span><span class='line'>  logger.debug('-- returned from registering the username %s for organization %s',username,orgName);
</span><span class='line'>  if (response && typeof response !== 'string') {
</span><span class='line'>      logger.debug('Successfully registered the username %s for organization %s',username,orgName);
</span><span class='line'>      response.token = token;
</span><span class='line'>      res.json(response);
</span><span class='line'>  } else {
</span><span class='line'>      logger.debug('Failed to register the username %s for organization %s with::%s',username,orgName,response);
</span><span class='line'>      res.json({success: false, message: response});
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>});</span></code></pre></td></tr></table></div></figure>


<p>å¯ä»¥çœ‹åˆ°å½“ç”¨æˆ·ä¼ è¿›æ¥usernameå’ŒorgNameæ—¶ï¼Œnodeé¦–å…ˆä¼šä½¿ç”¨jwtå°†ä»–ä»¬ç”Ÿæˆä¸€ä¸ªTokenï¼Œç„¶åé€šè¿‡getRegisteredUser()æ–¹æ³•ç”Ÿæˆç”¨æˆ·çš„è¯ä¹¦ï¼Œæœ€ç»ˆå°†jwtç”Ÿæˆçš„tokenè¿”å›ç»™ç”¨æˆ·ã€‚<br/>
 &emsp;ä¸‹é¢æˆ‘ä»¬æ¥è°ƒç”¨ä¸€ä¸ªè¿™ä¸ªæ¥å£</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>#åœ¨Org1ä¸Šæ³¨å†Œå’Œç”Ÿæˆä¸€ä¸ªæ–°ç”¨æˆ·ï¼Œç”¨æˆ·åä¸ºJim
</span><span class='line'>curl -s -X POST http://localhost:4000/users -H "content-type: application/x-www-form-urlencoded" -d 'username=Jim&orgName=Org1'</span></code></pre></td></tr></table></div></figure>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>#è¿”å›ç»“æœ
</span><span class='line'>{
</span><span class='line'>  "success": true,
</span><span class='line'>  "secret": "RaxhMgevgJcm",
</span><span class='line'>  "message": "Jim enrolled Successfully",
</span><span class='line'>  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE1NDQ1MjIxMTgsInVzZXJuYW1lIjoiZG9jIiwib3JnTmFtZSI6Ik9yZzEiLCJpYXQiOjE1NDQ0MzU3MTh9.X8DuFxUSmsRTe7v7iMft8A7LxzpvGyhnufBLQTZ3F8I"
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p>ä¸Šé¢çš„tokenå°±æ˜¯æˆ‘ä»¬æƒ³è¦çš„ï¼Œä¹‹åæ¯æ¬¡è¯·æ±‚æ¥å£éƒ½ä¼šç”¨tokenæ¥éªŒè¯ç”¨æˆ·ä¿¡æ¯,æ›´å¤šçš„jwtä¿¡æ¯ï¼Œå¯ä»¥æŸ¥çœ‹è¿™é‡Œ<a href="https://jwt.io/">https://jwt.io/</a>ï¼Œå¦å¤–ç”¨æˆ·ç”Ÿæˆçš„è¯ä¹¦ä¿å­˜åœ¨æœåŠ¡å™¨ç«¯ï¼Œæ˜¯æ ‡å‡†çš„X.509è¯ä¹¦æ ¼å¼ï¼Œå¯ä»¥æ‰“å¼€çœ‹ä¸€ä¸‹è¿™ä¸ªè¯ä¹¦</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>{"name":"Jim","mspid":"Org1MSP","roles":null,"affiliation":"","enrollmentSecret":"",
</span><span class='line'>"enrollment":{"signingIdentity":"72d623e2104955b39ca6b6383a278b4b0a253e45a83b26044edf193563655367","
</span><span class='line'>identity":{"certificate":"
</span><span class='line'>-----BEGIN CERTIFICATE-----
</span><span class='line'>\nMIICkDCCAjegAwIBAgIUX+durkyChVVZ5LNZekudT17CcJUwCgYIKoZIzj0EAwIw\n
</span><span class='line'>eTELMAkGA1UEBhMCVVMxEzARBgNVBAgTCkNhbGlmb3JuaWExFjAUBgNVBAcTDVNh\n
</span><span class='line'>biBGcmFuY2lzY28xHDAaBgNVBAoTE29yZzEubWJhc2VjaGFpbi5jb20xHzAdBgNV\n
</span><span class='line'>BAMTFmNhLm9yZzEubWJhc2VjaGFpbi5jb20wHhcNMTgxMTIzMDk0NjAwWhcNMTkx\n
</span><span class='line'>MTIzMDk1MTAwWjBAMTAwDQYDVQQLEwZjbGllbnQwCwYDVQQLEwRvcmcxMBIGA1UE\n
</span><span class='line'>CxMLZGVwYXJ0bWVudDExDDAKBgNVBAMTA2RvYzBZMBMGByqGSM49AgEGCCqGSM49\n
</span><span class='line'>AwEHA0IABGUZz9n5KvXF9H0l4HSdCvegNE2A0pkk2w1oQLcJW9FaZvr7rBDG3/bl\nauV26OoHJX7Yo/N
</span><span class='line'>x2JyQrQzYRoPKfOWjgdUwgdIwDgYDVR0PAQH/BAQDAgeAMAwG\n
</span><span class='line'>A1UdEwEB/wQCMAAwHQYDVR0OBBYEFCGGAIKaIFfBpkYuR2rjxvGle+uRMCsGA1Ud\n
</span><span class='line'>IwQkMCKAIGyyJr5K7JgVQebL3WZ0ITnBFX6Ir+Bu37FvEuzDBWv1MGYGCCoDBAUG\n
</span><span class='line'>BwgBBFp7ImF0dHJzIjp7ImhmLkFmZmlsaWF0aW9uIjoib3JnMS5kZXBhcnRtZW50\n
</span><span class='line'>MSIsImhmLkVucm9sbG1lbnRJRCI6ImRvYyIsImhmLlR5cGUiOiJjbGllbnQifX0w\n
</span><span class='line'>CgYIKoZIzj0EAwIDRwAwRAIgYnTD6Pkx1+R4R77TztW3/oQb1h+5/3ELYtAsIuz7\n
</span><span class='line'>D8wCIBiOmE/uySQvkgzUcCsVRtaUMg0M9zioKBYHiPUxeNJo\n
</span><span class='line'>-----END CERTIFICATE-----\n"}}}%</span></code></pre></td></tr></table></div></figure>


<h6>7.2ã€åˆ›å»ºChannel</h6>

<p> &emsp; åŒæ ·æˆ‘ä»¬ä½¿ç”¨nodeæœåŠ¡æä¾›çš„æ¥å£æ¥åˆ›å»ºChannelé€šé“ï¼Œå…·ä½“åˆ›å»ºchannelçš„jsä»£ç å¯ä»¥çœ‹<a href="https://github.com/hyperledger/fabric-samples/blob/release-1.3/balance-transfer/app.js#L142">è¿™é‡Œ</a></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>curl -s -X POST \
</span><span class='line'>  http://localhost:4000/channels \
</span><span class='line'>  -H "authorization: Bearer Token" \
</span><span class='line'>  -H "content-type: application/json" \
</span><span class='line'>  -d '{
</span><span class='line'>  "channelName":"mychannel",
</span><span class='line'>  "channelConfigPath":"../artifacts/channel/mychannel.tx"
</span><span class='line'>}'</span></code></pre></td></tr></table></div></figure>


<p>authorizationé‡Œçš„Tokenæ˜¯ä¸Šé¢æˆ‘ä»¬å¾—åˆ°çš„tokenï¼Œ channelNameæ˜¯æˆ‘ä»¬è¦åˆ›å»ºé€šé“çš„åå­—ï¼ŒchannelConfigPathæŒ‡å®šmychannel.txæ–‡ä»¶è·¯å¾„ï¼Œåˆ›å»ºæˆåŠŸï¼Œè¿”å›å¦‚ä¸‹ç»“æœ</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>{"success":true,"message":"Channel 'mychannel' created Successfully"}</span></code></pre></td></tr></table></div></figure>


<h6>7.3ã€å°†ChannelåŠ å…¥åˆ°Orgé‡Œ</h6>

<p> &emsp;ç°åœ¨æˆ‘ä»¬éœ€è¦å°†channelåŠ å…¥åˆ°Orgé‡Œï¼Œè¿™æ ·Orgå°±å¯ä»¥ä½¿ç”¨è¿™ä¸ªchannelï¼ŒåŒæ ·æ˜¯é€šè¿‡nodeæ¥å£æ¥å®ç°</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>curl -s -X POST \
</span><span class='line'>  http://localhost:4000/channels/mychannel/peers \
</span><span class='line'>  -H "authorization: Bearer Token" \
</span><span class='line'>  -H "content-type: application/json" \
</span><span class='line'>  -d '{
</span><span class='line'>  "peers": ["peer0.org1.xuyao.com","peer1.org1.xuyao.com"]
</span><span class='line'>}'</span></code></pre></td></tr></table></div></figure>


<p>è¿”å›ç»“æœ</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>{"success":true,"message":"Successfully joined peers in organization Org1 to the channel:mychannel"}</span></code></pre></td></tr></table></div></figure>


<h6>7.4ã€ç¼–å†™å’Œå®‰è£…æ™ºèƒ½åˆçº¦(chaincode)</h6>

<h6>7.4.1ã€ç¼–å†™æ™ºèƒ½åˆçº¦(chaincode)</h6>

<p> &emsp;channelå®‰è£…å¥½åï¼Œæˆ‘ä»¬éœ€è¦ç¼–å†™æ™ºèƒ½åˆçº¦ï¼Œè¿™é‡Œæˆ‘è´´ä¸€ä¸ªæˆ‘ç”¨goå†™çš„ä¸€ä¸ªchaincode,åŠŸèƒ½å¾ˆç®€å•å°±æ˜¯æŠŠæ•°æ®ä¸Šé“¾ï¼ŒæŸ¥è¯¢</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
<span class='line-number'>100</span>
<span class='line-number'>101</span>
<span class='line-number'>102</span>
<span class='line-number'>103</span>
<span class='line-number'>104</span>
<span class='line-number'>105</span>
<span class='line-number'>106</span>
<span class='line-number'>107</span>
<span class='line-number'>108</span>
<span class='line-number'>109</span>
<span class='line-number'>110</span>
<span class='line-number'>111</span>
<span class='line-number'>112</span>
<span class='line-number'>113</span>
<span class='line-number'>114</span>
<span class='line-number'>115</span>
<span class='line-number'>116</span>
<span class='line-number'>117</span>
<span class='line-number'>118</span>
<span class='line-number'>119</span>
<span class='line-number'>120</span>
<span class='line-number'>121</span>
<span class='line-number'>122</span>
<span class='line-number'>123</span>
<span class='line-number'>124</span>
<span class='line-number'>125</span>
<span class='line-number'>126</span>
<span class='line-number'>127</span>
<span class='line-number'>128</span>
<span class='line-number'>129</span>
<span class='line-number'>130</span>
<span class='line-number'>131</span>
<span class='line-number'>132</span>
<span class='line-number'>133</span>
<span class='line-number'>134</span>
<span class='line-number'>135</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>package main
</span><span class='line'>
</span><span class='line'>import (
</span><span class='line'>  "bytes"
</span><span class='line'>  "fmt"
</span><span class='line'>
</span><span class='line'>  "github.com/hyperledger/fabric/core/chaincode/shim"
</span><span class='line'>  pb "github.com/hyperledger/fabric/protos/peer"
</span><span class='line'>)
</span><span class='line'>
</span><span class='line'>//Chaincode implementation
</span><span class='line'>type SimpleChaincode struct {
</span><span class='line'>}
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>// ===================================================================================
</span><span class='line'>// Main
</span><span class='line'>// ===================================================================================
</span><span class='line'>func main() {
</span><span class='line'>  err := shim.Start(new(SimpleChaincode))
</span><span class='line'>  if err != nil {
</span><span class='line'>      fmt.Printf("Error starting Simple chaincode: %s", err)
</span><span class='line'>  }
</span><span class='line'>}
</span><span class='line'>
</span><span class='line'>// Init initializes chaincode
</span><span class='line'>// ===========================
</span><span class='line'>func (t *SimpleChaincode) Init(stub shim.ChaincodeStubInterface) pb.Response {
</span><span class='line'>  return shim.Success(nil)
</span><span class='line'>}
</span><span class='line'>
</span><span class='line'>// Invoke - Our entry point for Invocations
</span><span class='line'>// ========================================
</span><span class='line'>func (t *SimpleChaincode) Invoke(stub shim.ChaincodeStubInterface) pb.Response {
</span><span class='line'>  function, args := stub.GetFunctionAndParameters()
</span><span class='line'>  fmt.Printf("function: %s,args: %s\n", function, args)
</span><span class='line'>
</span><span class='line'>  // Handle different functions
</span><span class='line'>  if function == "save" { //create a new marble
</span><span class='line'>      return t.save(stub, args)
</span><span class='line'>  } else if function == "query" { //find Data based on an ad hoc rich query
</span><span class='line'>      return t.query(stub, args)
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  fmt.Println("invoke did not find func: " + function) //error
</span><span class='line'>  return shim.Error("Received unknown function invocation")
</span><span class='line'>}
</span><span class='line'>
</span><span class='line'>// ============================================================
</span><span class='line'>// - create a new data, store into chaincode state
</span><span class='line'>// ============================================================
</span><span class='line'>func (t *SimpleChaincode) save(stub shim.ChaincodeStubInterface, args []string) pb.Response {
</span><span class='line'>  
</span><span class='line'>  if len(args) != 2 {
</span><span class='line'>      return shim.Error("Incorrect number of arguments. Expecting 2")
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  err := stub.PutState(args[0], []byte(args[1]))
</span><span class='line'>  if err != nil {
</span><span class='line'>      return shim.Error(err.Error())
</span><span class='line'>  }
</span><span class='line'>  fmt.Println("- end save business")
</span><span class='line'>  return shim.Success(nil)
</span><span class='line'>  
</span><span class='line'>
</span><span class='line'>}
</span><span class='line'>
</span><span class='line'>// ===== Add hoc rich query ========================================================
</span><span class='line'>// query method uses a query string to perform a query for data.
</span><span class='line'>// Query string matching state database syntax is passed in and executed as is.
</span><span class='line'>// Supports ad hoc queries that can be defined at runtime by the client.
</span><span class='line'>// Only available on state databases that support rich query (e.g. CouchDB)
</span><span class='line'>// =========================================================================================
</span><span class='line'>func (t *SimpleChaincode) query(stub shim.ChaincodeStubInterface, args []string) pb.Response {
</span><span class='line'>
</span><span class='line'>  //   0
</span><span class='line'>  // "queryString"
</span><span class='line'>  if len(args) &lt; 1 {
</span><span class='line'>      return shim.Error("Incorrect number of arguments. Expecting 1")
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  queryString := args[0]
</span><span class='line'>
</span><span class='line'>  queryResults, err := getQueryResultForQueryString(stub, queryString)
</span><span class='line'>  if err != nil {
</span><span class='line'>      return shim.Error(err.Error())
</span><span class='line'>  }
</span><span class='line'>  return shim.Success(queryResults)
</span><span class='line'>}
</span><span class='line'>
</span><span class='line'>// =========================================================================================
</span><span class='line'>// getQueryResultForQueryString executes the passed in query string.
</span><span class='line'>// Result set is built and returned as a byte array containing the JSON results.
</span><span class='line'>// =========================================================================================
</span><span class='line'>func getQueryResultForQueryString(stub shim.ChaincodeStubInterface, queryString string) ([]byte, error) {
</span><span class='line'>
</span><span class='line'>  fmt.Printf("- getQueryResultForQueryString queryString:\n%s\n", queryString)
</span><span class='line'>
</span><span class='line'>  resultsIterator, err := stub.GetQueryResult(queryString)
</span><span class='line'>  if err != nil {
</span><span class='line'>      return nil, err
</span><span class='line'>  }
</span><span class='line'>  defer resultsIterator.Close()
</span><span class='line'>
</span><span class='line'>  // buffer is a JSON array containing QueryRecords
</span><span class='line'>  var buffer bytes.Buffer
</span><span class='line'>  buffer.WriteString("[")
</span><span class='line'>
</span><span class='line'>  bArrayMemberAlreadyWritten := false
</span><span class='line'>  for resultsIterator.HasNext() {
</span><span class='line'>      queryResponse, err := resultsIterator.Next()
</span><span class='line'>      if err != nil {
</span><span class='line'>          return nil, err
</span><span class='line'>      }
</span><span class='line'>      // Add a comma before array members, suppress it for the first array member
</span><span class='line'>      if bArrayMemberAlreadyWritten == true {
</span><span class='line'>          buffer.WriteString(",")
</span><span class='line'>      }
</span><span class='line'>      buffer.WriteString("{\"Key\":")
</span><span class='line'>      buffer.WriteString("\"")
</span><span class='line'>      buffer.WriteString(queryResponse.Key)
</span><span class='line'>      buffer.WriteString("\"")
</span><span class='line'>
</span><span class='line'>      buffer.WriteString(", \"Record\":")
</span><span class='line'>      // Record is a JSON object, so we write as-is
</span><span class='line'>      buffer.WriteString(string(queryResponse.Value))
</span><span class='line'>      buffer.WriteString("}")
</span><span class='line'>      bArrayMemberAlreadyWritten = true
</span><span class='line'>  }
</span><span class='line'>  buffer.WriteString("]")
</span><span class='line'>
</span><span class='line'>  fmt.Printf("- getQueryResultForQueryString queryResult:\n%s\n", buffer.String())
</span><span class='line'>
</span><span class='line'>  return buffer.Bytes(), nil
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p>save()å‡½æ•°å°†ä¼ ä¸Šæ¥çš„æ•°æ®ä¸Šé“¾ï¼Œquery()å‡½æ•°é€šè¿‡äº¤æ˜“idæ¥æŸ¥è¯¢åŒºå—, getQueryResultForQueryString()å‡½æ•°é€šè¿‡äº¤æ˜“é‡Œçš„å­—æ®µæ¥æŸ¥è¯¢åŒºå—ï¼Œç›®å‰åªæ”¯æŒcouchdbæŸ¥è¯¢ï¼Œleveldbä¸æ”¯æŒè¿™æ ·æŸ¥ã€‚</p>

<h6>7.4.2ã€ å®‰è£…chaincode</h6>

<p>ç°åœ¨æˆ‘ä»¬æ¥å®‰è£…chaincode</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>curl -s -X POST \
</span><span class='line'>  http://localhost:4000/chaincodes \
</span><span class='line'>  -H "authorization: Bearer &lt;put JSON Web Token here&gt;" \
</span><span class='line'>  -H "content-type: application/json" \
</span><span class='line'>  -d '{
</span><span class='line'>  "peers": ["peer0.org1.xuyao.com","peer1.org1.xuyao.com"],
</span><span class='line'>  "chaincodeName":"mycc",
</span><span class='line'>  "chaincodePath":"github.com/example_cc/go",
</span><span class='line'>  "chaincodeType": "golang",
</span><span class='line'>  "chaincodeVersion":"v0"
</span><span class='line'>}'</span></code></pre></td></tr></table></div></figure>


<p>chaincodeNameæ˜¯æ™ºèƒ½åˆçº¦çš„åå­—ï¼Œ chaincodePathæ˜¯æ™ºèƒ½åˆçº¦çš„è·¯å¾„ï¼Œ chaincodeTypeæ˜¯ç¼–å†™æ™ºèƒ½åˆçº¦çš„è¯­è¨€ï¼Œæ˜¯golangå’Œnodejsä¸¤ç§ï¼ŒchaincodeVersionæ˜¯æ™ºèƒ½åˆçº¦çš„ç‰ˆæœ¬å·ï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯å¦‚æœæ˜¯å‡çº§æ™ºèƒ½åˆçº¦çš„è¯ï¼Œéœ€è¦åŠ ä¸Šupgrade: trueçš„å‚æ•°ï¼Œè€Œä¸”ç‰ˆæœ¬å·ä¹Ÿè¦å‘ä¸Šå‡çº§ã€‚è¿™æ˜¯å‡çº§çš„æ¥å£ï¼Œå¦‚ä¸‹:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>curl -s -X POST \
</span><span class='line'>  http://localhost:4000/chaincodes \
</span><span class='line'>  -H "authorization: Bearer &lt;put JSON Web Token here&gt;" \
</span><span class='line'>  -H "content-type: application/json" \
</span><span class='line'>  -d '{
</span><span class='line'>    "peers": ["peer0.org1.xuyao.com","peer1.org1.xuyao.com"],
</span><span class='line'>    "chaincodeName":"mycc",
</span><span class='line'>    "chaincodePath":"github.com/example_cc/go",
</span><span class='line'>    "chaincodeType": "golang",
</span><span class='line'>    "chaincodeVersion":"v1",
</span><span class='line'>    "upgrade": "true"
</span><span class='line'>}'</span></code></pre></td></tr></table></div></figure>


<p>å®‰è£…æˆåŠŸåï¼Œè¿”å›å¦‚ä¸‹ç»“æœ</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>{"success":true,"message":"Successfully install chaincode"}</span></code></pre></td></tr></table></div></figure>


<h6>7.4.3ã€å®ä¾‹åŒ–chaincode</h6>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>curl -s -X POST \
</span><span class='line'>  http://localhost:4000/channels/mychannel/chaincodes \
</span><span class='line'>  -H "authorization: Bearer &lt;put JSON Web Token here&gt;" \
</span><span class='line'>  -H "content-type: application/json" \
</span><span class='line'>  -d '{
</span><span class='line'>  "chaincodeName":"mycc",
</span><span class='line'>  "chaincodeVersion":"v0",
</span><span class='line'>  "chaincodeType": "golang",
</span><span class='line'>  "args":["a","100","b","200"]
</span><span class='line'>}'</span></code></pre></td></tr></table></div></figure>


<p>æˆåŠŸè¿”å›ç»“æœ</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>{"success":true,"message":"Successfully instantiate chaingcode in organization Org1 to the channel 'mychannel'"}</span></code></pre></td></tr></table></div></figure>


<h6>7.4.4ã€æ•°æ®ä¸Šé“¾</h6>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>curl -s -X POST \
</span><span class='line'>  http://localhost:4000/api/v1/save\
</span><span class='line'>  -H "authorization: Bearer $ORG1_TOKEN" \
</span><span class='line'>  -H "content-type: application/json" \
</span><span class='line'>  -d '{
</span><span class='line'>        "godsCode": "2018092900004",
</span><span class='line'>        "jsonInfo":
</span><span class='line'>          {
</span><span class='line'>          "discern":"1",
</span><span class='line'>          "godsIssuerName":"2",
</span><span class='line'>          "godsIssuerCode":"3",
</span><span class='line'>          "godsTypeName":"4",
</span><span class='line'>          "godsMarketValue":"4",
</span><span class='line'>          "companyName":"5",
</span><span class='line'>          "issuePrice":"6",
</span><span class='line'>          "godsCode":"7",
</span><span class='line'>          "sort":"9",
</span><span class='line'>          "orgCompanyName":"8",
</span><span class='line'>          "orgCode":"",
</span><span class='line'>          "reportId":"",
</span><span class='line'>          "linkTime":"",
</span><span class='line'>          "linkUser":"",
</span><span class='line'>          "linkRole":"",
</span><span class='line'>          "orgSignTime":"",
</span><span class='line'>          "godsSignTime":"",
</span><span class='line'>          "files":[{"fileName":"æ–‡ä»¶åç§°.xml","fileHash":"4564613243454546884464"}],
</span><span class='line'>          "attr":[{"key":"name","value":"val"}],
</span><span class='line'>          "companyArea":"æ‰€å±å›½å®¶/åœ°åŒº",
</span><span class='line'>          "linkmanPhone":"ä¼ä¸šè”ç³»ç”µè¯",
</span><span class='line'>          "linkmanEmail":"ä¼ä¸šé‚®ç®±",
</span><span class='line'>          "legalPerson":"æ³•äººå§“å"
</span><span class='line'>        } 
</span><span class='line'>      }'</span></code></pre></td></tr></table></div></figure>


<h6>7.4.5ã€æ•°æ®æŸ¥è¯¢</h6>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>#é€šè¿‡åŒºå—æŸ¥è¯¢
</span><span class='line'>curl -s -X GET \
</span><span class='line'>  "http://localhost:4000/channels/mychannel/blocks/1?peer=peer0.org1.example.com" \
</span><span class='line'>  -H "authorization: Bearer &lt;put JSON Web Token here&gt;" \
</span><span class='line'>  -H "content-type: application/json"
</span><span class='line'>
</span><span class='line'>#é€šè¿‡TransactionID
</span><span class='line'>curl -s -X GET \
</span><span class='line'>http://localhost:4000/channels/mychannel/transactions/&lt;put transaction id here&gt;?peer=peer0.org1.example.com \
</span><span class='line'>  -H "authorization: Bearer &lt;put JSON Web Token here&gt;" \
</span><span class='line'>  -H "content-type: application/json"
</span><span class='line'>
</span><span class='line'>#æ ¹æ®è‡ªå·±çš„ä¸šåŠ¡IDæŸ¥è¯¢
</span><span class='line'>curl -s -X POST \
</span><span class='line'>    "http://localhost:4000/api/v1/query" \
</span><span class='line'>  -H "authorization: Bearer $ORG1_TOKEN" \
</span><span class='line'>  -H "content-type: application/json" \
</span><span class='line'>  -d '
</span><span class='line'>    {
</span><span class='line'>      "godsCode": "2018092900004"
</span><span class='line'>    }
</span><span class='line'>  '</span></code></pre></td></tr></table></div></figure>


<p>è¿”å›ç»“æœ</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>{"code":200,"message":"æ“ä½œæˆåŠŸ","data":[{"godsCode":"2018092900004","jsonInfo":{"companyArea":"æ‰€å±å›½å®¶/åœ°åŒº","companyName":"5","discern":"1","files":[{"fileHash":"4564613243454546884464","fileName":"æ–‡ä»¶åç§°.xml"}],"godsCode":"7","godsIssuerCode":"3","godsIssuerName":"2","godsMarketValue":"4","godsSignTime":"","godsTypeName":"4","issuePrice":"6","legalPerson":"æ³•äººå§“å","linkRole":"","linkTime":"","linkUser":"","linkmanEmail":"ä¼ä¸šé‚®ç®±","linkmanPhone":"ä¼ä¸šè”ç³»ç”µè¯","orgCode":"","orgCompanyName":"8","orgSignTime":"","reportId":"","sort":"9"},"userName":"doc"}]}</span></code></pre></td></tr></table></div></figure>


<h5>æœªå®Œå¾…ç»­ã€‚ã€‚ã€‚</h5>

<h4>å‚è€ƒèµ„æ–™</h4>

<p>1ã€<a href="https://github.com/hyperledger/fabric-samples/blob/release-1.3/balance-transfer/README.md">https://github.com/hyperledger/fabric-samples/blob/release-1.3/balance-transfer/README.md</a><br/>
2ã€<a href="https://jwt.io/">https://jwt.io/</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Fabricå¤šå°æœåŠ¡å™¨çš„éƒ¨ç½²(ä¸‰)]]></title>
    <link href="http://xuyao.club/blog/2018/12/29/deployment-of-fabric-multiple-servers-iii/"/>
    <updated>2018-12-29T16:48:58+08:00</updated>
    <id>http://xuyao.club/blog/2018/12/29/deployment-of-fabric-multiple-servers-iii</id>
    <content type="html"><![CDATA[<h4>6ã€å¯åŠ¨Fabricç½‘ç»œ</h4>

<p>&emsp;å®Œæˆä¸Šé¢çš„å·¥ä½œåï¼Œæˆ‘ä»¬å·²ç»ç”Ÿæˆäº†Fabricæ‰€éœ€è¦çš„è¯ä¹¦å’Œåˆ›ä¸–çºªå—ç­‰ä¸€äº›å¿…è¦æ–‡ä»¶åï¼Œç°åœ¨æˆ‘ä»¬å°±éœ€è¦é…ç½®dockeræ–‡ä»¶ï¼Œæ¥å¯åŠ¨Fabricç½‘ç»œï¼Œä¹‹å‰æˆ‘ä»¬è®²è¿‡éœ€è¦å¯åŠ¨çš„ä¸€äº›æœåŠ¡ï¼Œç°åœ¨åœ¨åˆ—ä¸€ä¸‹ï¼ŒæœåŠ¡å™¨ä¸€å…±æœ‰4å°ï¼Œ è·‘4ä¸ªpeerï¼Œ4ä¸ªca, 4ä¸ªkafkaï¼Œ3ä¸ªzookeeper, 2ä¸ªordererï¼Œå…·ä½“ä¿¡æ¯å¦‚ä¸‹ï¼š<br/>
1ã€Server1ï¼š  peer1ã€Ca1ã€ Kafka1ã€Zookeeper1ã€Orderer1<br/>
2ã€Server2ï¼š  peer2ã€Ca2ã€ Kafka2ã€Zookeeper2ã€Orderer2<br/>
3ã€Server3ï¼š   peer3ã€Ca3ã€ Kafka3ã€Zookeeper31<br/>
4ã€Server4ï¼š   peer4ã€Ca4ã€ Kafka4<br/>
ç°åœ¨æˆ‘ä»¬éœ€è¦åœ¨å„å°æœåŠ¡å™¨ä¸Šå¯åŠ¨è¿™äº›æœåŠ¡ï¼Œéœ€è¦è¯´æ˜ä¸€ä¸‹ï¼Œæˆ‘ä»¬éœ€è¦å…ˆå¯åŠ¨zookeeperï¼Œå†å¯åŠ¨kafkaï¼Œç„¶åå¯åŠ¨ordererå’Œpeerï¼Œè¿™äº›æ˜¯æœ‰å…ˆåé¡ºåºçš„ï¼Œå› ä¸ºå„æœåŠ¡ä¹‹é—´æœ‰ä¾èµ–å…³ç³»ï¼Œä¸æŒ‰é¡ºåºå¯åŠ¨ï¼Œæœ€åå¯èƒ½å„æœåŠ¡ä¹‹é—´çš„é€šè®¯æœ‰é—®é¢˜ï¼Œä¸‹é¢ä¾æ¬¡æ¥å¯åŠ¨è¿™äº›æœåŠ¡ã€‚</p>

<!-- more -->


<h5>6.1ã€å¯åŠ¨Zookeeperé›†ç¾¤</h5>

<h6>6.1.1ã€é…ç½®docker-zookeeper.yamlæ–‡ä»¶ï¼Œ</h6>

<p>&emsp;ä¹‹å‰æˆ‘ä»¬å‡è®¾å·²ç»æŠŠtrace_redwineé¡¹ç›®pushåˆ°è¿œç¨‹ä»“åº“ä¸Šï¼Œç°åœ¨æˆ‘ä»¬éœ€è¦åœ¨å››å°æœåŠ¡å™¨ä¸Šåˆ†åˆ«æŠŠä»£ç pullä¸‹æ¥ï¼Œè¿›å…¥/artifactsæ–‡ä»¶å¤¹æ¥é…ç½®dockerçš„é…ç½®æ–‡ä»¶ã€‚<br/>
&emsp;å› ä¸ºæˆ‘ä»¬å‰ä¸‰å°æœåŠ¡å™¨éƒ½éœ€è¦docker-zookeeper.yamlæ–‡ä»¶ï¼Œæ‰€ä»¥ä¸ºäº†æ–¹ä¾¿é…ç½®ï¼Œæˆ‘ä»¬ä¸é˜²ç”Ÿæˆä¸‰ä¸ªzookeeperçš„é…ç½®æ–‡ä»¶ï¼Œåˆ†åˆ«ç”¨äºä¸‰å°æœåŠ¡å™¨é…ç½®ä¸Šï¼Œä¾æ¬¡å‘½åå¦‚ä¸‹ï¼šdocker-zookeeper0.yamlã€docker-zookeeper1.yamlã€docker-zookeeper2.yamlï¼Œä¸‹é¢æ˜¯docker-zookeeper0.yamlçš„é…ç½®å¦‚ä¸‹ï¼š</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>version: '2'
</span><span class='line'>
</span><span class='line'>services:
</span><span class='line'>
</span><span class='line'>  zookeeper0:
</span><span class='line'>    image: hyperledger/fabric-zookeeper
</span><span class='line'>    container_name: zookeeper0
</span><span class='line'>    hostname: zookeeper0
</span><span class='line'>    restart: always
</span><span class='line'>    environment:
</span><span class='line'>      - ZOO_MY_ID=1
</span><span class='line'>      - ZOO_SERVERS=server.1=zookeeper0:2888:3888 server.2=zookeeper1:2888:3888 server.3=zookeeper2:2888:3888
</span><span class='line'>    ports:
</span><span class='line'>      - 2181:2181
</span><span class='line'>      - 2888:2888
</span><span class='line'>      - 3888:3888
</span><span class='line'>    extra_hosts:
</span><span class='line'>      - "kafka0:10.99.22.103"
</span><span class='line'>      - "kafka1:10.99.22.109"
</span><span class='line'>      - "kafka2:10.99.22.101"
</span><span class='line'>      - "kafka3:10.99.22.121"
</span><span class='line'>      - "zookeeper0:0.0.0.0"
</span><span class='line'>      - "zookeeper1:10.99.22.109"
</span><span class='line'>      - "zookeeper2:10.99.22.101"</span></code></pre></td></tr></table></div></figure>


<p>ä¸Šé¢é…ç½®çš„å‚æ•°æœ‰å‡ ç‚¹è¯´æ˜ä¸‹ï¼š<br/>
1ã€imageæ˜¯æŒ‡å®šä½¿ç”¨çš„é•œåƒåç§°ã€‚<br/>
2ã€container_nameæ˜¯å¯åŠ¨å®¹å™¨æ—¶çš„åå­—ã€‚<br/>
3ã€environmentæ˜¯è®¾ç½®Composeä¸»æœºä¸Šå¯¹åº”çš„ç¯å¢ƒå˜é‡<br/>
4ã€portsæ˜¯æš´éœ²ç«¯å£ä¿¡æ¯ï¼Œæ ¼å¼æ˜¯ å®¿ä¸»ç«¯å£ï¼šå®¹å™¨ç«¯å£ (HOST:CONTAINER)ï¼Œ<br/>
5ã€extra_hostsæ˜¯æŒ‡å®šé¢å¤–çš„ host åç§°æ˜ å°„ä¿¡æ¯ï¼Œå½“èŠ‚ç‚¹å¯åŠ¨åï¼ŒæœåŠ¡å®¹å™¨ä¼šåœ¨ /etc/hosts   æ–‡ä»¶ä¸­æ·»åŠ ä¸Šé¢çš„é…ç½®çš„IPå’Œåç§°ï¼Œä¸Šé¢æœ‰é…ç½®ä¼šåœ¨/etc/hostsæ–‡ä»¶ä¸­æ·»åŠ å¦‚ä¸‹é…ç½®ã€‚</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>10.99.22.103 kafka0
</span><span class='line'>10.99.22.109 kafka1
</span><span class='line'>10.99.22.101kafka2
</span><span class='line'>10.99.22.121 kafka3
</span><span class='line'>0.0.0.0 zookeeper0
</span><span class='line'>10.99.22.109 zookeeper1
</span><span class='line'>10.99.22.101 zookeeper2</span></code></pre></td></tr></table></div></figure>


<p>6ã€ZOO_MY_IDæ˜¯æŒ‡zookeeperå½“å‰æœåŠ¡èŠ‚ç‚¹çš„idï¼Œ è¿™ä¸ªidå€¼æ˜¯ä¸€å®šéœ€è¦å¡«çš„ï¼Œä¸”å”¯ä¸€çš„ï¼Œå€¼çš„èŒƒå›´åœ¨1~255ä¹‹é—´ã€‚<br/>
10ã€ZOO_SERVERSæ˜¯zookeeperé›†ç¾¤æœåŠ¡å™¨çš„åˆ—è¡¨ã€‚</p>

<p>docker-zookeeper1.yamlã€docker-zookeeper2.yamlæ–‡ä»¶é…ç½®æ•´ä½“ä¸å˜ï¼Œåªéœ€è¦ä¿®æ”¹ä¸€äº›å˜é‡åã€ç¯å¢ƒå˜é‡å°±å¯ä»¥ï¼Œdocker-zookeeper1.yamlçš„é…ç½®æ–‡ä»¶æ˜¯:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>version: '2'
</span><span class='line'>
</span><span class='line'>services:
</span><span class='line'>
</span><span class='line'>  zookeeper0:
</span><span class='line'>    image: hyperledger/fabric-zookeeper
</span><span class='line'>    container_name: zookeeper1
</span><span class='line'>    hostname: zookeeper1
</span><span class='line'>    restart: always
</span><span class='line'>    environment:
</span><span class='line'>      - ZOO_MY_ID=2
</span><span class='line'>      - ZOO_SERVERS=server.1=zookeeper0:2888:3888 server.2=zookeeper1:2888:3888 server.3=zookeeper2:2888:3888
</span><span class='line'>    ports:
</span><span class='line'>      - 2181:2181
</span><span class='line'>      - 2888:2888
</span><span class='line'>      - 3888:3888
</span><span class='line'>    extra_hosts:
</span><span class='line'>      - "kafka0:10.99.22.103"
</span><span class='line'>      - "kafka1:10.99.22.109"
</span><span class='line'>      - "kafka2:10.99.22.101"
</span><span class='line'>      - "kafka3:10.99.22.121"
</span><span class='line'>      - "zookeeper0:10.99.22.103"
</span><span class='line'>      - "zookeeper1:10.99.22.109"
</span><span class='line'>      - "zookeeper2:10.99.22.101"</span></code></pre></td></tr></table></div></figure>


<p>éœ€è¦æ³¨æ„çš„æ˜¯æˆ‘ä»¬ç°åœ¨æ˜¯åœ¨å¤šå°æœåŠ¡å™¨ä¸Šï¼Œæ‰€ä»¥æ¯ä¸ªzookeeperæœåŠ¡çš„ç«¯å£å¯ä»¥ä¸€æ ·ï¼Œå› ä¸ºä¸åœ¨ä¸€å°æœåŠ¡å™¨ä¸Šï¼Œå¦‚æœæˆ‘ä»¬åœ¨æœ¬åœ°ä¸Šè·‘å¤šä¸ªzookeeperï¼Œé‚£ä¹ˆè¿™é‡Œçš„ç«¯å£æ˜¯éœ€è¦ä¿®æ”¹çš„ï¼›docker-zookeeper2.yamlçš„æ–‡ä»¶ä¸ä¸Šé¢ç±»ä¼¼ï¼Œè¿™é‡Œä¸å†åˆ—å‡ºã€‚</p>

<h6>6.1.2ã€å¯åŠ¨Zookeeper</h6>

<p>ç°åœ¨æˆ‘ä»¬åˆ†åˆ«ç™»å½•server1,server2,server3ä¸‰å°æœåŠ¡å™¨ï¼Œæ¥å¯åŠ¨è¿™ä¸‰ä¸ªzookeeperæœåŠ¡ï¼Œè¿›å…¥é¡¹ç›®çš„/artifactsæ–‡ä»¶å¤¹ï¼Œæ‰¾åˆ°æ¯å°æœåŠ¡å™¨å¯¹åº”çš„docker zookeeperé…ç½®æ–‡ä»¶ï¼Œä½¿ç”¨docker-composeæ¥å¯åŠ¨</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>#å¯åŠ¨zookeeper0
</span><span class='line'>docker-compose -f docker-zookeeper0.yaml up -d</span></code></pre></td></tr></table></div></figure>


<p>å¯åŠ¨ä¹‹åçš„è¾“å‡º</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Starting zookeeper0 ... done</span></code></pre></td></tr></table></div></figure>


<p>å¦‚æœéœ€è¦çœ‹å¯åŠ¨çš„è¾“å‡ºæ—¥å¿—ï¼Œåˆ™åœ¨ä¸Šé¢å¯åŠ¨å‘½ä»¤åä¸è¦åŠ  -d, è¿™æ ·å¯ä»¥ç›´æ¥åœ¨å¯åŠ¨çš„æ—¶å€™æŸ¥çœ‹æ—¥å¿—è¾“å‡º</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>docker-compose -f docker-zookeeper0.yaml up</span></code></pre></td></tr></table></div></figure>


<p>server2,server3çš„å¯åŠ¨è·Ÿä¸Šé¢ä¸€æ ·ï¼Œå‘½ä»¤åˆ†åˆ«å¦‚ä¸‹</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>#å¯åŠ¨zookeeper1
</span><span class='line'>docker-compose -f docker-zookeeper1.yaml up -d
</span><span class='line'>
</span><span class='line'>#å¯åŠ¨zookeeper2
</span><span class='line'>docker-compose -f docker-zookeeper2.yaml up -d</span></code></pre></td></tr></table></div></figure>


<p>å¯åŠ¨æˆåŠŸåï¼Œå¯ä»¥ä½¿ç”¨dockerå‘½ä»¤æŸ¥çœ‹è¿è¡ŒçŠ¶æ€</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>docker ps -a</span></code></pre></td></tr></table></div></figure>


<p>å¯ä»¥çœ‹åˆ°zookeeper0æ˜¯æ­£åœ¨è¿è¡Œçš„çŠ¶æ€</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>CONTAINER ID        IMAGE                                                                                                          COMMAND                  CREATED             STATUS              PORTS                                                                                                                                               NAMES
</span><span class='line'>980c8bb7190d        hyperledger/fabric-zookeeper                                                                                   "/docker-entrypoint.â€¦"   7 days ago          Up 7 days           0.0.0.0:2181-&gt;2181/tcp, 0.0.0.0:2888-&gt;2888/tcp, 0.0.0.0:3888-&gt;3888/tcp, 0.0.0.0:32773-&gt;2181/tcp, 0.0.0.0:32772-&gt;2888/tcp, 0.0.0.0:32771-&gt;3888/tcp   zookeeper0</span></code></pre></td></tr></table></div></figure>


<h5>6.2ã€å¯åŠ¨Kafkaé›†ç¾¤</h5>

<h6>6.2.1ã€é…ç½®docker-kafka.yamlæ–‡ä»¶</h6>

<p>å› ä¸ºæˆ‘ä»¬æœ‰4ä¸ªkafkaæœåŠ¡ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç”Ÿæˆ4ä¸ªé…ç½®æ–‡ä»¶æ¥å¯åŠ¨è¿™4ä¸ªæœåŠ¡ï¼Œé…ç½®æ–‡ä»¶åˆ†åˆ«å¦‚ä¸‹docker-kafka0.yamlã€docker-kafka1.yamlã€docker-kafka2.yamlã€docker-kafka3.yamlã€‚
docker-kafka0.yamlçš„é…ç½®æ–‡ä»¶å¦‚ä¸‹ï¼š</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>version: '2'
</span><span class='line'>
</span><span class='line'>services:
</span><span class='line'>
</span><span class='line'>  kafka0:
</span><span class='line'>    image: hyperledger/fabric-kafka
</span><span class='line'>    container_name: kafka0
</span><span class='line'>    hostname: kafka0
</span><span class='line'>    restart: always
</span><span class='line'>    environment:
</span><span class='line'>      - KAFKA_BROKER_ID=0
</span><span class='line'>      - KAFKA_MIN_INSYNC_REPLICAS=2
</span><span class='line'>      - KAFKA_DEFAULT_REPLICATION_FACTOR=3
</span><span class='line'>      - KAFKA_ZOOKEEPER_CONNECT=zookeeper0:2181,zookeeper1:2181,zookeeper2:2181
</span><span class='line'>      - KAFKA_MESSAGE_MAX_BYTES=103809024 # 99 * 1024 * 1024 B
</span><span class='line'>      - KAFKA_REPLICA_FETCH_MAX_BYTES=103809024 # 99 * 1024 * 1024 B
</span><span class='line'>      - KAFKA_UNCLEAN_LEADER_ELECTION_ENABLE=false
</span><span class='line'>      - KAFKA_LOG_RETENTION_MS=-1
</span><span class='line'>      - KAFKA_LOG.DIRS=/var/hyperledger/production/kafka0/kafka-logs
</span><span class='line'>    volumes:
</span><span class='line'>       - ../mount/kafka0/var/hyperledger/production:/var/hyperledger/production/kafka0/kafka-logs
</span><span class='line'>    ports:
</span><span class='line'>      - 9092:9092
</span><span class='line'>    extra_hosts:
</span><span class='line'>      - "kafka0:10.99.22.103"
</span><span class='line'>      - "kafka1:10.99.22.109"
</span><span class='line'>      - "kafka2:10.99.22.101"
</span><span class='line'>      - "kafka3:10.99.22.121"
</span><span class='line'>      - "zookeeper0:10.99.22.103"
</span><span class='line'>      - "zookeeper1:10.99.22.109"
</span><span class='line'>      - "zookeeper2:10.99.22.101"</span></code></pre></td></tr></table></div></figure>


<p>è¯´æ˜å‡ ç‚¹ï¼š<br/>
1ã€KAFKA_BROKER_IDæ˜¯BROKERçš„å”¯ä¸€æ ‡è¯†ï¼Œä¸å¯é‡å¤ï¼Œä¸”éè´Ÿæ•´æ•°ã€‚  <br/>
2ã€KAFKA_ZOOKEEPER_CONNECTæ˜¯æŒ‡å‘zookeeperèŠ‚ç‚¹çš„é›†åˆã€‚<br/>
3ã€volumesæ˜¯dockeré‡Œæ•°æ®å·æ‰€æŒ‚è½½è·¯å¾„è®¾ç½®ï¼Œå¯ä»¥è®¾ç½®å®¿ä¸»æœºè·¯å¾„ ï¼ˆHOST:CONTAINERï¼‰ æˆ–åŠ ä¸Šè®¿é—®æ¨¡å¼ï¼ˆHOST:CONTAINER:roï¼‰ã€‚</p>

<p>docker-kafka1.yamlã€docker-kafka2.yamlã€docker-kafka3.yamlçš„é…ç½®åŸºæœ¬ä¸ä¸Šé¢çš„ä¸€æ ·ï¼Œåªè¦ä¿®æ”¹ä¸€ä¸‹KAFKA_BROKER_IDå‚æ•°å°±å¯ä»¥ï¼Œå¦‚docker-kafka1.yamlçš„é…ç½®æ–‡ä»¶æ˜¯ï¼š</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>version: '2'
</span><span class='line'>
</span><span class='line'>services:
</span><span class='line'>
</span><span class='line'>  kafka1:
</span><span class='line'>    image: hyperledger/fabric-kafka
</span><span class='line'>    container_name: kafka1
</span><span class='line'>    hostname: kafka1
</span><span class='line'>    restart: always
</span><span class='line'>    environment:
</span><span class='line'>      - KAFKA_BROKER_ID=1
</span><span class='line'>      - KAFKA_MIN_INSYNC_REPLICAS=2
</span><span class='line'>      - KAFKA_DEFAULT_REPLICATION_FACTOR=3
</span><span class='line'>      - KAFKA_ZOOKEEPER_CONNECT=zookeeper0:2181,zookeeper1:2181,zookeeper2:2181
</span><span class='line'>      - KAFKA_MESSAGE_MAX_BYTES=103809024 # 99 * 1024 * 1024 B
</span><span class='line'>      - KAFKA_REPLICA_FETCH_MAX_BYTES=103809024 # 99 * 1024 * 1024 B
</span><span class='line'>      - KAFKA_UNCLEAN_LEADER_ELECTION_ENABLE=false
</span><span class='line'>      - KAFKA_LOG_RETENTION_MS=-1
</span><span class='line'>      - KAFKA_LOG.DIRS=/var/hyperledger/production/kafka0/kafka-logs
</span><span class='line'>    volumes:
</span><span class='line'>       - ../mount/kafka0/var/hyperledger/production:/var/hyperledger/production/kafka0/kafka-logs
</span><span class='line'>    ports:
</span><span class='line'>      - 9092:9092
</span><span class='line'>    extra_hosts:
</span><span class='line'>      - "kafka0:10.99.22.103"
</span><span class='line'>      - "kafka1:10.99.22.109"
</span><span class='line'>      - "kafka2:10.99.22.101"
</span><span class='line'>      - "kafka3:10.99.22.121"
</span><span class='line'>      - "zookeeper0:10.99.22.103"
</span><span class='line'>      - "zookeeper1:10.99.22.109"
</span><span class='line'>      - "zookeeper2:10.99.22.101"</span></code></pre></td></tr></table></div></figure>


<p>docker-kafka2.yamlã€docker-kafka3.yamlæŒ‰ç…§ä¸Šé¢æ”¹å°±è¡Œï¼Œè¿™é‡Œä¸ä¸€ä¸€åˆ—å‡ºã€‚</p>

<h6>6.2.2ã€å¯åŠ¨Kafkaé›†ç¾¤</h6>

<p>&emsp;ç°åœ¨æˆ‘ä»¬åˆ†åˆ«ç™»å½•4å°æœåŠ¡å™¨ä¸Šï¼Œè¿›å…¥/artifactsé¡¹ç›®è·¯å¾„ä¸‹ï¼Œæ‰¾åˆ°åˆšæ‰æˆ‘ä»¬ç”Ÿæˆçš„é‚£äº›docker-kafka.yamlçš„é…ç½®æ–‡ä»¶ï¼Œä½¿ç”¨å‘½ä»¤ä¾æ¬¡å¯åŠ¨å„æœåŠ¡å™¨ä¸Šçš„kafkaæœåŠ¡</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>#å¯åŠ¨kafka0
</span><span class='line'>docker-compose -f docker-kafka0.yaml up -d</span></code></pre></td></tr></table></div></figure>


<p>server1ï¼Œserver2ï¼Œserver3å¯åŠ¨æ–¹æ³•å’Œä¸Šé¢ä¸€æ ·</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>#å¯åŠ¨kafka1
</span><span class='line'>docker-compose -f docker-kafka1.yaml up -d
</span><span class='line'>
</span><span class='line'>#å¯åŠ¨kafka2
</span><span class='line'>docker-compose -f docker-kafka2.yaml up -d
</span><span class='line'>
</span><span class='line'>#å¯åŠ¨kafka3
</span><span class='line'>docker-compose -f docker-kafka3.yaml up -d</span></code></pre></td></tr></table></div></figure>


<p>æœ€åå¯ä»¥åœ¨å„æœåŠ¡å™¨ä¸Šä½¿ç”¨docker å‘½ä»¤æŸ¥çœ‹æ˜¯å¦å¯åŠ¨æˆåŠŸ</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>docker ps -a
</span><span class='line'>
</span><span class='line'>CONTAINER ID        IMAGE                                                                                                          COMMAND                  CREATED             STATUS              PORTS                                                                                                                                               NAMES
</span><span class='line'>4bde08ae4413        hyperledger/fabric-kafka                                                                                       "/docker-entrypoint.â€¦"   7 days ago          Up 7 days           0.0.0.0:9092-&gt;9092/tcp, 9093/tcp, 0.0.0.0:32774-&gt;9092/tcp                                                                                           kafka0</span></code></pre></td></tr></table></div></figure>


<h5>6.3ã€å¯åŠ¨Ordereré›†ç¾¤</h5>

<h6>6.3.1ã€é…ç½®docker-orderer.yamlæ–‡ä»¶</h6>

<p> &emsp;ordereræœåŠ¡æˆ‘ä»¬åªæœ‰server1,server2ä¸Šæœ‰ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦ä¸¤ä¸ªå¯åŠ¨é…ç½®æ–‡ä»¶å°±è¡Œï¼Œå‘½åå¦‚ä¸‹docker-orderer0.yaml,docker-orderer1.yamlï¼Œ
å…¶ä¸­docker-orderer0.yamlçš„é…ç½®æ–‡ä»¶å¦‚ä¸‹ï¼š</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># Copyright IBM Corp. All Rights Reserved.
</span><span class='line'>#
</span><span class='line'># SPDX-License-Identifier: Apache-2.0
</span><span class='line'>#
</span><span class='line'>
</span><span class='line'>version: '2'
</span><span class='line'>
</span><span class='line'>services:
</span><span class='line'>
</span><span class='line'>  orderer0.xuyao.com:
</span><span class='line'>      container_name: orderer0.xuyao.com
</span><span class='line'>      image: hyperledger/fabric-orderer:latest
</span><span class='line'>      environment:
</span><span class='line'>        - ORDERER_GENERAL_LOGLEVEL=debug
</span><span class='line'>        - ORDERER_GENERAL_LISTENADDRESS=0.0.0.0
</span><span class='line'>        - ORDERER_GENERAL_GENESISMETHOD=file
</span><span class='line'>        - ORDERER_GENERAL_GENESISFILE=/etc/hyperledger/configtx/genesis.block
</span><span class='line'>        - ORDERER_GENERAL_LOCALMSPID=OrdererMSP
</span><span class='line'>        - ORDERER_GENERAL_LOCALMSPDIR=/etc/hyperledger/crypto/orderer/msp
</span><span class='line'>        - ORDERER_GENERAL_TLS_ENABLED=true
</span><span class='line'>        - GODEBUG=netdns=go
</span><span class='line'>        - ORDERER_GENERAL_TLS_PRIVATEKEY=/etc/hyperledger/crypto/orderer/tls/server.key
</span><span class='line'>        - ORDERER_GENERAL_TLS_CERTIFICATE=/etc/hyperledger/crypto/orderer/tls/server.crt
</span><span class='line'>        - ORDERER_GENERAL_TLS_ROOTCAS=[/etc/hyperledger/crypto/orderer/tls/ca.crt, /etc/hyperledger/crypto/peerOrg1/tls/ca.crt, /etc/hyperledger/crypto/peerOrg2/tls/ca.crt, /etc/hyperledger/crypto/peerOrg3/tls/ca.crt, /etc/hyperledger/crypto/peerOrg4/tls/ca.crt]
</span><span class='line'>        - ORDERER_KAFKA_RETRY_SHORTINTERVAL=1s
</span><span class='line'>        - ORDERER_KAFKA_RETRY_SHORTTOTAL=30s
</span><span class='line'>        - ORDERER_KAFKA_VERBOSE=true
</span><span class='line'>      working_dir: /opt/gopath/src/github.com/hyperledger/fabric/orderers
</span><span class='line'>      command: orderer
</span><span class='line'>      ports:
</span><span class='line'>        - 7050:7050
</span><span class='line'>      volumes:
</span><span class='line'>        - ./channel:/etc/hyperledger/configtx
</span><span class='line'>        - ./channel/crypto-config/ordererOrganizations/xuyao.com/orderers/orderer0.xuyao.com/:/etc/hyperledger/crypto/orderer
</span><span class='line'>        - ./channel/crypto-config/peerOrganizations/org1.xuyao.com/peers/peer0.org1.xuyao.com/:/etc/hyperledger/crypto/peerOrg1
</span><span class='line'>        - ./channel/crypto-config/peerOrganizations/org2.xuyao.com/peers/peer0.org2.xuyao.com/:/etc/hyperledger/crypto/peerOrg2
</span><span class='line'>        - ./channel/crypto-config/peerOrganizations/org3.xuyao.com/peers/peer0.org3.xuyao.com/:/etc/hyperledger/crypto/peerOrg3
</span><span class='line'>        - ./channel/crypto-config/peerOrganizations/org4.xuyao.com/peers/peer0.org4.xuyao.com/:/etc/hyperledger/crypto/peerOrg4
</span><span class='line'>        - ../mount/orderer1/var/hyperledger/production:/var/hyperledger/production
</span><span class='line'>      extra_hosts:
</span><span class='line'>        - "kafka0:10.99.22.103"
</span><span class='line'>        - "kafka1:10.99.22.109"
</span><span class='line'>        - "kafka2:10.99.22.101"
</span><span class='line'>        - "kafka3:10.99.22.121"</span></code></pre></td></tr></table></div></figure>


<p>è¯´æ˜ï¼š<br/>
1ã€ORDERER_GENERAL_TLS_PRIVATEKEYæ˜¯ä¸ºæœåŠ¡å™¨è¯ä¹¦è®¾ç½®ç§é’¥æ–‡ä»¶çš„ä½ç½®ã€‚<br/>
2ã€ORDERER_GENERAL_TLS_CERTIFICATEæ˜¯ä¸ºTLSè®¾ç½®æœåŠ¡å™¨è¯ä¹¦çš„ä½ç½®ã€‚<br/>
3ã€ORDERER_GENERAL_TLS_ROOTCASæ˜¯ä¸ºTLSè®¾ç½®æ ¹è¯ä¹¦çš„ä½ç½®ã€‚</p>

<p>docker-orderer1.yamlçš„é…ç½®æ–‡ä»¶åŸºæœ¬ä¸docker-orderer1.yamlå·®ä¸å¤šï¼Œå¦‚ä¸‹ï¼š</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>
</span><span class='line'>version: '2'
</span><span class='line'>
</span><span class='line'>services:
</span><span class='line'>
</span><span class='line'>  orderer1.xuyao.com:
</span><span class='line'>      container_name: orderer1.xuyao.com
</span><span class='line'>      image: hyperledger/fabric-orderer:latest
</span><span class='line'>      environment:
</span><span class='line'>        - ORDERER_GENERAL_LOGLEVEL=debug
</span><span class='line'>        - ORDERER_GENERAL_LISTENADDRESS=0.0.0.0
</span><span class='line'>        - ORDERER_GENERAL_GENESISMETHOD=file
</span><span class='line'>        - ORDERER_GENERAL_GENESISFILE=/etc/hyperledger/configtx/genesis.block
</span><span class='line'>        - ORDERER_GENERAL_LOCALMSPID=OrdererMSP
</span><span class='line'>        - ORDERER_GENERAL_LOCALMSPDIR=/etc/hyperledger/crypto/orderer/msp
</span><span class='line'>        - ORDERER_GENERAL_TLS_ENABLED=true
</span><span class='line'>        - GODEBUG=netdns=go
</span><span class='line'>        - ORDERER_GENERAL_TLS_PRIVATEKEY=/etc/hyperledger/crypto/orderer/tls/server.key
</span><span class='line'>        - ORDERER_GENERAL_TLS_CERTIFICATE=/etc/hyperledger/crypto/orderer/tls/server.crt
</span><span class='line'>        - ORDERER_GENERAL_TLS_ROOTCAS=[/etc/hyperledger/crypto/orderer/tls/ca.crt, /etc/hyperledger/crypto/peerOrg1/tls/ca.crt, /etc/hyperledger/crypto/peerOrg2/tls/ca.crt, /etc/hyperledger/crypto/peerOrg3/tls/ca.crt, /etc/hyperledger/crypto/peerOrg4/tls/ca.crt]
</span><span class='line'>        - ORDERER_KAFKA_RETRY_SHORTINTERVAL=1s
</span><span class='line'>        - ORDERER_KAFKA_RETRY_SHORTTOTAL=30s
</span><span class='line'>        - ORDERER_KAFKA_VERBOSE=true
</span><span class='line'>      working_dir: /opt/gopath/src/github.com/hyperledger/fabric/orderers
</span><span class='line'>      command: orderer
</span><span class='line'>      ports:
</span><span class='line'>        - 7050:7050
</span><span class='line'>      volumes:
</span><span class='line'>        - ./channel:/etc/hyperledger/configtx
</span><span class='line'>        - ./channel/crypto-config/ordererOrganizations/xuyao.com/orderers/orderer1.xuyao.com/:/etc/hyperledger/crypto/orderer
</span><span class='line'>        - ./channel/crypto-config/peerOrganizations/org1.xuyao.com/peers/peer0.org1.xuyao.com/:/etc/hyperledger/crypto/peerOrg1
</span><span class='line'>        - ./channel/crypto-config/peerOrganizations/org2.xuyao.com/peers/peer0.org2.xuyao.com/:/etc/hyperledger/crypto/peerOrg2
</span><span class='line'>        - ./channel/crypto-config/peerOrganizations/org3.xuyao.com/peers/peer0.org3.xuyao.com/:/etc/hyperledger/crypto/peerOrg3
</span><span class='line'>        - ./channel/crypto-config/peerOrganizations/org4.xuyao.com/peers/peer0.org4.xuyao.com/:/etc/hyperledger/crypto/peerOrg4
</span><span class='line'>        - ../mount/orderer1/var/hyperledger/production:/var/hyperledger/production
</span><span class='line'>      extra_hosts:
</span><span class='line'>        - "kafka0:10.99.22.103"
</span><span class='line'>        - "kafka1:10.99.22.109"
</span><span class='line'>        - "kafka2:10.99.22.101"
</span><span class='line'>        - "kafka3:10.99.22.121"</span></code></pre></td></tr></table></div></figure>


<h6>6.3.2ã€å¯åŠ¨Ordereré›†ç¾¤</h6>

<p> &emsp;æˆ‘ä»¬åˆ†åˆ«åœ¨server1,server2ä¸Šå¯åŠ¨ordererï¼Œç™»å½•å„æœåŠ¡å™¨ï¼Œè¿›å…¥å„è‡ªçš„é…ç½®æ–‡ä»¶ç›®å½•ä¸‹ï¼Œä½¿ç”¨å¦‚ä¸‹å‘½ä»¤å¯åŠ¨orderer</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>#å¯åŠ¨orderer0
</span><span class='line'>docker-compose -f docker-orderer0.yaml up -d
</span><span class='line'>
</span><span class='line'>#å¯åŠ¨orderer1
</span><span class='line'>docker-compose -f docker-orderer1.yaml up -d</span></code></pre></td></tr></table></div></figure>


<p>ä½¿ç”¨dockerå‘½ä»¤æŸ¥çœ‹ordererçŠ¶æ€</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>docker ps -a
</span><span class='line'>
</span><span class='line'>CONTAINER ID        IMAGE                                                                                                          COMMAND                  CREATED             STATUS              PORTS                                                                                                                                               NAMES
</span><span class='line'>806f354f4e62        hyperledger/fabric-orderer:latest                                                                              "orderer"                7 days ago          Up 7 days           0.0.0.0:7050-&gt;7050/tcp                                                                                                                              orderer1.mbasechain.com</span></code></pre></td></tr></table></div></figure>


<h5>6.4ã€å¯åŠ¨Peeré›†ç¾¤</h5>

<h6>6.4.1ã€é…ç½®docker-peer.yamlæ–‡ä»¶</h6>

<p> &emsp;peerèŠ‚ç‚¹åœ¨å››å°æœåŠ¡å™¨ä¸Šéƒ½æœ‰ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ç”Ÿæˆ4ä¸ªé…ç½®æ–‡ä»¶åˆ†åˆ«å«docker-peer0.yaml, docker-peer1yaml,docker-peer2.yaml,docker-peer3.yamlï¼Œä¸‹é¢å¯¹docker-peer0.yamlä½œé…ç½®</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>version: '2'
</span><span class='line'>
</span><span class='line'>services:
</span><span class='line'>
</span><span class='line'>  couchdb:
</span><span class='line'>    container_name: couchdb
</span><span class='line'>    image: hyperledger/fabric-couchdb:latest
</span><span class='line'>    ports:
</span><span class='line'>      - "5984:5984"
</span><span class='line'>
</span><span class='line'>  peer0.org1.xuyao.com:
</span><span class='line'>    container_name: peer0.org1.xuyao.com
</span><span class='line'>    image: hyperledger/fabric-peer:latest
</span><span class='line'>    environment:
</span><span class='line'>      - CORE_PEER_ID=peer0.org1.xuyao.com
</span><span class='line'>      - CORE_PEER_LOCALMSPID=Org1MSP
</span><span class='line'>      - CORE_PEER_ADDRESS=peer0.org1.xuyao.com:7051
</span><span class='line'>      - CORE_LEDGER_STATE_STATEDATABASE=CouchDB
</span><span class='line'>      - CORE_LEDGER_STATE_COUCHDBCONFIG_COUCHDBADDRESS=couchdb:5984
</span><span class='line'>      - CORE_VM_ENDPOINT=unix:///host/var/run/docker.sock
</span><span class='line'>      - CORE_VM_DOCKER_HOSTCONFIG_NETWORKMODE=artifacts_default
</span><span class='line'>      - CORE_LOGGING_LEVEL=debug
</span><span class='line'>      - CORE_PEER_GOSSIP_USELEADERELECTION=true
</span><span class='line'>      - CORE_PEER_GOSSIP_ORGLEADER=false
</span><span class='line'>      - GODEBUG=netdns=go
</span><span class='line'>      # The following setting skips the gossip handshake since we are
</span><span class='line'>      # are not doing mutual TLS
</span><span class='line'>      - CORE_PEER_GOSSIP_SKIPHANDSHAKE=true
</span><span class='line'>      - CORE_PEER_MSPCONFIGPATH=/etc/hyperledger/crypto/peer/msp
</span><span class='line'>      - CORE_PEER_TLS_ENABLED=true
</span><span class='line'>      - CORE_PEER_TLS_KEY_FILE=/etc/hyperledger/crypto/peer/tls/server.key
</span><span class='line'>      - CORE_PEER_TLS_CERT_FILE=/etc/hyperledger/crypto/peer/tls/server.crt
</span><span class='line'>      - CORE_PEER_TLS_ROOTCERT_FILE=/etc/hyperledger/crypto/peer/tls/ca.crt
</span><span class='line'>    working_dir: /opt/gopath/src/github.com/hyperledger/fabric/peer
</span><span class='line'>    command: peer node start
</span><span class='line'>    ports:
</span><span class='line'>      - 7051:7051
</span><span class='line'>      - 7053:7053
</span><span class='line'>    volumes:
</span><span class='line'>        - /var/run/:/host/var/run/
</span><span class='line'>        - ./channel/crypto-config/peerOrganizations/org1.mbasechain.com/peers/peer0.org1.xuyao.com/:/etc/hyperledger/crypto/peer
</span><span class='line'>        - ../mount/peer0.org1.xuyao.com/var/hyperledger/production:/var/hyperledger/production
</span><span class='line'>    depends_on:
</span><span class='line'>        - couchdb
</span><span class='line'>    extra_hosts:
</span><span class='line'>      - "orderer0.mbasechain.com:10.99.22.103"
</span><span class='line'>      - "orderer1.mbasechain.com:10.99.22.109"</span></code></pre></td></tr></table></div></figure>


<p>è¯´æ˜ï¼š<br/>
1ã€CORE_PEER_IDæ˜¯å½“å‰peerèŠ‚ç‚¹çš„idã€‚<br/>
2ã€CORE_PEER_LOCALMSPIDæ˜¯å½“å‰peerèŠ‚ç‚¹æœåŠ¡çš„æˆå‘˜æœåŠ¡æä¾›è€…idã€‚<br/>
3ã€CORE_PEER_ADDRESSæ˜¯å½“å‰peerèŠ‚ç‚¹åœ¨Fabricç½‘ç»œä¸­çš„åœ°å€ã€‚</p>

<p>docker-peer1.yaml,docker-peer2.yaml,docker-peer3.yamlæ–‡ä»¶é…ç½®å’Œdocker-peer0.yamlåŸºæœ¬ä¸€æ ·ï¼Œä¿®æ”¹ä¸€ä¸‹ä¸»è¦çš„å‚æ•°å°±è¡Œï¼Œè¿™é‡Œä¸ä¸€ä¸€åˆ—å‡º</p>

<h6>6.4.2ã€å¯åŠ¨Peeré›†ç¾¤</h6>

<p>&emsp; æˆ‘ä»¬4å°æœåŠ¡å™¨ä¸Šéƒ½æœ‰peerèŠ‚ç‚¹ï¼Œæ‰€ä»¥æˆ‘ä»¬ç°åœ¨åˆ†åˆ«ç™»å½•è¿™4å°æœåŠ¡å™¨ï¼ŒæŠŠåˆšæ‰çš„é…ç½®æ–‡ä»¶æ›´æ–°å¥½åï¼Œå°±å¯ä»¥ä¾æ¬¡å¯åŠ¨è¿™4ä¸ªpeerèŠ‚ç‚¹äº†ã€‚</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>#å¯åŠ¨peer0
</span><span class='line'>docker-compose -f docker-peer0.yaml up -d 
</span><span class='line'>
</span><span class='line'>#å¯åŠ¨peer1
</span><span class='line'>docker-compose -f docker-peer1.yaml up -d 
</span><span class='line'>
</span><span class='line'>#å¯åŠ¨peer2
</span><span class='line'>docker-compose -f docker-peer2.yaml up -d 
</span><span class='line'>
</span><span class='line'>#å¯åŠ¨peer3
</span><span class='line'>docker-compose -f docker-peer3.yaml up -d </span></code></pre></td></tr></table></div></figure>


<p>å¯åŠ¨æˆåŠŸåï¼Œæˆ‘ä»¬å†é€šè¿‡dockerå‘½ä»¤æŸ¥çœ‹peerè¿è¡ŒçŠ¶æ€</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>docker ps -a
</span><span class='line'>
</span><span class='line'>#è¿è¡ŒçŠ¶æ€
</span><span class='line'>CONTAINER ID        IMAGE                                                                                                          COMMAND                  CREATED             STATUS              PORTS                                                                                                                                               NAMES
</span><span class='line'>7a2582136861        hyperledger/fabric-peer:latest                                                                                 "peer node start"        7 days ago          Up 7 days           0.0.0.0:7051-&gt;7051/tcp, 0.0.0.0:7053-&gt;7053/tcp                                                                                                      peer0.org1.mbasechain.com</span></code></pre></td></tr></table></div></figure>


<h5>6.5ã€å¯åŠ¨Caé›†ç¾¤</h5>

<h6>6.5.1ã€é…ç½®docker-ca-org.yamlæ–‡ä»¶</h6>

<p>&emsp; caåœ¨4å°æœåŠ¡å™¨ä¹Ÿéƒ½æœ‰ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ç”Ÿæˆ4ä¸ªæ–‡ä»¶æ¥åˆ†åˆ«é…ç½®4ä¸ªcaï¼Œç°ç”Ÿæˆ4ä¸ªdockeré…ç½®æ–‡ä»¶ä¸º docker-ca-org0.yaml,docker-ca-org1.yaml,docker-ca-org2.yaml,docker-ca-org3.yaml,é…ç½®å¦‚ä¸‹</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>version: '2'
</span><span class='line'>
</span><span class='line'>services:
</span><span class='line'>
</span><span class='line'>  ca.org1.xuyao.com:
</span><span class='line'>    container_name: ca
</span><span class='line'>    image: hyperledger/fabric-ca:latest
</span><span class='line'>    environment:
</span><span class='line'>      - FABRIC_CA_HOME=/etc/hyperledger/fabric-ca-server
</span><span class='line'>      - FABRIC_CA_SERVER_CA_NAME=ca.org1.xuyao.com
</span><span class='line'>      - FABRIC_CA_SERVER_CA_CERTFILE=/etc/hyperledger/fabric-ca-server-config/ca.ORG_NAME-cert.pem
</span><span class='line'>      - FABRIC_CA_SERVER_CA_KEYFILE=/etc/hyperledger/fabric-ca-server-config/9af18a6c9dd8f34db73a70c1d066e6948216db534af9e4f89029158089d56cf1_sk
</span><span class='line'>      - FABRIC_CA_SERVER_TLS_ENABLED=true
</span><span class='line'>      - FABRIC_CA_SERVER_TLS_CERTFILE=/etc/hyperledger/fabric-ca-server-config/ca.org1.xuyao.com-cert.pem
</span><span class='line'>      - FABRIC_CA_SERVER_TLS_KEYFILE=/etc/hyperledger/fabric-ca-server-config/9af18a6c9dd8f34db73a70c1d066e6948216db534af9e4f89029158089d56cf1_sk
</span><span class='line'>    ports:
</span><span class='line'>      - "7054:7054"
</span><span class='line'>    command: sh -c 'fabric-ca-server start -b admin:adminpw -d'
</span><span class='line'>    volumes:
</span><span class='line'>      - ./channel/crypto-config/peerOrganizations/org1.xuyao.com/ca/:/etc/hyperledger/fabric-ca-server-config
</span><span class='line'>    container_name: ca.org1.xuyao.com</span></code></pre></td></tr></table></div></figure>


<p>å…¶å®ƒä¸‰ä¸ªé…ç½®æ–‡ä»¶æ ¹æ®caçš„åå­—ä¸åŒï¼Œæ”¹ä¸‹ä¸€äº›å‚æ•°åå­—å°±è¡Œï¼Œå°†è¿™äº›æ–‡ä»¶é…ç½®å¥½åï¼Œæäº¤åˆ°è¿œç¨‹ä»“åº“</p>

<h6>6.5.2ã€å¯åŠ¨Caé›†ç¾¤</h6>

<p>&emsp; ç°åœ¨æˆ‘ä»¬åˆ†åˆ«ç™»å½•4å°æœåŠ¡å™¨ï¼ŒæŠŠåˆšæ‰ä¿®æ”¹çš„é…ç½®æ–‡ä»¶ä¸‹æ¥ï¼Œå‡†å¤‡å¯åŠ¨caæœåŠ¡ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>#å¯åŠ¨ca-org0
</span><span class='line'>docker-compose  -f docker-ca-org0.yaml up -d
</span><span class='line'>
</span><span class='line'>#å¯åŠ¨ca-org1
</span><span class='line'>docker-compose  -f docker-ca-org1.yaml up -d
</span><span class='line'>
</span><span class='line'>#å¯åŠ¨ca-org2
</span><span class='line'>docker-compose  -f docker-ca-org2.yaml up -d
</span><span class='line'>
</span><span class='line'>#å¯åŠ¨ca-org3
</span><span class='line'>docker-compose  -f docker-ca-org3.yaml up -d</span></code></pre></td></tr></table></div></figure>


<p>è‡³æ­¤æ•´ä¸ªFabricç½‘ç»œæ‰€éœ€çš„èŠ‚ç‚¹éƒ½å·²ç»å¯åŠ¨å®Œäº†ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å‘½ä»¤æ¥æŸ¥çœ‹å„ä¸ªæœåŠ¡å™¨æ‰€æœ‰æ­£åœ¨è¿è¡Œçš„æœåŠ¡</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>#æŸ¥çœ‹æ‰€ä»¥æœåŠ¡
</span><span class='line'>docker ps -a
</span><span class='line'>
</span><span class='line'>CONTAINER ID        IMAGE                                                                                                          COMMAND                  CREATED             STATUS              PORTS                                                                                                                                               NAMES
</span><span class='line'>96529e278e54        hyperledger/fabric-ca:latest                                                                                   "sh -c 'fabric-ca-seâ€¦"   7 days ago          Up 7 days           0.0.0.0:7054-&gt;7054/tcp                                                                                                                              ca.org1.mbasechain.com
</span><span class='line'>7a2582136861        hyperledger/fabric-peer:latest                                                                                 "peer node start"        7 days ago          Up 7 days           0.0.0.0:7051-&gt;7051/tcp, 0.0.0.0:7053-&gt;7053/tcp                                                                                                      peer0.org1.mbasechain.com
</span><span class='line'>49b5ee98950b        hyperledger/fabric-couchdb:latest                                                                              "tini -- /docker-entâ€¦"   7 days ago          Up 7 days           4369/tcp, 9100/tcp, 0.0.0.0:5984-&gt;5984/tcp                                                                                                          couchdb
</span><span class='line'>806f354f4e62        hyperledger/fabric-orderer:latest                                                                              "orderer"                7 days ago          Up 7 days           0.0.0.0:7050-&gt;7050/tcp                                                                                                                              orderer1.mbasechain.com
</span><span class='line'>4bde08ae4413        hyperledger/fabric-kafka                                                                                       "/docker-entrypoint.â€¦"   7 days ago          Up 7 days           0.0.0.0:9092-&gt;9092/tcp, 9093/tcp, 0.0.0.0:32774-&gt;9092/tcp                                                                                           kafka0
</span><span class='line'>980c8bb7190d        hyperledger/fabric-zookeeper                                                                                   "/docker-entrypoint.â€¦"   7 days ago          Up 7 days           0.0.0.0:2181-&gt;2181/tcp, 0.0.0.0:2888-&gt;2888/tcp, 0.0.0.0:3888-&gt;3888/tcp, 0.0.0.0:32773-&gt;2181/tcp, 0.0.0.0:32772-&gt;2888/tcp, 0.0.0.0:32771-&gt;3888/tcp   zookeeper0</span></code></pre></td></tr></table></div></figure>


<p>å¯ä»¥çœ‹åˆ°dockeré‡Œè¿è¡Œäº†zookeeper,kafka,orderer, peer, ca, couchdb6ä¸ªæœåŠ¡ï¼Œåˆ°è¿™é‡Œæ•´ä¸ªFabricå¯åŠ¨å·¥ä½œå°±å…¨éƒ¨åšå¥½äº†ï¼Œä¸‹ç¯‡æ–‡ç« å°†å†™å®‰è£…channelå’Œchaincode</p>

<h5>æœªå®Œå¾…ç»­ã€‚ã€‚ã€‚</h5>

<h4>å‚è€ƒèµ„æ–™</h4>

<p>ã€HyperLedger Fabric å¼€å‘å®æˆ˜ã€‘
<a href="https://www.jianshu.com/p/040a09e2098e">https://www.jianshu.com/p/040a09e2098e</a><br/>
<a href="https://yeasy.gitbooks.io/docker_practice/data_management/volume.html">https://yeasy.gitbooks.io/docker_practice/data_management/volume.html</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Fabricå¤šå°æœåŠ¡å™¨çš„éƒ¨ç½²(äºŒ)]]></title>
    <link href="http://xuyao.club/blog/2018/12/14/deployment-of-fabric-multiple-servers-ii/"/>
    <updated>2018-12-14T14:27:46+08:00</updated>
    <id>http://xuyao.club/blog/2018/12/14/deployment-of-fabric-multiple-servers-ii</id>
    <content type="html"><![CDATA[<h3>3ã€ä¸‹è½½Fabricé•œåƒ</h3>

<h5>3.1.1 ä¸‹è½½Fabric æºç </h5>

<p> 1ã€åœ¨åé¢çš„ä¾‹å­ä¸­ï¼Œæœ‰äº›åœ°æ–¹éœ€è¦ç”¨åˆ°æºç ä¸­æåˆ°çš„å·¥å…·æ¥ç¼–è¯‘å’Œç”Ÿæˆè¯ä¹¦ç­‰ï¼Œè¿™é‡Œéœ€è¦ä¸‹è½½ä¸€ä¸‹Fabricçš„æºç ï¼Œåœ¨æœ¬åœ°ä¸‹è½½Fabricå®˜æ–¹æä¾›çš„æºç </p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>git clone git@github.com:hyperledger/fabric.git</span></code></pre></td></tr></table></div></figure>


<p>éœ€è¦æ³¨æ„çš„æ—¶å€™ï¼Œéœ€è¦æŠŠä¸‹è½½å¥½çš„æºç æ”¾åœ¨$GOPATHé‡Œï¼Œè¿™ä¸ªç¯å¢ƒå˜é‡æ˜¯æœ€åˆå®‰è£…GOçš„è®¾ç½®çš„ï¼Œå¦‚</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>echo $GOPATH
</span><span class='line'>/Users/xuyao/go</span></code></pre></td></tr></table></div></figure>


<p>é‚£ä¹ˆfabricçš„æºç åœ°å€è·¯å¾„åº”è¯¥æ˜¯</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>/Users/xuyao/go/src/github.com/hyperledger/fabric/</span></code></pre></td></tr></table></div></figure>


<!-- more -->


<h5>3.1.2 ä¸‹è½½Fabricé•œåƒ</h5>

<p> &emsp;å¦‚æœä½ çœ‹è¿‡Fabricå®˜æ–¹çš„å¿«é€Ÿå…¥é—¨æ–‡æ¡£<a href="https://hyperledgercn.github.io/hyperledgerDocs/getting_started/">https://hyperledgercn.github.io/hyperledgerDocs/getting_started/</a>ï¼Œåº”è¯¥ä¼šå¯¹Fabricçš„é•œåƒæ–‡ä»¶æœ‰ä¸ªäº†è§£ï¼Œåœ¨fabric/examples/e2e_cliæ–‡ä»¶å¤¹ä¸‹æœ‰ä¸ªdownload-dockerimages.shçš„è„šæœ¬æ–‡ä»¶ï¼Œä»–ä¼šå¸®ä½ ä¸€é”®ä¸‹è½½æ‰€éœ€çš„é•œåƒæ–‡ä»¶ã€‚</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># ä½¿è„šæœ¬å¯æ‰§è¡Œ
</span><span class='line'>chmod +x download-dockerimages.sh
</span><span class='line'># æ‰§è¡Œè„šæœ¬
</span><span class='line'>./download-dockerimages.sh</span></code></pre></td></tr></table></div></figure>


<p>å½“ç„¶ä¹Ÿå¯ä»¥ä½¿ç”¨ä¸‹é¢å‘½ä»¤ä¸‹è½½é•œåƒ(éœ€è¦ç¿»å¢™)</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>curl -sSL http://bit.ly/2ysbOFE | bash -s 1.2.0 
</span><span class='line'>#æ­¤å¤„æ˜¯ä¸‹è½½fabric-samplesï¼Œå¦‚æœæƒ³å¿«é€Ÿä½¿ç”¨byfnå¯ä»¥å‚è€ƒæ­¤è„šæœ¬ï¼Œåé¢1.2.0æ˜¯å¯¹åº”çš„ç‰ˆæœ¬å·</span></code></pre></td></tr></table></div></figure>


<p>ä¹Ÿå¯ä»¥æ ¹æ®è‡ªå·±é¡¹ç›®éœ€æ±‚ä¸‹è½½ä¸åŒçš„ç‰ˆæœ¬</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>curl -sSL http://bit.ly/2ysbOFE | bash -s &lt;fabric&gt; &lt;fabric-ca&gt; &lt;thirdparth&gt;
</span><span class='line'>curl -sSL http://bit.ly/2ysbOFE | bash -s 1.2.0 1.2.0 0.4.10
</span><span class='line'>#åé¢ä¸‰ä¸ªå‚æ•°åˆ†åˆ«ä»£è¡¨Fabric, Fabric-caå’Œç¬¬ä¸‰æ–¹å¹³å°é•œåƒç‰ˆæœ¬å·</span></code></pre></td></tr></table></div></figure>


<p>æ— æ³•ç¿»å¢™ï¼Œå¯ä»¥ç”¨ä¸‹é¢å‘½ä»¤</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>curl -sSL https://raw.githubusercontent.com/hyperledger/fabric/master/scripts/bootstrap.sh | bash -s 1.2.0 1.2.0 0.4.10</span></code></pre></td></tr></table></div></figure>


<p>ä¸‹è½½å®Œæˆåä½¿ç”¨docker imageså¯ä»¥çœ‹åˆ°ä¸‹è½½çš„é•œåƒæ–‡ä»¶</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>docker images #æŸ¥çœ‹æ‰€ä»¥é•œåƒæ–‡ä»¶
</span><span class='line'>hyperledger/fabric-ca          latest               35311d8617b4        7 days ago          240 MB
</span><span class='line'>hyperledger/fabric-ca          x86_64-1.0.0-alpha   35311d8617b4        7 days ago          240 MB
</span><span class='line'>hyperledger/fabric-couchdb     latest               f3ce31e25872        7 days ago          1.51 GB
</span><span class='line'>hyperledger/fabric-couchdb     x86_64-1.0.0-alpha   f3ce31e25872        7 days ago          1.51 GB
</span><span class='line'>hyperledger/fabric-kafka       latest               589dad0b93fc        7 days ago          1.3 GB
</span><span class='line'>hyperledger/fabric-kafka       x86_64-1.0.0-alpha   589dad0b93fc        7 days ago          1.3 GB
</span><span class='line'>hyperledger/fabric-zookeeper   latest               9a51f5be29c1        7 days ago          1.31 GB
</span><span class='line'>hyperledger/fabric-zookeeper   x86_64-1.0.0-alpha   9a51f5be29c1        7 days ago          1.31 GB
</span><span class='line'>hyperledger/fabric-orderer     latest               5685fd77ab7c        7 days ago          182 MB
</span><span class='line'>hyperledger/fabric-orderer     x86_64-1.0.0-alpha   5685fd77ab7c        7 days ago          182 MB
</span><span class='line'>hyperledger/fabric-peer        latest               784c5d41ac1d        7 days ago          184 MB
</span><span class='line'>hyperledger/fabric-peer        x86_64-1.0.0-alpha   784c5d41ac1d        7 days ago          184 MB
</span><span class='line'>hyperledger/fabric-javaenv     latest               a08f85d8f0a9        7 days ago          1.42 GB
</span><span class='line'>hyperledger/fabric-javaenv     x86_64-1.0.0-alpha   a08f85d8f0a9        7 days ago          1.42 GB
</span><span class='line'>hyperledger/fabric-ccenv       latest               91792014b61f        7 days ago          1.29 GB
</span><span class='line'>hyperledger/fabric-ccenv       x86_64-1.0.0-alpha   91792014b61f        7 days ago          1.29 GB</span></code></pre></td></tr></table></div></figure>


<h5>3.1.3 å¸¸ç”¨çš„Docker å‘½ä»¤</h5>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>#åœæ­¢æ­£åœ¨è¿è¡Œçš„æ‰€æœ‰ç½‘ç»œ
</span><span class='line'>docker stop -f $(docker ps -aq)
</span><span class='line'>
</span><span class='line'>#åˆ é™¤æ­£åœ¨è¿è¡Œçš„æ‰€æœ‰ç½‘ç»œ
</span><span class='line'>docker rm -f $(docker ps -aq)
</span><span class='line'>
</span><span class='line'>#åˆ é™¤æŸä¸ªé•œåƒ
</span><span class='line'>docker rmi &lt;IMAGE ID&gt;
</span><span class='line'>
</span><span class='line'>#æŸ¥çœ‹æŸä¸ªå®¹å™¨çš„æ—¥å¿—
</span><span class='line'>docker logs -f  &lt; container-id &gt;
</span><span class='line'>
</span><span class='line'>#è¿›å…¥æŸä¸ªå®¹å™¨å†…éƒ¨
</span><span class='line'>docker exec -it &lt; container-id &gt; bash
</span><span class='line'>
</span><span class='line'>#æŸ¥çœ‹docker è¿è¡ŒçŠ¶æ€
</span><span class='line'>service docker status
</span><span class='line'>
</span><span class='line'># å¯åŠ¨/å…³é—­docker
</span><span class='line'>sudo service docker start|stop</span></code></pre></td></tr></table></div></figure>


<h4>4ã€ä¸‹è½½ Fabric-sample æºç </h4>

<p>1ã€fabric-sampleé‡Œæœ‰å¾ˆå¤šå¿«é€Ÿå¯åŠ¨fabricçš„ä¾‹å­ï¼Œå®˜æ–¹æ–‡æ¡£ç»™äº†ä¸€ä¸ªå¿«é€Ÿå¯åŠ¨first-networkçš„ä¾‹å­ <a href="https://hyperledgercn.github.io/hyperledgerDocs/build_network_zh/">https://hyperledgercn.github.io/hyperledgerDocs/build_network_zh/</a>ï¼Œåœ¨first-networké‡Œé¢ï¼Œæ¯ä¸ªç»„ç»‡æŒæœ‰2ä¸ªpeerèŠ‚ç‚¹ï¼Œä»¥åŠä¸€ä¸ªâ€œsoloâ€æ’åºæœåŠ¡ï¼Œè¿™é‡Œä¸€ä¸ªæ¯”è¾ƒç®€å•çš„fabricç½‘ç»œï¼Œå¦‚æœåªæ˜¯æƒ³è·‘ä¸€ä¸‹fabricç½‘ç»œï¼Œè¯•ä¸‹æ‰‹æ„Ÿçš„è¯ï¼Œå¯ä»¥æŒ‰ç…§å®˜æ–¹çš„æ–‡æ¡£æ¥è·‘ä¸€ç¯‡ã€‚<br/>
 &emsp; è¿™é‡Œæˆ‘ä»¬ç”¨çš„æ˜¯å®˜ç½‘æä¾›çš„å¦ä¸€ä¸ªä¾‹å­ï¼Œbalance-transferï¼Œå®ƒæ˜¯ä¸€ä¸ªé›†æˆäº†nodejs sdkçš„ä¸€ä¸ªnode.jsçš„ç®€å•ä¾‹å­ã€‚</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>#ä¸‹è½½fabric-sample
</span><span class='line'>git clone git@github.com:hyperledger/fabric-samples.git</span></code></pre></td></tr></table></div></figure>


<p> 2ã€åæœŸæˆ‘ä»¬çš„é¡¹ç›®éƒ½æ˜¯ç”¨nodejsæ¥åšçš„ï¼Œæ‰€ä»¥å¾ˆå¤šåŸºç¡€çš„ä¸œè¥¿å¯ä»¥å¤ç”¨balance-transferé‡Œçš„ï¼Œç°åœ¨æˆ‘ä»¬å¯ä»¥è‡ªå·±å»ºäº†é¡¹ç›®ä»“åº“å«trace_redwineï¼ŒæŠŠfabric-samples/balance-transfer/é‡Œçš„æ–‡ä»¶å…¨éƒ¨copyåˆ°æˆ‘ä»¬çš„trace_redwineé‡Œ,åˆ é™¤ä¸€äº›ä¸å¿…è¦çš„æ–‡ä»¶ï¼Œè¿™é‡Œä¸€ä¸ªè‡ªå·±çš„fabricé¡¹ç›®é›å½¢å°±å‡ºæ¥äº†ã€‚</p>

<h4>5ã€ä¿®æ”¹é…ç½®è„šæœ¬</h4>

<h5>5.1.1 ä¿®æ”¹crypto-config.yamlæ–‡ä»¶</h5>

<p> &emsp; crypto-config.yamlæ–‡ä»¶æ˜¯é…ç½®èŠ‚ç‚¹ä¿¡æ¯çš„ï¼Œä½ å¯ä»¥é…ç½®ä½ çš„orderer,peeræ•°é‡ï¼Œä»¥åŠåŸŸåçš„è®¾ç½®ï¼Œä¸»è¦é…ç½®çš„æ˜¯OrdererOrgså’ŒPeerOrgs<br/>
OrdererOrgsçš„é…ç½®</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>OrdererOrgs:
</span><span class='line'>  - Name: Orderer
</span><span class='line'>    Domain: xuyao.com
</span><span class='line'>    Specs:
</span><span class='line'>      - Hostname: orderer1
</span><span class='line'>      - Hostname: orderer2</span></code></pre></td></tr></table></div></figure>


<p>PeerOrgsçš„é…ç½®ä¿¡æ¯</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>PeerOrgs:
</span><span class='line'>  - Name: Org1 #ç»„ç»‡1
</span><span class='line'>    Domain: org1.xuyao.com
</span><span class='line'>    EnableNodeOUs: true
</span><span class='line'>    Template:
</span><span class='line'>      Count: 2
</span><span class='line'>    Users:
</span><span class='line'>      Count: 1
</span><span class='line'>  - Name: Org2 #ç»„ç»‡2
</span><span class='line'>    Domain: org2.xuyao.com
</span><span class='line'>    EnableNodeOUs: true
</span><span class='line'>    Template:
</span><span class='line'>      Count: 2
</span><span class='line'>    Users:
</span><span class='line'>      Count: 1</span></code></pre></td></tr></table></div></figure>


<h5>5.1.2 ä½¿ç”¨generateArtifacts.shè„šæœ¬ç”Ÿæˆè¯ä¹¦æ–‡ä»¶</h5>

<p>&emsp; ç°åœ¨æˆ‘ä»¬éœ€è¦ç”Ÿæˆä¸€äº›è¯ä¹¦å’Œå¯åŠ¨è¿™ä¸ªfabricç½‘ç»œï¼Œç”Ÿæˆè¯ä¹¦çš„è¯æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å®˜ç½‘æä¾›çš„generateArtifacts.shè„šæœ¬æ¥ç”Ÿæˆï¼Œæ–‡ä»¶è·¯å¾„åœ¨/gopath/src/github.com/hyperledger/fabric/examples/e2e_cli/ä¸‹ï¼Œç¨å¾®ä¿®æ”¹ï¼Œå› ä¸ºæˆ‘åªéœ€è¦ç”Ÿæˆè¯ä¹¦ï¼Œåˆ›ä¸–çºªå—ï¼Œå’Œchannel.tx,å…·ä½“è„šæœ¬å¦‚ä¸‹ï¼Œ<strong>éœ€è¦è¯´æ˜çš„æ˜¯å¦‚æœä½ åªæ˜¯è¿è¡Œå®˜æ–¹çš„first-networkï¼Œå¯ä»¥å¿½ç•¥è¿™äº›é…ç½®ï¼Œå› ä¸ºfirst-networkå·²ç»å¸®ä½ ç”Ÿæˆå¥½äº†è¿™äº›ä¸œè¥¿</strong></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>#!/usr/bin/env bash
</span><span class='line'>CRYPTOGEN=$PWD/bin/cryptogen
</span><span class='line'>CONFIGTXGEN=$PWD/bin/configtxgen
</span><span class='line'>CHANNEL_NAME=$1
</span><span class='line'>: ${CHANNEL_NAME:="mychannel"}
</span><span class='line'>function buildCryptogenTools(){
</span><span class='line'>  if [ -f "$CONFIGTXGEN" ]; then
</span><span class='line'>      echo
</span><span class='line'>  else
</span><span class='line'>      echo "configtxgen not found"
</span><span class='line'>      exit 1
</span><span class='line'>  fi
</span><span class='line'>}
</span><span class='line'>
</span><span class='line'>function createPeerTemplate() {
</span><span class='line'>    cp ../docker-composer-peer-template.yaml ../docker-composer
</span><span class='line'>}
</span><span class='line'>
</span><span class='line'>## Generates Org certs using cryptogen tool
</span><span class='line'>function generateCerts (){
</span><span class='line'>  echo
</span><span class='line'>  echo "##########################################################"
</span><span class='line'>  echo "##### Generate certificates using cryptogen tool #########"
</span><span class='line'>  echo "##########################################################"
</span><span class='line'>  if [ -d "crypto-config" ]; then
</span><span class='line'>      rm -Rf crypto-config
</span><span class='line'>    fi
</span><span class='line'>  ${CRYPTOGEN} generate --config=./crypto-config.yaml
</span><span class='line'>  echo
</span><span class='line'>}
</span><span class='line'>
</span><span class='line'>## Generate orderer genesis block , channel configuration transaction and anchor peer update transactions
</span><span class='line'>function generateChannelArtifacts() {
</span><span class='line'>  echo "##########################################################"
</span><span class='line'>  echo "#########  Generating Orderer Genesis block ##############"
</span><span class='line'>  echo "##########################################################"
</span><span class='line'>  ${CONFIGTXGEN} -profile TwoOrgsOrdererGenesis -outputBlock ./genesis.block
</span><span class='line'>
</span><span class='line'>  echo
</span><span class='line'>  echo "#################################################################"
</span><span class='line'>  echo "### Generating channel configuration transaction 'channel.tx' ###"
</span><span class='line'>  echo "#################################################################"
</span><span class='line'>  ${CONFIGTXGEN} -profile TwoOrgsChannel -outputCreateChannelTx ./mychannel.tx -channelID ${CHANNEL_NAME} 
</span><span class='line'>}
</span><span class='line'>
</span><span class='line'>buildCryptogenTools
</span><span class='line'>generateCerts
</span><span class='line'>generateChannelArtifacts</span></code></pre></td></tr></table></div></figure>


<p>generateCertsæ˜¯ç”Ÿæˆè¯ä¹¦çš„æ–¹æ³•ï¼Œå®ƒä¼šåŠ è½½crypto-config.yamlé‡Œçš„é…ç½®ä¿¡æ¯ï¼Œå¹¶æ ¹æ®ä½ çš„é…ç½®ä¿¡æ¯æ¥ç”Ÿæˆç›¸åº”çš„è¯ä¹¦ã€‚<br/>
generateChannelArtifactsæ˜¯ç”Ÿæˆordererçš„åˆ›ä¸–çºªå—ï¼ˆgenesis.blockï¼‰å’Œchannel.txæ–‡ä»¶ã€‚<br/>
ä¸Šé¢çš„è„šæœ¬è¿è¡Œä¹‹åï¼Œæ•´ä¸ªFabricç½‘ç»œéœ€è¦çš„ä¸€äº›è¯ä¹¦å°±å®Œæˆäº†ï¼Œä»¥æœ¬åœ°ä¾‹å­ä¸ºä¾‹ï¼Œç”Ÿæˆå¦‚ä¸‹çš„ä¸€äº›æ–‡ä»¶æ•°æ®</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
<span class='line-number'>100</span>
<span class='line-number'>101</span>
<span class='line-number'>102</span>
<span class='line-number'>103</span>
<span class='line-number'>104</span>
<span class='line-number'>105</span>
<span class='line-number'>106</span>
<span class='line-number'>107</span>
<span class='line-number'>108</span>
<span class='line-number'>109</span>
<span class='line-number'>110</span>
<span class='line-number'>111</span>
<span class='line-number'>112</span>
<span class='line-number'>113</span>
<span class='line-number'>114</span>
<span class='line-number'>115</span>
<span class='line-number'>116</span>
<span class='line-number'>117</span>
<span class='line-number'>118</span>
<span class='line-number'>119</span>
<span class='line-number'>120</span>
<span class='line-number'>121</span>
<span class='line-number'>122</span>
<span class='line-number'>123</span>
<span class='line-number'>124</span>
<span class='line-number'>125</span>
<span class='line-number'>126</span>
<span class='line-number'>127</span>
<span class='line-number'>128</span>
<span class='line-number'>129</span>
<span class='line-number'>130</span>
<span class='line-number'>131</span>
<span class='line-number'>132</span>
<span class='line-number'>133</span>
<span class='line-number'>134</span>
<span class='line-number'>135</span>
<span class='line-number'>136</span>
<span class='line-number'>137</span>
<span class='line-number'>138</span>
<span class='line-number'>139</span>
<span class='line-number'>140</span>
<span class='line-number'>141</span>
<span class='line-number'>142</span>
<span class='line-number'>143</span>
<span class='line-number'>144</span>
<span class='line-number'>145</span>
<span class='line-number'>146</span>
<span class='line-number'>147</span>
<span class='line-number'>148</span>
<span class='line-number'>149</span>
<span class='line-number'>150</span>
<span class='line-number'>151</span>
<span class='line-number'>152</span>
<span class='line-number'>153</span>
<span class='line-number'>154</span>
<span class='line-number'>155</span>
<span class='line-number'>156</span>
<span class='line-number'>157</span>
<span class='line-number'>158</span>
<span class='line-number'>159</span>
<span class='line-number'>160</span>
<span class='line-number'>161</span>
<span class='line-number'>162</span>
<span class='line-number'>163</span>
<span class='line-number'>164</span>
<span class='line-number'>165</span>
<span class='line-number'>166</span>
<span class='line-number'>167</span>
<span class='line-number'>168</span>
<span class='line-number'>169</span>
<span class='line-number'>170</span>
<span class='line-number'>171</span>
<span class='line-number'>172</span>
<span class='line-number'>173</span>
<span class='line-number'>174</span>
<span class='line-number'>175</span>
<span class='line-number'>176</span>
<span class='line-number'>177</span>
<span class='line-number'>178</span>
<span class='line-number'>179</span>
<span class='line-number'>180</span>
<span class='line-number'>181</span>
<span class='line-number'>182</span>
<span class='line-number'>183</span>
<span class='line-number'>184</span>
<span class='line-number'>185</span>
<span class='line-number'>186</span>
<span class='line-number'>187</span>
<span class='line-number'>188</span>
<span class='line-number'>189</span>
<span class='line-number'>190</span>
<span class='line-number'>191</span>
<span class='line-number'>192</span>
<span class='line-number'>193</span>
<span class='line-number'>194</span>
<span class='line-number'>195</span>
<span class='line-number'>196</span>
<span class='line-number'>197</span>
<span class='line-number'>198</span>
<span class='line-number'>199</span>
<span class='line-number'>200</span>
<span class='line-number'>201</span>
<span class='line-number'>202</span>
<span class='line-number'>203</span>
<span class='line-number'>204</span>
<span class='line-number'>205</span>
<span class='line-number'>206</span>
<span class='line-number'>207</span>
<span class='line-number'>208</span>
<span class='line-number'>209</span>
<span class='line-number'>210</span>
<span class='line-number'>211</span>
<span class='line-number'>212</span>
<span class='line-number'>213</span>
<span class='line-number'>214</span>
<span class='line-number'>215</span>
<span class='line-number'>216</span>
<span class='line-number'>217</span>
<span class='line-number'>218</span>
<span class='line-number'>219</span>
<span class='line-number'>220</span>
<span class='line-number'>221</span>
<span class='line-number'>222</span>
<span class='line-number'>223</span>
<span class='line-number'>224</span>
<span class='line-number'>225</span>
<span class='line-number'>226</span>
<span class='line-number'>227</span>
<span class='line-number'>228</span>
<span class='line-number'>229</span>
<span class='line-number'>230</span>
<span class='line-number'>231</span>
<span class='line-number'>232</span>
<span class='line-number'>233</span>
<span class='line-number'>234</span>
<span class='line-number'>235</span>
<span class='line-number'>236</span>
<span class='line-number'>237</span>
<span class='line-number'>238</span>
<span class='line-number'>239</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>â”œâ”€â”€ crypto-config
</span><span class='line'>â”‚Â Â  â”œâ”€â”€ ordererOrganizations
</span><span class='line'>â”‚Â Â  â”‚Â Â  â””â”€â”€ mbasechain.com
</span><span class='line'>â”‚Â Â  â”‚Â Â      â”œâ”€â”€ ca
</span><span class='line'>â”‚Â Â  â”‚Â Â      â”‚Â Â  â”œâ”€â”€ 2ae1db347d3137d66fda66f59fb33cd2c3c22a4aadf7f97f800491fb91a20c32_sk
</span><span class='line'>â”‚Â Â  â”‚Â Â      â”‚Â Â  â””â”€â”€ ca.mbasechain.com-cert.pem
</span><span class='line'>â”‚Â Â  â”‚Â Â      â”œâ”€â”€ msp
</span><span class='line'>â”‚Â Â  â”‚Â Â      â”‚Â Â  â”œâ”€â”€ admincerts
</span><span class='line'>â”‚Â Â  â”‚Â Â      â”‚Â Â  â”‚Â Â  â””â”€â”€ Admin@mbasechain.com-cert.pem
</span><span class='line'>â”‚Â Â  â”‚Â Â      â”‚Â Â  â”œâ”€â”€ cacerts
</span><span class='line'>â”‚Â Â  â”‚Â Â      â”‚Â Â  â”‚Â Â  â””â”€â”€ ca.mbasechain.com-cert.pem
</span><span class='line'>â”‚Â Â  â”‚Â Â      â”‚Â Â  â””â”€â”€ tlscacerts
</span><span class='line'>â”‚Â Â  â”‚Â Â      â”‚Â Â      â””â”€â”€ tlsca.mbasechain.com-cert.pem
</span><span class='line'>â”‚Â Â  â”‚Â Â      â”œâ”€â”€ orderers
</span><span class='line'>â”‚Â Â  â”‚Â Â      â”‚Â Â  â”œâ”€â”€ orderer.mbasechain.com
</span><span class='line'>â”‚Â Â  â”‚Â Â      â”‚Â Â  â”‚Â Â  â””â”€â”€ msp
</span><span class='line'>â”‚Â Â  â”‚Â Â      â”‚Â Â  â”‚Â Â      â””â”€â”€ keystore
</span><span class='line'>â”‚Â Â  â”‚Â Â      â”‚Â Â  â”œâ”€â”€ orderer1.mbasechain.com
</span><span class='line'>â”‚Â Â  â”‚Â Â      â”‚Â Â  â”‚Â Â  â”œâ”€â”€ msp
</span><span class='line'>â”‚Â Â  â”‚Â Â      â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ admincerts
</span><span class='line'>â”‚Â Â  â”‚Â Â      â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ Admin@mbasechain.com-cert.pem
</span><span class='line'>â”‚Â Â  â”‚Â Â      â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ cacerts
</span><span class='line'>â”‚Â Â  â”‚Â Â      â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ ca.mbasechain.com-cert.pem
</span><span class='line'>â”‚Â Â  â”‚Â Â      â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ keystore
</span><span class='line'>â”‚Â Â  â”‚Â Â      â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ 9af18a6c9dd8f34db73a70c1d066e6948216db534af9e4f89029158089d56cf1_sk
</span><span class='line'>â”‚Â Â  â”‚Â Â      â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ signcerts
</span><span class='line'>â”‚Â Â  â”‚Â Â      â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ orderer1.mbasechain.com-cert.pem
</span><span class='line'>â”‚Â Â  â”‚Â Â      â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ tlscacerts
</span><span class='line'>â”‚Â Â  â”‚Â Â      â”‚Â Â  â”‚Â Â  â”‚Â Â      â””â”€â”€ tlsca.mbasechain.com-cert.pem
</span><span class='line'>â”‚Â Â  â”‚Â Â      â”‚Â Â  â”‚Â Â  â””â”€â”€ tls
</span><span class='line'>â”‚Â Â  â”‚Â Â      â”‚Â Â  â”‚Â Â      â”œâ”€â”€ ca.crt
</span><span class='line'>â”‚Â Â  â”‚Â Â      â”‚Â Â  â”‚Â Â      â”œâ”€â”€ server.crt
</span><span class='line'>â”‚Â Â  â”‚Â Â      â”‚Â Â  â”‚Â Â      â””â”€â”€ server.key
</span><span class='line'>â”‚Â Â  â”‚Â Â      â”‚Â Â  â””â”€â”€ orderer2.mbasechain.com
</span><span class='line'>â”‚Â Â  â”‚Â Â      â”‚Â Â      â”œâ”€â”€ msp
</span><span class='line'>â”‚Â Â  â”‚Â Â      â”‚Â Â      â”‚Â Â  â”œâ”€â”€ admincerts
</span><span class='line'>â”‚Â Â  â”‚Â Â      â”‚Â Â      â”‚Â Â  â”‚Â Â  â””â”€â”€ Admin@mbasechain.com-cert.pem
</span><span class='line'>â”‚Â Â  â”‚Â Â      â”‚Â Â      â”‚Â Â  â”œâ”€â”€ cacerts
</span><span class='line'>â”‚Â Â  â”‚Â Â      â”‚Â Â      â”‚Â Â  â”‚Â Â  â””â”€â”€ ca.mbasechain.com-cert.pem
</span><span class='line'>â”‚Â Â  â”‚Â Â      â”‚Â Â      â”‚Â Â  â”œâ”€â”€ keystore
</span><span class='line'>â”‚Â Â  â”‚Â Â      â”‚Â Â      â”‚Â Â  â”‚Â Â  â””â”€â”€ fb54a7774228bf31311b5aa0ab58b4c0d3f9aa0e83bb1906cb6926c033445976_sk
</span><span class='line'>â”‚Â Â  â”‚Â Â      â”‚Â Â      â”‚Â Â  â”œâ”€â”€ signcerts
</span><span class='line'>â”‚Â Â  â”‚Â Â      â”‚Â Â      â”‚Â Â  â”‚Â Â  â””â”€â”€ orderer2.mbasechain.com-cert.pem
</span><span class='line'>â”‚Â Â  â”‚Â Â      â”‚Â Â      â”‚Â Â  â””â”€â”€ tlscacerts
</span><span class='line'>â”‚Â Â  â”‚Â Â      â”‚Â Â      â”‚Â Â      â””â”€â”€ tlsca.mbasechain.com-cert.pem
</span><span class='line'>â”‚Â Â  â”‚Â Â      â”‚Â Â      â””â”€â”€ tls
</span><span class='line'>â”‚Â Â  â”‚Â Â      â”‚Â Â          â”œâ”€â”€ ca.crt
</span><span class='line'>â”‚Â Â  â”‚Â Â      â”‚Â Â          â”œâ”€â”€ server.crt
</span><span class='line'>â”‚Â Â  â”‚Â Â      â”‚Â Â          â””â”€â”€ server.key
</span><span class='line'>â”‚Â Â  â”‚Â Â      â”œâ”€â”€ tlsca
</span><span class='line'>â”‚Â Â  â”‚Â Â      â”‚Â Â  â”œâ”€â”€ 9ceda704a49805f19c0f3cde2c1d42096d8e14da697567b0a02b051656f735de_sk
</span><span class='line'>â”‚Â Â  â”‚Â Â      â”‚Â Â  â””â”€â”€ tlsca.mbasechain.com-cert.pem
</span><span class='line'>â”‚Â Â  â”‚Â Â      â””â”€â”€ users
</span><span class='line'>â”‚Â Â  â”‚Â Â          â””â”€â”€ Admin@mbasechain.com
</span><span class='line'>â”‚Â Â  â”‚Â Â              â”œâ”€â”€ msp
</span><span class='line'>â”‚Â Â  â”‚Â Â              â”‚Â Â  â”œâ”€â”€ admincerts
</span><span class='line'>â”‚Â Â  â”‚Â Â              â”‚Â Â  â”‚Â Â  â””â”€â”€ Admin@mbasechain.com-cert.pem
</span><span class='line'>â”‚Â Â  â”‚Â Â              â”‚Â Â  â”œâ”€â”€ cacerts
</span><span class='line'>â”‚Â Â  â”‚Â Â              â”‚Â Â  â”‚Â Â  â””â”€â”€ ca.mbasechain.com-cert.pem
</span><span class='line'>â”‚Â Â  â”‚Â Â              â”‚Â Â  â”œâ”€â”€ keystore
</span><span class='line'>â”‚Â Â  â”‚Â Â              â”‚Â Â  â”‚Â Â  â””â”€â”€ 1c7c1a76c08e30990192ed0f6eb24c2efd7492b684f92ebf844591fb38d8b020_sk
</span><span class='line'>â”‚Â Â  â”‚Â Â              â”‚Â Â  â”œâ”€â”€ signcerts
</span><span class='line'>â”‚Â Â  â”‚Â Â              â”‚Â Â  â”‚Â Â  â””â”€â”€ Admin@mbasechain.com-cert.pem
</span><span class='line'>â”‚Â Â  â”‚Â Â              â”‚Â Â  â””â”€â”€ tlscacerts
</span><span class='line'>â”‚Â Â  â”‚Â Â              â”‚Â Â      â””â”€â”€ tlsca.mbasechain.com-cert.pem
</span><span class='line'>â”‚Â Â  â”‚Â Â              â””â”€â”€ tls
</span><span class='line'>â”‚Â Â  â”‚Â Â                  â”œâ”€â”€ ca.crt
</span><span class='line'>â”‚Â Â  â”‚Â Â                  â”œâ”€â”€ client.crt
</span><span class='line'>â”‚Â Â  â”‚Â Â                  â””â”€â”€ client.key
</span><span class='line'>â”‚Â Â  â””â”€â”€ peerOrganizations
</span><span class='line'>â”‚Â Â      â”œâ”€â”€ org1.mbasechain.com
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”œâ”€â”€ ca
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 6cb226be4aec981541e6cbdd66742139c1157e88afe06edfb16f12ecc3056bf5_sk
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”‚Â Â  â””â”€â”€ ca.org1.mbasechain.com-cert.pem
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”œâ”€â”€ msp
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”‚Â Â  â”œâ”€â”€ admincerts
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ Admin@org1.mbasechain.com-cert.pem
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”‚Â Â  â”œâ”€â”€ cacerts
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ ca.org1.mbasechain.com-cert.pem
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”‚Â Â  â”œâ”€â”€ config.yaml
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”‚Â Â  â””â”€â”€ tlscacerts
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”‚Â Â      â””â”€â”€ tlsca.org1.mbasechain.com-cert.pem
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”œâ”€â”€ peers
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”‚Â Â  â”œâ”€â”€ peer0.org1.mbasechain.com
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ msp
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ admincerts
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ Admin@org1.mbasechain.com-cert.pem
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ cacerts
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ ca.org1.mbasechain.com-cert.pem
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ config.yaml
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ keystore
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ b9d2875104a103f635c8ec21757710455eec0fbfb2c59f7b33a09461b4138267_sk
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ signcerts
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ peer0.org1.mbasechain.com-cert.pem
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ tlscacerts
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â      â””â”€â”€ tlsca.org1.mbasechain.com-cert.pem
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ tls
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”‚Â Â  â”‚Â Â      â”œâ”€â”€ ca.crt
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”‚Â Â  â”‚Â Â      â”œâ”€â”€ server.crt
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”‚Â Â  â”‚Â Â      â””â”€â”€ server.key
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”‚Â Â  â””â”€â”€ peer1.org1.mbasechain.com
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”‚Â Â      â”œâ”€â”€ msp
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”‚Â Â      â”‚Â Â  â”œâ”€â”€ admincerts
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”‚Â Â      â”‚Â Â  â”‚Â Â  â””â”€â”€ Admin@org1.mbasechain.com-cert.pem
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”‚Â Â      â”‚Â Â  â”œâ”€â”€ cacerts
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”‚Â Â      â”‚Â Â  â”‚Â Â  â””â”€â”€ ca.org1.mbasechain.com-cert.pem
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”‚Â Â      â”‚Â Â  â”œâ”€â”€ config.yaml
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”‚Â Â      â”‚Â Â  â”œâ”€â”€ keystore
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”‚Â Â      â”‚Â Â  â”‚Â Â  â””â”€â”€ 68da53988aa0b3e50b6a90ac90495b4021fdb3456bbca375aca13cf206d18b0c_sk
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”‚Â Â      â”‚Â Â  â”œâ”€â”€ signcerts
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”‚Â Â      â”‚Â Â  â”‚Â Â  â””â”€â”€ peer1.org1.mbasechain.com-cert.pem
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”‚Â Â      â”‚Â Â  â””â”€â”€ tlscacerts
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”‚Â Â      â”‚Â Â      â””â”€â”€ tlsca.org1.mbasechain.com-cert.pem
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”‚Â Â      â””â”€â”€ tls
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”‚Â Â          â”œâ”€â”€ ca.crt
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”‚Â Â          â”œâ”€â”€ server.crt
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”‚Â Â          â””â”€â”€ server.key
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”œâ”€â”€ tlsca
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”‚Â Â  â”œâ”€â”€ b2ef19d2488129396546090955ddf2d1ec267cd699dc2218516df72f5ea235f4_sk
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”‚Â Â  â””â”€â”€ tlsca.org1.mbasechain.com-cert.pem
</span><span class='line'>â”‚Â Â      â”‚Â Â  â””â”€â”€ users
</span><span class='line'>â”‚Â Â      â”‚Â Â      â”œâ”€â”€ Admin@org1.mbasechain.com
</span><span class='line'>â”‚Â Â      â”‚Â Â      â”‚Â Â  â”œâ”€â”€ msp
</span><span class='line'>â”‚Â Â      â”‚Â Â      â”‚Â Â  â”‚Â Â  â”œâ”€â”€ admincerts
</span><span class='line'>â”‚Â Â      â”‚Â Â      â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ Admin@org1.mbasechain.com-cert.pem
</span><span class='line'>â”‚Â Â      â”‚Â Â      â”‚Â Â  â”‚Â Â  â”œâ”€â”€ cacerts
</span><span class='line'>â”‚Â Â      â”‚Â Â      â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ ca.org1.mbasechain.com-cert.pem
</span><span class='line'>â”‚Â Â      â”‚Â Â      â”‚Â Â  â”‚Â Â  â”œâ”€â”€ keystore
</span><span class='line'>â”‚Â Â      â”‚Â Â      â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ 12f72b7332170a7b8e4214eb268c419053a2386f34b149f3e7c5820f767a2d30_sk
</span><span class='line'>â”‚Â Â      â”‚Â Â      â”‚Â Â  â”‚Â Â  â”œâ”€â”€ signcerts
</span><span class='line'>â”‚Â Â      â”‚Â Â      â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ Admin@org1.mbasechain.com-cert.pem
</span><span class='line'>â”‚Â Â      â”‚Â Â      â”‚Â Â  â”‚Â Â  â””â”€â”€ tlscacerts
</span><span class='line'>â”‚Â Â      â”‚Â Â      â”‚Â Â  â”‚Â Â      â””â”€â”€ tlsca.org1.mbasechain.com-cert.pem
</span><span class='line'>â”‚Â Â      â”‚Â Â      â”‚Â Â  â””â”€â”€ tls
</span><span class='line'>â”‚Â Â      â”‚Â Â      â”‚Â Â      â”œâ”€â”€ ca.crt
</span><span class='line'>â”‚Â Â      â”‚Â Â      â”‚Â Â      â”œâ”€â”€ client.crt
</span><span class='line'>â”‚Â Â      â”‚Â Â      â”‚Â Â      â””â”€â”€ client.key
</span><span class='line'>â”‚Â Â      â”‚Â Â      â””â”€â”€ User1@org1.mbasechain.com
</span><span class='line'>â”‚Â Â      â”‚Â Â          â”œâ”€â”€ msp
</span><span class='line'>â”‚Â Â      â”‚Â Â          â”‚Â Â  â”œâ”€â”€ admincerts
</span><span class='line'>â”‚Â Â      â”‚Â Â          â”‚Â Â  â”‚Â Â  â””â”€â”€ User1@org1.mbasechain.com-cert.pem
</span><span class='line'>â”‚Â Â      â”‚Â Â          â”‚Â Â  â”œâ”€â”€ cacerts
</span><span class='line'>â”‚Â Â      â”‚Â Â          â”‚Â Â  â”‚Â Â  â””â”€â”€ ca.org1.mbasechain.com-cert.pem
</span><span class='line'>â”‚Â Â      â”‚Â Â          â”‚Â Â  â”œâ”€â”€ keystore
</span><span class='line'>â”‚Â Â      â”‚Â Â          â”‚Â Â  â”‚Â Â  â””â”€â”€ 610899489aa3d881dcc6e9f3d421981003b1504e5b15c00426edd69505ef3519_sk
</span><span class='line'>â”‚Â Â      â”‚Â Â          â”‚Â Â  â”œâ”€â”€ signcerts
</span><span class='line'>â”‚Â Â      â”‚Â Â          â”‚Â Â  â”‚Â Â  â””â”€â”€ User1@org1.mbasechain.com-cert.pem
</span><span class='line'>â”‚Â Â      â”‚Â Â          â”‚Â Â  â””â”€â”€ tlscacerts
</span><span class='line'>â”‚Â Â      â”‚Â Â          â”‚Â Â      â””â”€â”€ tlsca.org1.mbasechain.com-cert.pem
</span><span class='line'>â”‚Â Â      â”‚Â Â          â””â”€â”€ tls
</span><span class='line'>â”‚Â Â      â”‚Â Â              â”œâ”€â”€ ca.crt
</span><span class='line'>â”‚Â Â      â”‚Â Â              â”œâ”€â”€ client.crt
</span><span class='line'>â”‚Â Â      â”‚Â Â              â””â”€â”€ client.key
</span><span class='line'>â”‚Â Â      â”œâ”€â”€ org2.mbasechain.com
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”œâ”€â”€ ca
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 018041cad6bac4a43ab80e736ba333a759a14ee6e88226944ec904dfcba633ab_sk
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”‚Â Â  â””â”€â”€ ca.org2.mbasechain.com-cert.pem
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”œâ”€â”€ msp
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”‚Â Â  â”œâ”€â”€ admincerts
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ Admin@org2.mbasechain.com-cert.pem
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”‚Â Â  â”œâ”€â”€ cacerts
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ ca.org2.mbasechain.com-cert.pem
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”‚Â Â  â”œâ”€â”€ config.yaml
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”‚Â Â  â””â”€â”€ tlscacerts
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”‚Â Â      â””â”€â”€ tlsca.org2.mbasechain.com-cert.pem
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”œâ”€â”€ peers
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”‚Â Â  â”œâ”€â”€ peer0.org2.mbasechain.com
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ msp
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ admincerts
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ Admin@org2.mbasechain.com-cert.pem
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ cacerts
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ ca.org2.mbasechain.com-cert.pem
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ config.yaml
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ keystore
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ cfb79d8ab3c543a8732227cd2b441ce30e82ff1d4aad5f59c1338454edeeddf1_sk
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ signcerts
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ peer0.org2.mbasechain.com-cert.pem
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ tlscacerts
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â      â””â”€â”€ tlsca.org2.mbasechain.com-cert.pem
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ tls
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”‚Â Â  â”‚Â Â      â”œâ”€â”€ ca.crt
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”‚Â Â  â”‚Â Â      â”œâ”€â”€ server.crt
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”‚Â Â  â”‚Â Â      â””â”€â”€ server.key
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”‚Â Â  â””â”€â”€ peer1.org2.mbasechain.com
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”‚Â Â      â”œâ”€â”€ msp
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”‚Â Â      â”‚Â Â  â”œâ”€â”€ admincerts
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”‚Â Â      â”‚Â Â  â”‚Â Â  â””â”€â”€ Admin@org2.mbasechain.com-cert.pem
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”‚Â Â      â”‚Â Â  â”œâ”€â”€ cacerts
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”‚Â Â      â”‚Â Â  â”‚Â Â  â””â”€â”€ ca.org2.mbasechain.com-cert.pem
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”‚Â Â      â”‚Â Â  â”œâ”€â”€ config.yaml
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”‚Â Â      â”‚Â Â  â”œâ”€â”€ keystore
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”‚Â Â      â”‚Â Â  â”‚Â Â  â””â”€â”€ b92cbb64895e522299770c9f84ad9954753f348d926da956d4458cf545b99ef6_sk
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”‚Â Â      â”‚Â Â  â”œâ”€â”€ signcerts
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”‚Â Â      â”‚Â Â  â”‚Â Â  â””â”€â”€ peer1.org2.mbasechain.com-cert.pem
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”‚Â Â      â”‚Â Â  â””â”€â”€ tlscacerts
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”‚Â Â      â”‚Â Â      â””â”€â”€ tlsca.org2.mbasechain.com-cert.pem
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”‚Â Â      â””â”€â”€ tls
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”‚Â Â          â”œâ”€â”€ ca.crt
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”‚Â Â          â”œâ”€â”€ server.crt
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”‚Â Â          â””â”€â”€ server.key
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”œâ”€â”€ tlsca
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 2674e511ae5eb66b4964a2a93cc917f5e8fbd49e95fc97d12b546c9ce933e932_sk
</span><span class='line'>â”‚Â Â      â”‚Â Â  â”‚Â Â  â””â”€â”€ tlsca.org2.mbasechain.com-cert.pem
</span><span class='line'>â”‚Â Â      â”‚Â Â  â””â”€â”€ users
</span><span class='line'>â”‚Â Â      â”‚Â Â      â”œâ”€â”€ Admin@org2.mbasechain.com
</span><span class='line'>â”‚Â Â      â”‚Â Â      â”‚Â Â  â”œâ”€â”€ msp
</span><span class='line'>â”‚Â Â      â”‚Â Â      â”‚Â Â  â”‚Â Â  â”œâ”€â”€ admincerts
</span><span class='line'>â”‚Â Â      â”‚Â Â      â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ Admin@org2.mbasechain.com-cert.pem
</span><span class='line'>â”‚Â Â      â”‚Â Â      â”‚Â Â  â”‚Â Â  â”œâ”€â”€ cacerts
</span><span class='line'>â”‚Â Â      â”‚Â Â      â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ ca.org2.mbasechain.com-cert.pem
</span><span class='line'>â”‚Â Â      â”‚Â Â      â”‚Â Â  â”‚Â Â  â”œâ”€â”€ keystore
</span><span class='line'>â”‚Â Â      â”‚Â Â      â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ 4ca087cf7e8ecd260b84782ec8456b693ada673b902d525fb0dfcbf4bc797e38_sk
</span><span class='line'>â”‚Â Â      â”‚Â Â      â”‚Â Â  â”‚Â Â  â”œâ”€â”€ signcerts
</span><span class='line'>â”‚Â Â      â”‚Â Â      â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ Admin@org2.mbasechain.com-cert.pem
</span><span class='line'>â”‚Â Â      â”‚Â Â      â”‚Â Â  â”‚Â Â  â””â”€â”€ tlscacerts
</span><span class='line'>â”‚Â Â      â”‚Â Â      â”‚Â Â  â”‚Â Â      â””â”€â”€ tlsca.org2.mbasechain.com-cert.pem
</span><span class='line'>â”‚Â Â      â”‚Â Â      â”‚Â Â  â””â”€â”€ tls
</span><span class='line'>â”‚Â Â      â”‚Â Â      â”‚Â Â      â”œâ”€â”€ ca.crt
</span><span class='line'>â”‚Â Â      â”‚Â Â      â”‚Â Â      â”œâ”€â”€ client.crt
</span><span class='line'>â”‚Â Â      â”‚Â Â      â”‚Â Â      â””â”€â”€ client.key
</span><span class='line'>â”‚Â Â      â”‚Â Â      â””â”€â”€ User1@org2.mbasechain.com
</span><span class='line'>â”‚Â Â      â”‚Â Â          â”œâ”€â”€ msp
</span><span class='line'>â”‚Â Â      â”‚Â Â          â”‚Â Â  â”œâ”€â”€ admincerts
</span><span class='line'>â”‚Â Â      â”‚Â Â          â”‚Â Â  â”‚Â Â  â””â”€â”€ User1@org2.mbasechain.com-cert.pem
</span><span class='line'>â”‚Â Â      â”‚Â Â          â”‚Â Â  â”œâ”€â”€ cacerts
</span><span class='line'>â”‚Â Â      â”‚Â Â          â”‚Â Â  â”‚Â Â  â””â”€â”€ ca.org2.mbasechain.com-cert.pem
</span><span class='line'>â”‚Â Â      â”‚Â Â          â”‚Â Â  â”œâ”€â”€ keystore
</span><span class='line'>â”‚Â Â      â”‚Â Â          â”‚Â Â  â”‚Â Â  â””â”€â”€ 950ff48168df356652a4fa6d5f9d3aa7d6d7694045cc3bb7f83587686794a345_sk
</span><span class='line'>â”‚Â Â      â”‚Â Â          â”‚Â Â  â”œâ”€â”€ signcerts
</span><span class='line'>â”‚Â Â      â”‚Â Â          â”‚Â Â  â”‚Â Â  â””â”€â”€ User1@org2.mbasechain.com-cert.pem
</span><span class='line'>â”‚Â Â      â”‚Â Â          â”‚Â Â  â””â”€â”€ tlscacerts
</span><span class='line'>â”‚Â Â      â”‚Â Â          â”‚Â Â      â””â”€â”€ tlsca.org2.mbasechain.com-cert.pem
</span><span class='line'>â”‚Â Â      â”‚Â Â          â””â”€â”€ tls
</span><span class='line'>â”‚Â Â      â”‚Â Â              â”œâ”€â”€ ca.crt
</span><span class='line'>â”‚Â Â      â”‚Â Â              â”œâ”€â”€ client.crt
</span><span class='line'>â”‚Â Â      â”‚Â Â              â””â”€â”€ client.key
</span><span class='line'>â”œâ”€â”€ crypto-config.yaml
</span><span class='line'>â”œâ”€â”€ genesis.block
</span><span class='line'>â”œâ”€â”€ mychannel.tx</span></code></pre></td></tr></table></div></figure>


<h5>æœªå®Œå¾…ç»­ã€‚ã€‚ã€‚</h5>

<h5>å‚è€ƒèµ„æ–™</h5>

<p><a href="https://hyperledgercn.github.io/hyperledgerDocs/getting_started/">https://hyperledgercn.github.io/hyperledgerDocs/getting_started/</a><br/>
<a href="https://www.codetd.com/article/2709144">https://www.codetd.com/article/2709144</a><br/>
<a href="https://hyperledgercn.github.io/hyperledgerDocs/build_network_zh/">https://hyperledgercn.github.io/hyperledgerDocs/build_network_zh/</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Fabricå¤šå°æœåŠ¡å™¨çš„éƒ¨ç½²(ä¸€)]]></title>
    <link href="http://xuyao.club/blog/2018/12/14/deployment-of-fabric-multiple-servers-i/"/>
    <updated>2018-12-14T11:55:10+08:00</updated>
    <id>http://xuyao.club/blog/2018/12/14/deployment-of-fabric-multiple-servers-i</id>
    <content type="html"><![CDATA[<h3>1ã€å‰è¨€</h3>

<p>  &emsp;Hyperledger Fabricæ˜¯ä¸€ä¸ªæä¾›åˆ†å¸ƒå¼è´¦æœ¬è§£å†³æ–¹æ¡ˆçš„å¹³å°ã€‚Hyperledger Fabricç”±æ¨¡å—åŒ–æ¶æ„æ”¯æ’‘ï¼Œå¹¶å…·å¤‡æä½³çš„ä¿å¯†æ€§ã€å¯ä¼¸ç¼©æ€§ã€çµæ´»æ€§å’Œå¯æ‰©å±•æ€§ã€‚Hyperledger Fabricè¢«è®¾è®¡æˆæ”¯æŒä¸åŒçš„æ¨¡å—ç»„ä»¶ç›´æ¥æ‹”æ’å¯ç”¨ï¼Œå¹¶èƒ½é€‚åº”åœ¨ç»æµç”Ÿæ€ç³»ç»Ÿä¸­é”™ç»¼å¤æ‚çš„å„ç§åœºæ™¯ã€‚
 &emsp;ç›®å‰Fabricåœ¨åŒºå—é“¾æº¯æºåœºæ™¯åº”ç”¨çš„æŒºå¤šï¼Œå†œäº§å“ï¼Œå¥¢ä¾ˆå“ï¼Œè‰ºæœ¯å“ï¼Œçº¢é…’ç­‰æ–¹é¢éƒ½çœ‹è¿‡åˆ°æ¡ˆä¾‹ï¼ŒåŒºå—é“¾å¯ä»¥ä¿å­˜äº§å“å„ä¸ªç¯èŠ‚çš„æ•°æ®ï¼Œå¹¶ä¸Šé“¾ï¼Œç”¨æˆ·æœ€åå¯èƒ½åªéœ€æ‰«æä¸€ä¸ªäºŒç»´ç ï¼Œå°±å¯ä»¥æŸ¥å‡ºæŸä¸ªäº§å“æ•´ä¸ªçš„ç”Ÿäº§è¿‡ç¨‹ï¼Œä¸ä¸­å¿ƒåŒ–æ•°æ®ä¸åŒçš„æ˜¯ï¼ŒåŒºå—é“¾æº¯æºé¡¹ç›®æ•°æ®ä¸€æ—¦ä¸Šé“¾åä¸å¯æ›´æ”¹ï¼Œè€Œä¸”æ•°æ®å…¬å¼€é€æ˜ï¼Œä»»ä½•ä¸€æ–¹éƒ½æ²¡æœ‰æƒåˆ©æ¥æ›´æ”¹å®ƒï¼ŒåŒæ—¶æ¯ä¸ªç¯èŠ‚éœ€è¦ä¸ºä½ ä¸Šé“¾çš„æ•°æ®è´Ÿè´£ï¼Œå¦‚æœå“ªå¤©æ¶ˆè´¹æŸ¥å‡ºæŸä¸ªç¯èŠ‚çš„æ•°æ®æ˜¯å‡çš„ï¼Œç”±äºè´¦æœ¬æ•°æ®æ˜¯åˆ†å¸ƒå¼çš„ã€ä¸å¯æ›´æ”¹çš„ï¼Œå¤§å®¶åªç›¸ä¿¡æ•°æ®ï¼Œå•†å®¶ä¹Ÿæ— æ³•æŠµèµ–ï¼Œæœ€åå•†å®¶åªèƒ½è®¤é”™ï¼Œåèª‰æ‰«åœ°ï¼Œæ‰€ä»¥åŒºå—é“¾æœ¬è´¨ä¸Šæ˜¯è§£å†³ä¸€ä¸ªå¤šæ–¹åä½œçš„ä¸€ä¸ªä¿¡ä»»é—®é¢˜ï¼Œè€Œå¯¹äºä¸€ä»¶äº‹æƒ…éœ€è¦å¤šæ–¹åä½œï¼Œå…±åŒè®°è´¦æ¥ä¸€èµ·å®Œæˆçš„ï¼ŒFabricä½œä¸ºè”ç›Ÿé“¾ï¼Œæ˜¾ç„¶å¾ˆç¬¦åˆè¿™ç§éœ€æ±‚ã€‚</p>

<!-- more -->


<p></p>

<h3>2ã€ç¯å¢ƒå®‰è£…åŠæœåŠ¡å™¨é…ç½®</h3>

<h5>2.1 ç¯å¢ƒå®‰è£…</h5>

<p>åœ¨é…ç½®Fabricç½‘ç»œä¹‹å‰ï¼Œéœ€è¦å®‰è£…ä¸€ä¸‹ç›¸å…³ç¯å¢ƒï¼ŒåŒ…æ‹¬GOè¯­è¨€å®‰è£…å’ŒDockerçš„å®‰è£…</p>

<h6>2.1.1 GOè¯­è¨€å®‰è£…</h6>

<p>1ã€ä»å®˜ç½‘ä¸‹è½½å®ƒçš„å®‰è£…åŒ…ï¼Œåœ°å€ï¼š<a href="https://golang.org/dl/">https://golang.org/dl/</a>ï¼Œæ ¹æ®è‡ªå·±ç”µè„‘æˆ–æœåŠ¡å™¨ä¸åŒç³»ç»Ÿä¸‹è½½å¯¹åº”çš„å®‰è£…åŒ…ã€‚
2ã€ä¸‹è½½åè§£å‹åŒ…</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>tar -C /usr/local -xzf go$VERSION.$OS-$ARCH.tar.gz</span></code></pre></td></tr></table></div></figure>


<p>3ã€é…ç½®GOçš„ç¯å¢ƒå˜é‡</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>export PATH=$PATH:/usr/local/go/bin
</span><span class='line'>export GOPATH=/opt/gopath</span></code></pre></td></tr></table></div></figure>


<p>æœ€åæ‰§è¡Œsourceå‘½ä»¤ï¼Œä½¿å…¶ç”Ÿæ•ˆ</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>source profile</span></code></pre></td></tr></table></div></figure>


<p>æœ€åæ‰“å°ä¸€ä¸‹GOç‰ˆæœ¬</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>go version
</span><span class='line'>go version go1.10.1 darwin/amd64</span></code></pre></td></tr></table></div></figure>


<p><strong>ubuntuç³»ç»Ÿä¸‹å®‰è£…</strong></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>sudo add-apt-repository ppa:longsleep/golang-backports
</span><span class='line'>sudo apt-get update
</span><span class='line'>sudo apt-get install golang-go</span></code></pre></td></tr></table></div></figure>


<p>è®¾ç½®ç¯å¢ƒå˜é‡</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>export GOPATH=$HOME/go
</span><span class='line'>export PATH=$PATH:$GOROOT/bin:$GOPATH/bin</span></code></pre></td></tr></table></div></figure>


<p>ä¸åŒç³»ç»Ÿå®‰è£…ç•¥æœ‰ä¸åŒï¼Œå…·ä½“å»ºè®®æŸ¥çœ‹å®˜æ–¹æ–‡æ¡£ <a href="https://golang.org/doc/install">https://golang.org/doc/install</a></p>

<h5>2.1.2 Dockerã€Docker-Composeçš„å®‰è£…</h5>

<p>dockerå®‰è£…ä¸åŒç³»ç»Ÿä¹Ÿæ˜¯æœ‰åŒºåˆ«çš„ï¼Œæˆ‘æ˜¯macç”µè„‘ï¼Œå®‰è£…ä¹Ÿç›¸å¯¹ç®€å•ï¼Œåˆ°docker<a href="https://www.docker.com/products/docker-desktop">å®˜ç½‘</a>ä¸‹è½½ä¸€ä¸ªåŒ…ï¼Œç›´æ¥å®‰è£…å°±è¡Œï¼Œè£…å¥½åå¯ä»¥æŸ¥ä¸€ä¸‹dockerçš„ç‰ˆæœ¬ï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œmacç”µè„‘åªå®‰è£…dockerå°±è¡Œï¼Œdockerç‰ˆæœ¬å·²ç»åŒ…æ‹¬äº†composeå’Œå…¶å®ƒdockeråº”ç”¨ï¼Œæ‰€ä»¥æ— éœ€å†å¦è¡Œå®‰è£…compose</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>docker version
</span><span class='line'>#dockerçš„ç‰ˆæœ¬ä¿¡æ¯
</span><span class='line'>Client:
</span><span class='line'> Version:           18.06.1-ce
</span><span class='line'> API version:       1.38
</span><span class='line'> Go version:        go1.10.3
</span><span class='line'> Git commit:        e68fc7a
</span><span class='line'> Built:             Tue Aug 21 17:21:31 2018
</span><span class='line'> OS/Arch:           darwin/amd64
</span><span class='line'> Experimental:      false
</span><span class='line'>
</span><span class='line'>Server:
</span><span class='line'> Engine:
</span><span class='line'>  Version:          18.06.1-ce
</span><span class='line'>  API version:      1.38 (minimum version 1.12)
</span><span class='line'>  Go version:       go1.10.3
</span><span class='line'>  Git commit:       e68fc7a
</span><span class='line'>  Built:            Tue Aug 21 17:29:02 2018
</span><span class='line'>  OS/Arch:          linux/amd64
</span><span class='line'>  Experimental:     true</span></code></pre></td></tr></table></div></figure>


<p>å¦‚æœæ˜¯Linuxç³»ç»Ÿï¼Œéœ€è¦å®‰è£…dockerå’Œdocker-composeï¼Œå¯ä»¥å‚è€ƒè¿™é‡Œ<a href="https://yeasy.gitbooks.io/docker_practice/install/">https://yeasy.gitbooks.io/docker_practice/install/</a>,é’ˆå¯¹ä¸åŒçš„linuxç³»ç»Ÿï¼Œéƒ½æœ‰å®‰è£…æ–¹æ³•ï¼Œå†™çš„æ¯”è¾ƒè¯¦ç»†ï¼Œä¹Ÿå¯ä»¥å‚è€ƒå®˜ç½‘ä¿¡æ¯<a href="https://docs.docker.com/compose/install/">https://docs.docker.com/compose/install/</a></p>

<p><strong>ubuntuç³»ç»Ÿå®‰è£…dockerã€docker-compose</strong></p>

<p>å¸è½½æ—§ç‰ˆæœ¬çš„docker</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ sudo apt-get remove docker \
</span><span class='line'>               docker-engine \
</span><span class='line'>               docker.io</span></code></pre></td></tr></table></div></figure>


<p>é‰´äºå›½å†…ç½‘ç»œé—®é¢˜ï¼Œå¼ºçƒˆå»ºè®®ä½¿ç”¨å›½å†…æºï¼Œå®˜æ–¹æºè¯·åœ¨æ³¨é‡Šä¸­æŸ¥çœ‹ã€‚
ä¸ºäº†ç¡®è®¤æ‰€ä¸‹è½½è½¯ä»¶åŒ…çš„åˆæ³•æ€§ï¼Œéœ€è¦æ·»åŠ è½¯ä»¶æºçš„ GPG å¯†é’¥ã€‚</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ curl -fsSL https://mirrors.ustc.edu.cn/docker-ce/linux/ubuntu/gpg | sudo apt-key add -
</span><span class='line'>$ sudo add-apt-repository \
</span><span class='line'>    "deb [arch=amd64] https://mirrors.ustc.edu.cn/docker-ce/linux/ubuntu \
</span><span class='line'>    $(lsb_release -cs) \
</span><span class='line'>    stable"</span></code></pre></td></tr></table></div></figure>


<p>å®‰è£…docker-ce</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ sudo apt-get update
</span><span class='line'>
</span><span class='line'>$ sudo apt-get install docker-ce</span></code></pre></td></tr></table></div></figure>


<p>å®‰è£…docker-composeï¼Œåœ¨ Linux ä¸Šçš„ä¹Ÿå®‰è£…ååˆ†ç®€å•ï¼Œä»Â <a href="https://github.com/docker/compose/releases">å®˜æ–¹ GitHub Release</a>Â å¤„ç›´æ¥ä¸‹è½½ç¼–è¯‘å¥½çš„äºŒè¿›åˆ¶æ–‡ä»¶å³å¯ã€‚
ä¾‹å¦‚ï¼Œåœ¨ Linux 64 ä½ç³»ç»Ÿä¸Šç›´æ¥ä¸‹è½½å¯¹åº”çš„äºŒè¿›åˆ¶åŒ…ã€‚</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>curl -L https://github.com/docker/compose/releases/download/1.23.2/docker-compose-`uname -s`-`uname -m` -o /usr/local/bin/docker-compose
</span><span class='line'>chmod +x /usr/local/bin/docker-compose</span></code></pre></td></tr></table></div></figure>


<h5>2.1.3 nodejså®‰è£…</h5>

<p> &emsp;å› ä¸ºæˆ‘ä»¬é¡¹ç›®ç”¨çš„æ˜¯nodejs SDKï¼Œæ‰€ä»¥å®é™…é¡¹ç›®ä¸­è¿˜éœ€è¦å®‰è£…nodejså’Œnpmæ¥è·‘é¡¹ç›®ï¼Œå› ä¸ºFabricç›®å‰åªæ”¯æŒnodejs v8.4.0~v9.0.0çš„ç‰ˆæœ¬ï¼ˆ2018-10ï¼‰ï¼Œæ‰€ä»¥å»ºè®®å®‰è£…çš„æ—¶å€™æŒ‡å®šä¸€ä¸ªå›ºå®šçš„ç‰ˆæœ¬ï¼Œæ¯”å¦‚v8.9.0ï¼Œæˆ‘ç”¨çš„æ˜¯è¿™ä¸ªç‰ˆæœ¬ï¼Œè¿˜æ˜¯å¾ˆç¨³å®šçš„ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥å…ˆä¸‹è½½ä¸€ä¸ªnvmæ¥ç®¡ç†nodejsçš„ç‰ˆæœ¬ï¼Œä¸åŒé¡¹ç›®éœ€è¦ä¸åŒçš„nodeç‰ˆæœ¬ï¼Œä½¿ç”¨nvmå¯ä»¥ç®¡ç†ä¸åŒçš„nodeç‰ˆæœ¬ã€‚
1ã€å®‰è£…nvmï¼Œæ‰§è¡Œä¸‹é¢å‘½ä»¤ä¸‹è½½å®‰è£…è„šæœ¬</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>curl -o- https://raw.githubusercontent.com/creationix/nvm/v0.33.11/install.sh | bash
</span><span class='line'>#è¾“å‡º
</span><span class='line'>
</span><span class='line'>=&gt; Close and reopen your terminal to start using nvm or run the following to use it now:
</span><span class='line'>export NVM_DIR="$HOME/.nvm"
</span><span class='line'>[ -s "$NVM_DIR/nvm.sh" ] && \. "$NVM_DIR/nvm.sh"  # This loads nvm
</span><span class='line'>[ -s "$NVM_DIR/bash_completion" ] && \. "$NVM_DIR/bash_completion"  # This loads nvm bash_completion</span></code></pre></td></tr></table></div></figure>


<p>æ£€æŸ¥ä¸‹æ˜¯å¦å®‰è£…æˆåŠŸ</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>nvm --version
</span><span class='line'>0.33.11</span></code></pre></td></tr></table></div></figure>


<p>2ã€å®‰è£…nodejsï¼Œä½¿ç”¨nvm ls-remoteæŸ¥çœ‹è¿œç¨‹å¯å®‰è£…çš„nodeç‰ˆæœ¬</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>nvm ls-remote 
</span><span class='line'>v8.0.0
</span><span class='line'>v8.1.0
</span><span class='line'>v8.1.1
</span><span class='line'>v8.1.2
</span><span class='line'>v8.1.3
</span><span class='line'>v8.1.4
</span><span class='line'>v8.2.0
</span><span class='line'>v8.2.1
</span><span class='line'>v8.3.0
</span><span class='line'>v8.4.0
</span><span class='line'>v8.5.0
</span><span class='line'>v8.6.0
</span><span class='line'>v8.7.0
</span><span class='line'>v8.8.0
</span><span class='line'>v8.8.1
</span><span class='line'>v8.9.0</span></code></pre></td></tr></table></div></figure>


<p>æ‰¾åˆ°è‡ªå·±æƒ³è¦å®‰è£…çš„ç‰ˆæœ¬æ¥å®‰è£…nodejs</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>nvm install 8.9.0</span></code></pre></td></tr></table></div></figure>


<p>ä½¿ç”¨nodeå‘½ä»¤æŸ¥çœ‹æ˜¯å¦å®‰è£…æˆåŠŸ</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>node -v
</span><span class='line'>v8.9.1</span></code></pre></td></tr></table></div></figure>


<p>ä¹Ÿå¯ä»¥ä½¿ç”¨nvm lsæ¥æŸ¥çœ‹å½“å‰ç¯å¢ƒæœ‰å‡ ä¸ªnodeç‰ˆæœ¬</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>nvm ls
</span><span class='line'>
</span><span class='line'>-&gt;       v8.9.1
</span><span class='line'>         system
</span><span class='line'>default -&gt; 8.9.1 (-&gt; v8.9.1)
</span><span class='line'>node -&gt; stable (-&gt; v8.9.1) (default)
</span><span class='line'>stable -&gt; 8.9 (-&gt; v8.9.1) (default)
</span><span class='line'>iojs -&gt; N/A (default)
</span><span class='line'>lts/* -&gt; lts/dubnium (-&gt; N/A)
</span><span class='line'>lts/argon -&gt; v4.9.1 (-&gt; N/A)
</span><span class='line'>lts/boron -&gt; v6.15.0 (-&gt; N/A)
</span><span class='line'>lts/carbon -&gt; v8.14.0 (-&gt; N/A)
</span><span class='line'>lts/dubnium -&gt; v10.14.1 (-&gt; N/A)</span></code></pre></td></tr></table></div></figure>


<p>å¯ä»¥çœ‹åˆ°ç›®å‰åªå®‰è£…äº†8.9.0ï¼Œè€Œä¸”ç³»ç»Ÿé»˜è®¤ä½¿ç”¨çš„å°±æ˜¯8.9.0ï¼Œå¦‚æœæƒ³æ”¹å˜ç³»ç»Ÿçš„é»˜è®¤ç‰ˆæœ¬ï¼Œå¯ä»¥ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>nvm use 8.9.0
</span><span class='line'>Now using node v10.13.0 (npm v6.4.1)</span></code></pre></td></tr></table></div></figure>


<h5>2.1.4 Gitå·¥å…·å®‰è£…</h5>

<p>Gitå®‰è£…å°±ç®€å•äº†å§ï¼Œåšè¿‡å¼€å‘çš„äººåº”è¯¥éƒ½å®‰è£…è¿‡ï¼Œè¿™é‡Œè´´ä¸ªå®‰è£…æ•™ç¨‹ï¼Œ
<a href="https://git-scm.com/book/en/v2/Getting-Started-Installing-Git">https://git-scm.com/book/en/v2/Getting-Started-Installing-Git</a>,è·Ÿç€ä¸Šé¢å®‰è£…å°±è¡Œã€‚</p>

<h5>2.2 æœåŠ¡å™¨é…ç½®è¯´æ˜</h5>

<p> &emsp;è¯´æ˜ä¸€ä¸‹æœåŠ¡å™¨çš„æ•´ä¸ªæƒ…å†µï¼Œæˆ‘ç”³è¯·äº†4å°æœåŠ¡å™¨ï¼Œ åš4ä¸ªpeerï¼Œä¸¤ä¸ªordererï¼Œå…·ä½“çš„crypto-config.yamlé…ç½®å¦‚ä¸‹ï¼š</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>
</span><span class='line'>OrdererOrgs:
</span><span class='line'>  # ---------------------------------------------------------------------------
</span><span class='line'>  # Orderer
</span><span class='line'>  # ---------------------------------------------------------------------------
</span><span class='line'>  - Name: Orderer
</span><span class='line'>    Domain: xuyao.com
</span><span class='line'>    # ---------------------------------------------------------------------------
</span><span class='line'>    # "Specs" - See PeerOrgs below for complete description
</span><span class='line'>    # ---------------------------------------------------------------------------
</span><span class='line'>    Specs:
</span><span class='line'>      - Hostname: orderer1
</span><span class='line'>      - Hostname: orderer2
</span><span class='line'># ---------------------------------------------------------------------------
</span><span class='line'># "PeerOrgs" - Definition of organizations managing peer nodes
</span><span class='line'># ---------------------------------------------------------------------------
</span><span class='line'>PeerOrgs:
</span><span class='line'>  # ---------------------------------------------------------------------------
</span><span class='line'>  # Org1
</span><span class='line'>  # ---------------------------------------------------------------------------
</span><span class='line'>  - Name: Org1
</span><span class='line'>    Domain: org1.xuyao.com
</span><span class='line'>    EnableNodeOUs: true
</span><span class='line'>    # ---------------------------------------------------------------------------
</span><span class='line'>    # "Specs"
</span><span class='line'>    # ---------------------------------------------------------------------------
</span><span class='line'>    # Uncomment this section to enable the explicit definition of hosts in your
</span><span class='line'>    # configuration.  Most users will want to use Template, below
</span><span class='line'>    #
</span><span class='line'>    # Specs is an array of Spec entries.  Each Spec entry consists of two fields:
</span><span class='line'>    #   - Hostname:   (Required) The desired hostname, sans the domain.
</span><span class='line'>    #   - CommonName: (Optional) Specifies the template or explicit override for
</span><span class='line'>    #                 the CN.  By default, this is the template:
</span><span class='line'>    #
</span><span class='line'>    #                              "."
</span><span class='line'>    #
</span><span class='line'>    #                 which obtains its values from the Spec.Hostname and
</span><span class='line'>    #                 Org.Domain, respectively.
</span><span class='line'>    # ---------------------------------------------------------------------------
</span><span class='line'>    # Specs:
</span><span class='line'>    #   - Hostname: foo # implicitly "foo.org1.example.com"
</span><span class='line'>    #     CommonName: foo27.org5.example.com # overrides Hostname-based FQDN set above
</span><span class='line'>    #   - Hostname: bar
</span><span class='line'>    #   - Hostname: baz
</span><span class='line'>    # ---------------------------------------------------------------------------
</span><span class='line'>    # "Template"
</span><span class='line'>    # ---------------------------------------------------------------------------
</span><span class='line'>    # Allows for the definition of 1 or more hosts that are created sequentially
</span><span class='line'>    # from a template. By default, this looks like "peer%d" from 0 to Count-1.
</span><span class='line'>    # You may override the number of nodes (Count), the starting index (Start)
</span><span class='line'>    # or the template used to construct the name (Hostname).
</span><span class='line'>    #
</span><span class='line'>    # Note: Template and Specs are not mutually exclusive.  You may define both
</span><span class='line'>    # sections and the aggregate nodes will be created for you.  Take care with
</span><span class='line'>    # name collisions
</span><span class='line'>    # ---------------------------------------------------------------------------
</span><span class='line'>    Template:
</span><span class='line'>      Count: 2
</span><span class='line'>      # Start: 5
</span><span class='line'>      # Hostname:  # default
</span><span class='line'>    # ---------------------------------------------------------------------------
</span><span class='line'>    # "Users"
</span><span class='line'>    # ---------------------------------------------------------------------------
</span><span class='line'>    # Count: The number of user accounts _in addition_ to Admin
</span><span class='line'>    # ---------------------------------------------------------------------------
</span><span class='line'>    Users:
</span><span class='line'>      Count: 1
</span><span class='line'>  # ---------------------------------------------------------------------------
</span><span class='line'>  # Org2: See "Org1" for full specification
</span><span class='line'>  # ---------------------------------------------------------------------------
</span><span class='line'>  - Name: Org2
</span><span class='line'>    Domain: org2.xuyao.com
</span><span class='line'>    EnableNodeOUs: true
</span><span class='line'>    Template:
</span><span class='line'>      Count: 2
</span><span class='line'>    Users:
</span><span class='line'>      Count: 1
</span><span class='line'>
</span><span class='line'>  # ---------------------------------------------------------------------------
</span><span class='line'>  # Org3: See "Org1" for full specification
</span><span class='line'>  # ---------------------------------------------------------------------------
</span><span class='line'>  - Name: Org3
</span><span class='line'>    Domain: org3.xuyao.com
</span><span class='line'>    EnableNodeOUs: true
</span><span class='line'>    Template:
</span><span class='line'>      Count: 2
</span><span class='line'>    Users:
</span><span class='line'>      Count: 1
</span><span class='line'>
</span><span class='line'>  # ---------------------------------------------------------------------------
</span><span class='line'>  # Org4: See "Org1" for full specification
</span><span class='line'>  # ---------------------------------------------------------------------------
</span><span class='line'>  - Name: Org4
</span><span class='line'>    Domain: org4.xuyao.com
</span><span class='line'>    EnableNodeOUs: true
</span><span class='line'>    Template:
</span><span class='line'>      Count: 2
</span><span class='line'>    Users:
</span><span class='line'>      Count: 1</span></code></pre></td></tr></table></div></figure>


<p>æ¯å°æœåŠ¡å™¨çš„è¿è¡Œå¤§è‡´å¦‚ä¸‹</p>

<ol>
<li>server1: Org1, Peer1ï¼ŒOrderer1ï¼ŒCa1ï¼ŒKafka1, Zookeeper1</li>
<li>server1:  Org2, Peer2ï¼ŒOrderer2ï¼ŒCa2ï¼ŒKafka2, Zookeeper2</li>
<li>server3:  Org3, Peer3ï¼ŒCa3ï¼ŒKafka3, Zookeeper3</li>
<li>server4:  Org4, Peer4ï¼ŒCa4ï¼ŒKafka4<br/>
æ¯å°æœåŠ¡å™¨ä¸€ä¸ªOrgç»„ç»‡ï¼Œå’Œä¸€ä¸ªèŠ‚ç‚¹ï¼Œ å…¶ä¸­ä¸¤å°æœåŠ¡å™¨æœ‰OrdereræœåŠ¡ï¼Œå››å°æœåŠ¡å™¨éƒ½æœ‰Caè®¤è¯ã€‚

<h6>æœªå®Œå¾…ç»­&hellip;..</h6></li>
</ol>


<h5>å‚è€ƒèµ„æ–™</h5>

<p><a href="https://golang.org/doc/install">https://golang.org/doc/install</a><br/>
<a href="https://github.com/golang/go/wiki/Ubuntu">https://github.com/golang/go/wiki/Ubuntu</a>
<a href="https://yeasy.gitbooks.io/docker_practice/install/">https://yeasy.gitbooks.io/docker_practice/install/</a><br/>
<a href="https://github.com/docker/compose/releases">https://github.com/docker/compose/releases</a>
<a href="https://linuxize.com/post/how-to-install-node-js-on-centos-7">https://linuxize.com/post/how-to-install-node-js-on-centos-7</a><br/>
<a href="https://git-scm.com/book/en/v2/Getting-Started-Installing-Git">https://git-scm.com/book/en/v2/Getting-Started-Installing-Git</a><br/>
<a href="https://www.cnblogs.com/aberic/p/7527831.html">https://www.cnblogs.com/aberic/p/7527831.html</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[å¯†ç å­¦(äºŒ)ä¹‹ä»£æ¢å¯†ç ]]></title>
    <link href="http://xuyao.club/blog/2018/07/17/cryptography-of-substitution-cipher/"/>
    <updated>2018-07-17T17:28:46+08:00</updated>
    <id>http://xuyao.club/blog/2018/07/17/cryptography-of-substitution-cipher</id>
    <content type="html"><![CDATA[<h3>ï¼ˆä¸€ï¼‰ä»£æ¢å¯†ç ï¼ˆæ›¿æ¢å¯†ç ï¼‰</h3>

<p>ä¸Šä¸€è®²ä¸­ï¼Œæˆ‘ä»¬è®²ç§»ä½å¯†ç å…¶å®æ˜¯å°†å­—æ¯è¡¨ä¸­çš„å­—æ¯ä¸€ä¸€å¯¹åº”åˆ°å„æ•°å­—ï¼Œç„¶åé€šè¿‡æ•°å­—å¹³ç§»æ¥è¿›è¡ŒåŠ å¯†ï¼Œå¤å…¸å¯†ç å­¦ä¸­è¿˜æœ‰ä¸€ç§æ¯”è¾ƒæœ‰åçš„åŠ å¯†æ–¹æ³•ï¼Œå°±æ˜¯å°†æ˜æ–‡ä¸­çš„å­—æ¯è¡¨å¯¹åº”åˆ°ä¸€å¥—å¯†æ–‡çš„å­—æ¯è¡¨ï¼Œè¿™ç§åŠ å¯†æ–¹æ³•æˆ‘ä»¬å«<strong>ä»£æ¢å¯†ç ï¼ˆsubstiution cipherï¼‰</strong>æˆ–å«<strong>æ›¿æ¢å¯†ç </strong>ï¼Œä¸‹å›¾å°±æ˜¯ä¸€ä¸ªç®€å•çš„ä»£æ¢å¯†ç å¯¹åº”è¡¨</p>

<!-- more -->


<p></p>

<p><img src="http://upload-images.jianshu.io/upload_images/1796624-db5bd0e79f37103e?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image" /></p>

<h3>ï¼ˆäºŒï¼‰ä»£æ¢å¯†ç çš„åŠ å¯†</h3>

<p>ä¸Šé¢æ‰€è¯´ï¼Œä»£æ¢å¯†ç å…¶å®å°±æ˜¯å°†æ˜æ–‡é‡Œçš„å­—æ¯æŒ‰ç…§å­—æ¯è¡¨æ›¿æ¢æˆå¯†æ–‡é‡Œçš„å­—æ¯ï¼Œè¿˜æ˜¯ä¸¾ä¸€ä¸ªä¾‹å­ï¼Œå‡è®¾ç°åœ¨æœ‰ä¸€ä¸ªå­—ç¬¦â€œwelcome to chinaâ€ï¼Œæ ¹æ®ä¸Šé¢çš„å¯†ç æ›¿æ¢è¡¨ï¼Œå°†æ˜æ–‡é‡Œé¢çš„æ¯ä¸ªå­—æ¯ä¾æ¬¡æ¢æˆå¯¹åº”çš„å¯†æ–‡ï¼Œå¦‚ä¸‹ï¼š</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">w</span><span class="o">-&gt;</span><span class="n">C</span>
</span><span class='line'><span class="n">e</span><span class="o">-&gt;</span><span class="n">X</span>
</span><span class='line'><span class="n">l</span><span class="o">-&gt;</span><span class="n">G</span>
</span><span class='line'><span class="n">c</span><span class="o">-&gt;</span><span class="n">H</span>
</span><span class='line'><span class="n">o</span><span class="o">-&gt;</span><span class="n">B</span>
</span><span class='line'><span class="n">m</span><span class="o">-&gt;</span><span class="n">E</span>
</span><span class='line'><span class="n">e</span><span class="o">-&gt;</span><span class="n">X</span>
</span><span class='line'><span class="n">t</span><span class="o">-&gt;</span><span class="n">Q</span>
</span><span class='line'><span class="n">o</span><span class="o">-&gt;</span><span class="n">B</span>
</span><span class='line'><span class="n">c</span><span class="o">-&gt;</span><span class="n">H</span>
</span><span class='line'><span class="n">h</span><span class="o">-&gt;</span><span class="n">T</span>
</span><span class='line'><span class="n">i</span><span class="o">-&gt;</span><span class="n">J</span>
</span><span class='line'><span class="n">n</span><span class="o">-&gt;</span><span class="n">N</span>
</span><span class='line'><span class="n">a</span><span class="o">-&gt;</span><span class="n">W</span>
</span></code></pre></td></tr></table></div></figure>


<p>è¿™æ ·å°±å¯ä»¥å¾—åˆ°å¯†æ–‡CXGHBEXQBHTJNW</p>

<h3>ï¼ˆä¸‰ï¼‰ä»£æ¢å¯†ç çš„è§£å¯†</h3>

<p>ä»£æ¢å¯†ç çš„è§£å¯†éå¸¸ç®€å•ï¼Œåªè¦å°†åŠ å¯†çš„æ›¿æ¢è¡¨è¿›è¡Œåå‘æ“ä½œï¼Œè¿™é‡Œä¸å†æ“ä½œ</p>

<p>è¿™é‡Œå¯ä»¥å‘ç°ï¼Œä»£æ¢å¯†ç ä¸»è¦æ˜¯è¦å»ºç«‹èµ·ä¸€å¥—æ˜æ–‡ä¸å¯†æ–‡ä¹‹é—´çš„åŠ å¯†å¯¹åº”çš„æ›¿æ¢å…³ç³»ï¼Œåªè¦æœ‰è¿™å¥—å¯†ç æ›¿æ¢è¡¨ï¼ŒåŠ ã€è§£å¯†å°±å˜å¾—å¾ˆå®¹æ˜“</p>

<h3>ï¼ˆå››ï¼‰ä»£æ¢å¯†ç çš„ç ´è§£</h3>

<p>ä¸Šä¸€è®²æˆ‘ä»¬çŸ¥é“ï¼Œç§»ä½å¯†ç å…¶å®æ˜¯å¾ˆå¥½ç ´è§£çš„ï¼Œå› ä¸ºå¯†é’¥æ€»é‡ä¸€å…±å°±26ä½ï¼Œåªè¦æˆ‘ä»¬è¯•26æ¬¡ï¼Œå°±ä¸€å®šèƒ½è¯•å‡ºä¸€ä¸ªæ­£è§£çš„ï¼Œé‚£ä¹ˆä»£æ¢å¯†ç æ˜¯ä¹Ÿå¯ä»¥é€šè¿‡ç©·ä¸¾çš„æ–¹å¼æ¥ç ´è§£å‘¢ï¼Ÿ</p>

<p>æˆ‘ä»¬çŸ¥é“ä»£æ¢å¯†ç æ˜¯æŠŠæ˜æ–‡çš„26ä¸ªå­—æ¯éšæœºå¯¹åº”å¯†æ–‡çš„26ä¸ªå­—æ¯ä¸Šï¼Œä¹Ÿå°±æ„å‘³ç€æ˜æ–‡ä¸­ç¬¬ä¸€ä¸ªå­—æ¯aå¯ä»¥å¯¹åº”åˆ°å¯†æ–‡ä¸­A,B,C,Dâ€¦Z 26ä¸ªå­—æ¯ä¸­çš„ä»»ä¸€ä¸ªï¼Œä»¥æ­¤ç±»æ¨ï¼Œæˆ‘ä»¬å°±å¯ä»¥è®¡ç®—å‡ºä»£æ¢å¯†ç çš„å¯†é’¥æ€»æ•°ä¸ºï¼š</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="mi">26</span> <span class="n">x</span> <span class="mi">25</span> <span class="n">x</span> <span class="mi">24</span> <span class="n">x</span> <span class="mi">23</span> <span class="n">x22</span> <span class="n">x</span> <span class="mi">21</span> <span class="n">x</span> <span class="err">â€¦</span> <span class="n">x</span> <span class="mi">1</span> <span class="o">=</span> <span class="mi">403291461126605635584000000</span>
</span></code></pre></td></tr></table></div></figure>


<p>åƒè¿™ç§ä¸€ç§å¯†ç èƒ½å¤Ÿä½¿ç”¨çš„æ‰€æœ‰å¯†é’¥çš„é›†åˆï¼Œå«åš<strong>å¯†é’¥ç©ºé—´ï¼ˆkeyspaceï¼‰</strong></p>

<p>ä¸Šé¢çš„å¯†é’¥çš„é‡éå¸¸å¤§ï¼Œç”¨ç©·ä¸¾æ³•æ¥ç ´è¯‘å‡ ä¹æ˜¯ä¸å¯èƒ½çš„ã€‚</p>

<p>ä½¿ç”¨ç©·ä¸¾æ³•ä¸èƒ½ç ´è¯‘ï¼Œä½†å¹¶ä¸èƒ½è¯´æ˜å°±æ˜¯å®‰å…¨çš„ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<a href="https://baike.baidu.com/item/%E5%AD%97%E6%AF%8D%E9%A2%91%E7%8E%87/9669044?fr=aladdin">é¢‘ç‡åˆ†æ</a>æ¥ç ´è¯‘ä»£æ¢å¯†ç ï¼Œé¢‘ç‡åˆ†æå°±æ˜¯åˆ©ç”¨æ˜æ–‡ä¸­çš„å­—æ¯å‡ºç°é¢‘ç‡ä¸å¯†æ–‡ä¸­çš„å­—æ¯çš„å‡ºç°é¢‘ç‡ä¸€è‡´è¿™ä¸€ç‰¹æ€§ï¼Œ</p>

<p>ä¸‹é¢æ˜¯ã€å¯†ç å­¦åŸç†ä¸å®è·µã€‘ä¹¦ä¸­çš„ä¸€ä¸ªä¾‹å­ï¼Œå¯ä»¥å‚è€ƒä¸€ä¸‹</p>

<p>ç°å‡è®¾æœ‰ä¸€æ®µå¯†æ–‡å¦‚ä¸‹ï¼Œç°éœ€å°†å…¶è§£å¯†å‡ºæ˜æ–‡</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="no">YIFQFMZRWQFYVECFMDZPCVMRZWNMDZVEJBTXCDDUMJ</span>
</span><span class='line'>
</span><span class='line'><span class="no">NDIFEFMDZCDMQZKCEYFCJMYRNCWJCSZREXCHZUNMXZ</span>
</span><span class='line'>
</span><span class='line'><span class="no">NXUCDRJXYYSMRTMEYIFZWDYVZVYFZUMRZCRWNZDZJJ</span>
</span><span class='line'>
</span><span class='line'><span class="no">XZWGCHSMRNMDHNCMFQCHZJMXJXWIFJYUCFWDJNZDIR</span>
</span></code></pre></td></tr></table></div></figure>


<p>è¿™ç§å¯†æ–‡çš„é¢‘ç‡åˆ†æå¦‚ä¸‹å›¾ï¼š</p>

<p><img src="http://upload-images.jianshu.io/upload_images/1796624-3e73907eab25c8f3?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image" /></p>

<p>æ ¹æ®<a href="https://zh.wikipedia.org/wiki/%E5%AD%97%E6%AF%8D%E9%A2%91%E7%8E%87">è‹±æ–‡å­—æ¯å‡ºç°çš„é¢‘ç‡</a>æ’åºç»Ÿè®¡ï¼Œä¸€èˆ¬çš„æ’åºæ˜¯è¿™æ ·çš„e,t,a,o,I,n,s,h,r,d,l,u,c,m,f,w,y,p,v,b,g,k,j,q,x,zÂ è€Œä¸”ä¸€èˆ¬è‹±è¯­æ–‡ç« ä¸­å‡ºç°é¢‘ç‡æœ€é«˜çš„çš„å­—æ¯æ˜¯e,è¿™ä¸€ç‚¹åŸºæœ¬ä¸ä¼šé”™çš„ã€‚</p>

<p>æ ¹æ®ä¸Šå›¾æ‰€ç¤ºï¼Œå­—æ¯Zå‡ºç°çš„æ¬¡æ•°æ˜¯20ï¼Œè¿œè¿œé«˜äºå…¶å®ƒå¯†æ–‡å­—æ¯ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å‡è®¾Z->eã€‚å…¶å®ƒå‡ºç°è‡³å°‘10ä½™æ¬¡çš„å®˜æ–¹å­—æ¯æ˜¯C,D,F,J,M,R,Yï¼Œæˆ‘ä»¬å¸Œæœ›è¿™äº›å­—æ¯å¯¹åº”çš„æ˜¯</p>

<p>e t a o l n s h rä¸­çš„ä¸€ä¸ªå­é›†ï¼Œ</p>

<p>æˆ‘ä»¬ç°åœ¨å‡è®¾äº†Z->eï¼Œç°æ³¨æ„ä¸€ä¸‹å½¢å¦‚-Z, Z-çš„ä¸¤å­—æ¯ç»„ï¼Œæˆ‘ä»¬å‘ç°å‡ºç°è¿™ç§ç±»å‹çš„æœ€ä¸€èˆ¬çš„ä¸¤å­—æ¯ç»„æ˜¯DZå’ŒZW,å„éƒ½å‡ºç°äº†4æ¬¡ï¼›NZå’ŒZUå‡ºç°3æ¬¡ï¼ŒRZ HZ XZ FZ ZR ZV ZC ZD ZJå„å‡ºç°2æ¬¡ï¼›åˆå› ZWå‡ºç°4æ¬¡ï¼Œè€ŒWZä¸€æ¬¡ä¹Ÿæœªå‡ºç°ï¼ŒåŒæ—¶Wæ¯”è®¸å¤šå…¶å®ƒå­—æ¯å‡ºç°çš„æ¬¡å¨„å°‘ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å‡è®¾W->dï¼Œåˆå› ä¸ºDZå‡ºç°4æ¬¡è€ŒZDå‡ºç°2æ¬¡ï¼Œæ•…å¯çŒœæµ‹Dæ˜¯{r,s,t}ä¸­çš„ä»»ä¸€ä¸ªï¼Œå…·ä½“æ˜¯å“ªä¸ªè¿˜ä¸æ¸…æ¥šã€‚</p>

<p>å¦‚ä¸Šé¢çŒœæµ‹ï¼Œ Z->, D->dï¼Œå†çœ‹çœ‹å¯†æ–‡å¹¶æ³¨æ„åˆ°ZRWå‡ºç°åœ¨å¯†æ–‡çš„å¼€å§‹éƒ¨åˆ†ï¼ŒRWåé¢ä¹Ÿå‡ºç°è¿‡ï¼Œå› ä¸ºRåœ¨å¯†æ–‡é¢‘ç¹åœ°å‡ºç°ï¼Œè€Œndæ˜¯ä¸€ä¸ªå¸¸è§çš„ä¸¤å­—æ¯ç»„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å‡è®¾R->nä½œä¸ºå¯èƒ½çš„æƒ…å†µï¼Œè¿™æ ·æˆ‘ä»¬ä¾¿æœ‰äº†å¦‚ä¸‹çš„å½¢å¼</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="o">------</span><span class="k">end</span><span class="o">---------</span><span class="n">e</span><span class="o">-----</span><span class="n">ned</span><span class="o">--</span><span class="n">e</span><span class="o">------------</span>
</span><span class='line'><span class="no">YIFQFMZRWQFYVECFMDZPCVMRZWNMDZVEJBTXCDDUMJ</span>
</span><span class='line'><span class="o">--------</span><span class="n">e</span><span class="o">----</span><span class="n">e</span><span class="o">---------</span><span class="n">n</span><span class="o">-</span><span class="n">d</span><span class="o">----</span><span class="n">en</span><span class="o">----</span><span class="n">e</span><span class="o">----</span><span class="n">e</span>
</span><span class='line'><span class="no">NDIFEFMDZCDMQZKCEYFCJMYRNCWJCSZREXCHZUNMXZ</span>
</span><span class='line'><span class="o">-</span><span class="n">e</span><span class="o">---</span><span class="n">n</span><span class="o">------</span><span class="n">n</span><span class="o">------</span><span class="n">ed</span><span class="o">-----</span><span class="n">e</span><span class="o">-</span><span class="n">e</span><span class="o">--</span><span class="n">ne</span><span class="o">-</span><span class="n">nd</span><span class="o">-</span><span class="n">e</span><span class="o">-</span><span class="n">e</span><span class="o">--</span>
</span><span class='line'><span class="no">NZUCDRJXYYSMRTMEYIFZWDYVZVYFZUMRZCRWNZDZJJ</span>
</span><span class='line'><span class="o">-</span><span class="n">ed</span><span class="o">-----</span><span class="n">n</span><span class="o">-----------</span><span class="n">e</span><span class="o">----</span><span class="n">ed</span><span class="o">-------</span><span class="n">d</span><span class="o">---</span><span class="n">e</span><span class="o">--</span><span class="n">n</span>
</span><span class='line'><span class="no">XZWGCHSMRNMDHNCMFQCHZJMXJZWIFJYUCFWDJNZDIR</span>
</span></code></pre></td></tr></table></div></figure>


<p>æ¥ä¸‹æ¥æˆ‘ä»¬å¯ä»¥è¯•è¯•N->hï¼Œå› ä¸ºNZæ˜¯ä¸€ä¸ªå¸¸è§çš„ä¸¤å­—ç»„è€ŒZNä¸æ˜¯ä¸€ä¸ªå¸¸è§çš„ä¸¤å­—æ¯ç»„ï¼Œå¦‚æœè¿™ä¸ªçŒœæµ‹æ˜¯æ­£ç¡®çš„ï¼Œåˆ™æ˜æ–‡ne-ndheå¾ˆå¯èƒ½è¯´æ˜C->aï¼Œç»“åˆè¿™äº›æ”¶å¸‚ï¼Œæˆ‘ä»¬åˆè¿›ä¸€æ­¥æœ‰:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="o">------</span><span class="k">end</span><span class="o">-----</span><span class="n">a</span><span class="o">---</span><span class="n">e</span><span class="o">-</span><span class="n">a</span><span class="o">--</span><span class="n">nedh</span><span class="o">--</span><span class="n">e</span><span class="o">------</span><span class="n">a</span><span class="o">-----</span>
</span><span class='line'><span class="no">YIFQFMZRWQFYVECFMDZPCVMRZWNMDZVEJBTXCDDUMJ</span>
</span><span class='line'><span class="n">h</span><span class="o">-------</span><span class="n">ea</span><span class="o">---</span><span class="n">e</span><span class="o">-</span><span class="n">a</span><span class="o">---</span><span class="n">a</span><span class="o">----</span><span class="n">ehad</span><span class="o">-</span><span class="n">a</span><span class="o">-</span><span class="n">en</span><span class="o">-</span><span class="n">a</span><span class="o">-</span><span class="n">e</span><span class="o">-</span><span class="n">h</span><span class="o">--</span><span class="n">e</span>
</span><span class='line'><span class="no">NDIFEFMDZCDMQZKCEYFCJMYRNCWJCSZREXCHZUNMXZ</span>
</span><span class='line'><span class="n">he</span><span class="o">-</span><span class="n">a</span><span class="o">-</span><span class="n">n</span><span class="o">------</span><span class="n">n</span><span class="o">------</span><span class="n">ed</span><span class="o">---</span><span class="n">e</span><span class="o">---</span><span class="n">e</span><span class="o">--</span><span class="n">neandhe</span><span class="o">-</span><span class="n">e</span><span class="o">--</span>
</span><span class='line'><span class="no">NZUCDRJXYYSMRTMEYIFZWDYVZVYFZUMRZCRWNZDZJJ</span>
</span><span class='line'><span class="o">-</span><span class="n">ed</span><span class="o">-</span><span class="n">a</span><span class="o">---</span><span class="n">nh</span><span class="o">---</span><span class="n">ha</span><span class="o">---</span><span class="n">a</span><span class="o">-</span><span class="n">e</span><span class="o">----</span><span class="n">ed</span><span class="o">-----</span><span class="n">a</span><span class="o">-</span><span class="n">d</span><span class="o">--</span><span class="n">he</span><span class="o">--</span><span class="n">n</span>
</span><span class='line'><span class="no">XZWGCHSMRNMDHNCMFQCHZJMXJZWIFJYUCFWDJNZDIR</span>
</span></code></pre></td></tr></table></div></figure>


<p>ç°åœ¨è€ƒè™‘å‡ºç°æ¬¡æ•°é«˜çš„å¯†æ–‡å­—æ¯M,ç”±å‰é¢åˆ†æï¼Œå¯†æ–‡æ®µRNMå¯†é’¥æˆnh-ï¼Œè¿™è¯´æ˜h-æ˜¯ä¸€ä¸ªè¯çš„å¼€å¤´ï¼Œæ‰€ä»¥Må¾ˆå¯èƒ½æ˜¯ä¸€ä¸ªå…ƒéŸ³ï¼Œå› ä¸ºå·²ç»ä½¿ç”¨äº†aå’Œe,æ‰€ä»¥çŒœæµ‹M->{iæˆ–o}ï¼Œå› ä¸ºaiæ˜¯ä¸€ä¸ªæ¯”aoå‡ºç°æ¬¡æ•°æ›´é«˜çš„æ˜æ–‡ç»„ï¼Œæ‰€ä»¥é¦–å…ˆçŒœæµ‹M->Iï¼Œè¿™æ ·å°±æœ‰ï¼š</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="o">-----</span><span class="n">iend</span><span class="o">-----</span><span class="n">a</span><span class="o">-</span><span class="n">i</span><span class="o">-</span><span class="n">e</span><span class="o">-</span><span class="n">a</span><span class="o">-</span><span class="n">inedh</span><span class="o">--</span><span class="n">e</span><span class="o">------</span><span class="n">a</span><span class="o">---</span><span class="n">i</span><span class="o">-</span>
</span><span class='line'><span class="no">YIFQFMZRWQFYVECFMDZPCVMRZWNMDZVEJBTXCDDUMJ</span>
</span><span class='line'><span class="n">h</span><span class="o">-----</span><span class="n">i</span><span class="o">-</span><span class="n">ea</span><span class="o">-</span><span class="n">i</span><span class="o">-</span><span class="n">e</span><span class="o">-</span><span class="n">a</span><span class="o">---</span><span class="n">a</span><span class="o">-</span><span class="n">i</span><span class="o">-</span><span class="n">nhad</span><span class="o">-</span><span class="n">a</span><span class="o">-</span><span class="n">en</span><span class="o">--</span><span class="n">a</span><span class="o">-</span><span class="n">e</span><span class="o">-</span><span class="n">hi</span><span class="o">-</span><span class="n">e</span>
</span><span class='line'><span class="no">NDIFEFMDZCDMQZKCEYFCJMYRNCWJCSZREXCHZUNMXZ</span>
</span><span class='line'><span class="n">he</span><span class="o">-</span><span class="n">a</span><span class="o">-</span><span class="n">n</span><span class="o">-----</span><span class="k">in</span><span class="o">-</span><span class="n">i</span><span class="o">----</span><span class="n">ed</span><span class="o">---</span><span class="n">e</span><span class="o">---</span><span class="n">e</span><span class="o">-</span><span class="n">ineandhe</span><span class="o">--</span><span class="n">e</span><span class="o">-</span>
</span><span class='line'><span class="no">NZUCDRJXYYSMRTMEYIFZWDYVZVYFZUMRZCRWNZDZJJ</span>
</span><span class='line'><span class="o">-</span><span class="n">ed</span><span class="o">-</span><span class="n">a</span><span class="o">--</span><span class="n">inhi</span><span class="o">--</span><span class="n">hai</span><span class="o">--</span><span class="n">a</span><span class="o">-</span><span class="n">e</span><span class="o">-</span><span class="n">i</span><span class="o">---</span><span class="n">ed</span><span class="o">----</span><span class="n">a</span><span class="o">--</span><span class="n">d</span><span class="o">-</span><span class="n">he</span><span class="o">--</span><span class="n">n</span>
</span><span class='line'><span class="no">XZWGCHSMRNMDHNCMFQCHZJMXJZWIFJYUCFWDJNZDIR</span>
</span></code></pre></td></tr></table></div></figure>


<p>ä¸‹é¢éœ€è¦ç¡®å®šæ˜æ–‡oå¯¹åº”çš„å¯†æ–‡ï¼Œå› ä¸ºä¸ºæ˜¯ä¸€ä¸ªç»å¸¸å‡ºç°çš„å­—æ¯ï¼Œæ‰€ä»¥æˆ‘ä»¬çŒœæµ‹ç›¸åº”çš„å¯†æ–‡å­—æ¯æ˜¯D F J Y ä¸­çš„ä¸€ä¸ªï¼ŒYä¼¼ä¹æœ€æœ‰å¯èƒ½ï¼Œå¦åˆ™å°†å¾—åˆ°é•¿å…ƒéŸ³ï¼Œå³ä»CFMæˆ–CJMä¸­å¾—åˆ°aoi,å› æ­¤å‡è®¾Y->oã€‚</p>

<p>å‰©ä¸‹å¯†æ–‡å­—æ¯ä¸­ä¸‰ä¸ªæœ€é«˜é¢‘ç‡çš„å­—æ¯æ˜¯D F J,æˆ‘ä»¬çŒœæµ‹ä»–ä»¬ä»¥æŸç§æ¬¡åºè§£å¯†æˆr s tï¼Œ ä¸‰å­—æ¯NMDä¸¤æ¬¡å‡ºç°è¯´æ˜å¾ˆå¯èƒ½D->s,å¯¹åº”çš„æ˜æ–‡ä¸‰å­—æ¯ç»„ä¸ºhisï¼ŒHNCMFå¯èƒ½æ˜¯chairçš„åŠ å¯†ï¼Œè¯´æ˜F->r,H->cï¼ŒåŒæ—¶æ’é™¤J->tï¼Œäºæ˜¯æˆ‘ä»¬æœ‰äº†ï¼š</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">o</span><span class="o">-</span><span class="n">r</span><span class="o">-</span><span class="n">riend</span><span class="o">-</span><span class="n">ro</span><span class="o">--</span><span class="n">arise</span><span class="o">-</span><span class="n">a</span><span class="o">-</span><span class="n">inedhise</span><span class="o">--</span><span class="n">t</span><span class="o">---</span><span class="n">ass</span><span class="o">-</span><span class="n">it</span>
</span><span class='line'><span class="no">YIFQFMZRWQFYVECFMDZPCVMRZWNMDZVEJBTXCDDUMJ</span>
</span><span class='line'><span class="n">hs</span><span class="o">-</span><span class="n">r</span><span class="o">-</span><span class="n">riseasi</span><span class="o">-</span><span class="n">e</span><span class="o">-</span><span class="n">a</span><span class="o">-</span><span class="n">orationhadta</span><span class="o">-</span><span class="n">en</span><span class="o">--</span><span class="n">ace</span><span class="o">-</span><span class="n">hi</span><span class="o">-</span><span class="n">e</span>
</span><span class='line'><span class="no">NDIFEFMDZCDMQZKCEYFCJMYRNCWJCSZREXCHZUNMXZ</span>
</span><span class='line'><span class="n">he</span><span class="o">-</span><span class="n">asnt</span><span class="o">-</span><span class="n">oo</span><span class="o">-</span><span class="k">in</span><span class="o">-</span><span class="n">i</span><span class="o">-</span><span class="n">o</span><span class="o">-</span><span class="n">redso</span><span class="o">-</span><span class="n">e</span><span class="o">-</span><span class="n">ore</span><span class="o">-</span><span class="n">ineandhesett</span>
</span><span class='line'><span class="no">NZUCDRJXYYSMRTMEYIFZWDYVZVYFZUMRZCRWNZDZJJ</span>
</span><span class='line'><span class="o">-</span><span class="n">ed</span><span class="o">-</span><span class="n">ac</span><span class="o">-</span><span class="n">inhischair</span><span class="o">-</span><span class="n">acet</span><span class="o">-</span><span class="n">i</span><span class="o">-</span><span class="n">ted</span><span class="o">-</span><span class="n">to</span><span class="o">-</span><span class="n">ardsthes</span><span class="o">-</span><span class="n">n</span>
</span><span class='line'><span class="no">XZWGCHSMRNMDHNCMFQCHZJMXJZWIFJYUCFWDJNZDIR</span>
</span></code></pre></td></tr></table></div></figure>


<p>æœ‰äº†ä¸Šé¢çš„æç¤ºï¼Œå°±å¾ˆå®¹æ˜“ç¡®å®šå‡ºæ˜æ–‡ï¼Œè§£å¯†æ˜æ–‡å¦‚ä¸‹</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="no">Our</span> <span class="n">friend</span> <span class="n">from</span> <span class="n">paris</span> <span class="n">examined</span> <span class="n">his</span> <span class="n">empty</span> <span class="n">glass</span> <span class="n">with</span> <span class="n">surprise</span><span class="p">,</span> <span class="n">as</span> <span class="n">ifevaporation</span> <span class="n">has</span> <span class="n">taken</span> <span class="n">place</span> <span class="k">while</span> <span class="n">he</span> <span class="n">wasn</span><span class="err">â€™</span><span class="n">t</span><span class="err">Â </span><span class="n">looking</span><span class="p">,</span> <span class="n">I</span> <span class="n">poured</span> <span class="n">some</span> <span class="n">more</span> <span class="n">wine</span> <span class="ow">and</span> <span class="n">hesettled</span> <span class="n">back</span> <span class="k">in</span> <span class="n">his</span> <span class="n">chair</span><span class="p">,</span><span class="n">face</span> <span class="n">tilted</span> <span class="n">up</span> <span class="n">towards</span> <span class="n">the</span> <span class="n">sun</span><span class="o">.</span>
</span></code></pre></td></tr></table></div></figure>


<h3>å‚è€ƒèµ„æ–™</h3>

<p>ã€å¯†ç å­¦åŸç†ä¸å®è·µï¼ˆç¬¬ä¸‰ç‰ˆï¼‰ã€‘</p>

<p>ã€å›¾è§£å¯†ç æŠ€æœ¯ã€‘</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[å¯†ç å­¦(ä¸€)ä¹‹ç§»ä½å¯†ç (æºæ’’å¯†ç )]]></title>
    <link href="http://xuyao.club/blog/2018/07/13/cryptography-of-shift-cipher/"/>
    <updated>2018-07-13T14:03:33+08:00</updated>
    <id>http://xuyao.club/blog/2018/07/13/cryptography-of-shift-cipher</id>
    <content type="html"><![CDATA[<h3>å‰è¨€</h3>

<p>   å¯†ç å­¦çš„åŸºæœ¬ç›®çš„æ˜¯ä½¿å¾—ä¸¤ä¸ªåœ¨ä¸å®‰å…¨çš„ä¿¡é“ä¸Šè¿›è¡Œå®‰å…¨çš„é€šä¿¡ï¼Œåœ¨è®¡ç®—æœºç½‘ç»œä¸­ï¼Œç°å‡è®¾æœ‰ä¸¤ä¸ªäººAliceå’ŒBobï¼ŒAliceæƒ³å‘é€æ¶ˆæ¯ç»™Bobï¼Œå‘Šè¯‰ä»–æ˜å¤©å‡Œæ™¨2ç‚¹æ¯’è´©å°†åœ¨4å·ç å¤´è¿›è¡Œäº¤æ˜“ï¼Œè¯·Bobé…åˆç¼‰æ¯’ã€‚è¿™é‡ŒAliceæœ‰ä¸€ä¸ªéº»çƒ¦å°±æ˜¯ä»–æ€•åœ¨ä¿¡æ¯ä¼ è¾“ä¸­å¯èƒ½ä¼šè¢«æ•ŒäººOscarç›‘å¬ï¼Œç”šè‡³ç¯¡æ”¹æ¶ˆæ¯å†…å®¹ï¼Œå¯¼è‡´æ•´ä¸ªè®¡åˆ’å¤±è´¥ï¼ŒBobä¹Ÿå¯¹Aliceå‘è¿‡æ¥çš„æ¶ˆæ¯æœ‰ç–‘è™‘ï¼Œä¸çŸ¥é“æ¶ˆæ¯æ˜¯å¦ä¸ºAliceæœ¬äººæ‰€å‘ï¼Œæ¶ˆæ¯å†…å®¹æ˜¯å¦çœŸå®ç­‰ç­‰ã€‚<br/>
   <!-- more --></p>

<p> è¿™é‡Œå¯†ç å­¦çš„é‡è¦æ€§å°±ä½“ç°å‡ºæ¥äº†ï¼Œå‡è®¾Aliceäº‹å…ˆå’ŒBobå•†é‡å¥½ä¸€ä¸ªå¯†é’¥ï¼ˆkeyï¼‰,Aliceé€šè¿‡å¯†é’¥å°†æ˜æ–‡ï¼ˆplaintextï¼‰åŠ å¯†æˆå¯†æ–‡ï¼Œåœ¨ç½‘ç»œä¸­ä¼ è¾“ï¼ŒBobæ”¶åˆ°Aliceä¼ è¿‡æ¥çš„å¯†æ–‡ï¼ˆciphertextï¼‰ï¼Œç”¨äº‹å…ˆå•†é‡å¥½çš„å¯†é’¥è¿›è¡Œè§£å¯†ï¼Œå¾—åˆ°æ˜æ–‡ï¼Œè€Œæ•Œäººå³ä½¿ç›‘å¬åˆ°Aliceå‘é€çš„æ¶ˆæ¯ï¼Œä¹Ÿæ˜¯åŠ å¯†è¿‡çš„å¯†æ–‡ï¼Œç”±äºä¸çŸ¥é“å¯†é’¥ï¼Œæ‰€ä»¥æ— æ³•çŸ¥é“çœŸå®çš„æ˜æ–‡ï¼Œæ•´ä¸ªè¿‡ç¨‹å¦‚ä¸‹ã€‚
<img src="https://upload-images.jianshu.io/upload_images/1796624-95050e2fc8412a32.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png" /></p>

<h3>ç§»ä½å¯†ç ï¼ˆShift Cipherï¼‰ã€æºæ’’å¯†ç (Caesar Cipher)</h3>

<p>ç§»ä½å¯†ç æ˜¯å¤å…¸å¯†ç å­¦ä¸­æœ€æ—©ï¼Œæœ€ç®€å•çš„ä¸€ç§åŠ ã€è§£å¯†ç æ–¹æ³•ï¼Œæœ€æ—©å¯è¿½æº¯è‡³å¤ç½—é©¬æ—¶ä»£ï¼Œå°¤åˆ©ä¹Œæ–¯:æºæ’’æ›¾ç»ä½¿ç”¨è¿‡æ­¤å¯†ç ã€‚</p>

<p>ç§»ä½å¯†ç æ˜¯é€šè¿‡å°†æ˜æ–‡ä¸­æ‰€ä½¿ç”¨çš„å­—æ¯æŒ‰ç…§ä¸€å®šçš„å­—æ•°è¿›è¡Œâ€œå¹³ç§»â€æ¥åŠ å¯†ï¼Œä¸ºäº†ç®€åŒ–å†…å®¹ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬åªä½¿ç”¨è‹±æ–‡å­—æ¯ä½œä¸ºç¤ºä¾‹ï¼Œæˆ‘ä»¬ç”¨å°å†™å­—æ¯(a,b,c,dâ€¦)æ¥è¡¨ç¤ºæ˜æ–‡ï¼Œç”¨å¤§å†™å­—æ¯ï¼ˆA,B,C,Dâ€¦ï¼‰æ¥è¡¨ç¤ºå¯†æ–‡ã€‚</p>

<p>æœ€æ—©æœŸæ—¶ï¼Œä¸€èˆ¬å°†å­—æ¯å¹³ç§»3ä½ï¼Œä¹Ÿå°±æ˜¯a->Dï¼Œb->Eï¼Œc->F,
è¿™ç§æœ€æ—©æ—¶å¹³ç§»3ä½æ˜¯å«<strong>æºæ’’å¯†ç (Caesar Cipher)</strong>ï¼Œåæ¥ç»è¿‡æ¨å¹¿ï¼Œå¹³ç§»ä½æ•°ä¹Ÿä¸ä¸€å®šæ˜¯3ä½ï¼Œå¯ä»¥æ˜¯å…¶å®ƒä»»ä½•æ•´æ•°ä½ï¼Œè¿™ç§åˆå«<strong>ç§»ä½å¯†ç ï¼ˆShift Cipherï¼‰</strong>ï¼Œå¯ä»¥çŸ¥é“ï¼Œæºæ’’å¯†ç æ˜¯ç§»ä½å¯†ç çš„ä¸€ä¸ªç‰¹ä¾‹ï¼ˆkey=3æ—¶ï¼‰ï¼Œä¸‹é¢æ˜¯æºæ’’å¯†ç å¹³ç§»çš„å·¥ä½œæ–¹å¼<br/>
<img src="https://upload-images.jianshu.io/upload_images/1796624-e1fa042fd62a2c56.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png" /></p>

<h3>ç§»ä½å¯†ç çš„åŠ å¯†</h3>

<p> ä½¿ç”¨ç§»ä½å¯†ç å¯ä»¥ç”¨æ¥åŠ å¯†æ™®é€šçš„è‹±æ–‡å¥å­ï¼Œä½†æ˜¯æˆ‘ä»¬è¦å»ºç«‹è‹±æ–‡å­—æ¯å’Œæ¨¡26å‰©ä½™ä¹‹é—´ä¸€ä¸€å¯¹åº”å…³ç³»ï¼Œå¦‚A->0ï¼ŒB->1,â€¦Z->25ã€‚å…¶åˆ—è¡¨å¦‚ä¸‹ï¼š<br/>
<img src="https://upload-images.jianshu.io/upload_images/1796624-0dbef7eedef6d7dc.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png" /><br/>
ç°å‡è®¾æˆ‘ä»¬æœ‰æ˜æ–‡P=chinaï¼Œå¯†é’¥K=3, ç°è¦å°†å…¶åŠ å¯†ï¼Œæ ¹æ®ä¸Šè¡¨ï¼Œå°†å­—ç¬¦Pä¸­çš„æ¯ä¸ªå­—æ¯å¹³ç§»3ä½ï¼Œå¾—åˆ°å¦‚ä¸‹æƒ…å†µ:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">c</span><span class="o">-&gt;</span><span class="n">F</span>
</span><span class='line'><span class="n">h</span><span class="o">-&gt;</span><span class="n">K</span>
</span><span class='line'><span class="n">i</span><span class="o">-&gt;</span><span class="n">L</span>
</span><span class='line'><span class="n">n</span><span class="o">-&gt;</span><span class="n">Q</span>
</span><span class='line'><span class="n">a</span><span class="o">-&gt;</span><span class="n">D</span>
</span></code></pre></td></tr></table></div></figure>


<p>è‡³æ­¤ï¼Œæ˜æ–‡chinaå°±è¢«è½¬æ¢æˆäº†å¯†æ–‡FKLQDï¼Œ<br/>
å…·ä½“ç”¨ç¨‹åºç®—æ³•å¯å½’çº³å¦‚ä¸‹:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">a</span><span class="err">ï¼Œé¦–å…ˆå°†æ˜æ–‡ä¸­çš„å­—æ¯æŒ‰ç…§ä¸Šè¡¨å¯¹åº”æˆç›¸åº”çš„æ•°å­—ï¼š</span>
</span><span class='line'>   <span class="mi">2</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">13</span> <span class="mi">0</span>
</span><span class='line'><span class="n">b</span><span class="err">ï¼Œå†å°†ä¸Šé¢çš„æ•°å­—ä¸å¯†é’¥</span><span class="n">K</span><span class="o">=</span><span class="mi">3</span><span class="err">ç›¸åŠ ï¼š</span>
</span><span class='line'>   <span class="mi">5</span> <span class="mi">10</span> <span class="mi">11</span> <span class="mi">16</span> <span class="mi">3</span>
</span><span class='line'><span class="n">c</span><span class="err">ï¼Œå†å¯¹å„ä¸ªæ•°å­—å–æ¨¡</span><span class="mi">26</span><span class="err">è¿ç®—ï¼Œå¯å¾—ï¼š</span>
</span><span class='line'>   <span class="mi">5</span> <span class="mi">10</span> <span class="mi">11</span> <span class="mi">16</span> <span class="mi">3</span>
</span><span class='line'><span class="n">d</span><span class="err">ï¼Œæœ€åå°†å„æ•°å­—è½¬åŒ–ä¸ºå­—æ¯å³å¯å¾—å¯†æ–‡</span>
</span><span class='line'>   <span class="n">F</span>  <span class="n">K</span>  <span class="n">L</span>  <span class="n">Q</span>  <span class="n">D</span>
</span></code></pre></td></tr></table></div></figure>


<p>å…·ä½“ä»£ç å¯å‚è€ƒè¿™é‡Œ
<a href="https://github.com/xuyao91/cryptography/blob/master/caesar/caesar.rb#L10">https://github.com/xuyao91/cryptography/blob/master/caesar/caesar.rb#L10</a></p>

<h3>ç§»ä½å¯†ç çš„è§£å¯†</h3>

<p>ç§»ä½å¯†ç çš„è§£å¯†ä¹Ÿéå¸¸ç®€å•ï¼Œåªè¦ä½¿ç”¨åŠ å¯†æ—¶ç”¨çš„å¯†é’¥è¿›è¡Œåå‘å¹³ç§»æ“ä½œï¼Œåˆšæ¥çš„ä¾‹å­åªè¦å°†å¯†æ–‡åå‘å¹³ç§»3ä½å°±è¡Œï¼Œå¯å¾—åˆ°å¦‚ä¸‹ï¼š</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">F</span><span class="o">-&gt;</span><span class="n">c</span>
</span><span class='line'><span class="n">K</span><span class="o">-&gt;</span><span class="n">h</span>
</span><span class='line'><span class="n">L</span><span class="o">-&gt;</span><span class="n">i</span>
</span><span class='line'><span class="n">Q</span><span class="o">-&gt;</span><span class="n">n</span>
</span><span class='line'><span class="n">D</span><span class="o">-&gt;</span><span class="n">a</span>
</span></code></pre></td></tr></table></div></figure>


<p>å…·ä½“ç¨‹åºçš„ç®—æ³•å…¶å®å°±æ˜¯åŠ å¯†çš„åå‘æ“ä½œï¼Œå¦‚ä¸‹ï¼š</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">a</span><span class="err">ï¼Œ</span> <span class="err">å°†å¯†æ–‡è½¬åŒ–æˆå¯¹åº”çš„å­—æ¯</span>
</span><span class='line'>    <span class="mi">5</span> <span class="mi">10</span> <span class="mi">11</span> <span class="mi">16</span> <span class="mi">3</span>
</span><span class='line'><span class="n">b</span><span class="err">ï¼Œ</span> <span class="err">å°†å„æ•°å­—å‡å»å¯†é’¥</span><span class="n">K</span><span class="o">=</span><span class="mi">3</span><span class="err">ï¼Œå¾—åˆ°å¦‚ä¸‹æ•°å­—</span>
</span><span class='line'>    <span class="mi">2</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">13</span> <span class="mi">0</span>
</span><span class='line'><span class="n">c</span><span class="err">ï¼Œ</span> <span class="err">å†å¯¹å„ä¸ªæ•°å­—å–æ¨¡</span><span class="mi">26</span><span class="err">è¿ç®—ï¼Œå¾—ï¼š</span>
</span><span class='line'>    <span class="mi">2</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">13</span> <span class="mi">0</span>
</span><span class='line'><span class="n">d</span><span class="err">ï¼Œ</span> <span class="err">æœ€åå°†æ•°å­—è½¬åŒ–æˆå­—æ¯å¾—</span>
</span><span class='line'>    <span class="n">c</span> <span class="n">h</span> <span class="n">i</span>  <span class="n">n</span> <span class="n">a</span>
</span></code></pre></td></tr></table></div></figure>


<p>å…·ä½“ä»£ç å¯å‚è€ƒè¿™é‡Œï¼š
<a href="https://github.com/xuyao91/cryptography/blob/master/caesar/caesar.rb#L18">https://github.com/xuyao91/cryptography/blob/master/caesar/caesar.rb#L18</a></p>

<h3>ç§»ä½å¯†ç çš„æš´åŠ›ç ´è§£</h3>

<p>é€šè¿‡ä¸Šé¢çš„ä¾‹å­å¯ä»¥çŸ¥é“ï¼Œæˆ‘ä»¬åªè¦æ‹¿åˆ°çš„å¯†é’¥Kï¼Œå°±å¯ä»¥å¯†æ–‡è§£å¯†ï¼Œé‚£ä¹ˆæœ‰æ²¡æœ‰ä¸ç”¨å¯†é’¥å°±å¯ä»¥è§£å¯†çš„å‘¢ï¼Œåœ¨ç§»ä½å¯†ç ä¸­ï¼Œå¯†é’¥å°±æ˜¯å­—æ¯å¹³ç§»çš„ä½æ•°ï¼Œå› ä¸ºå› ä¸ºå­—æ¯è¡¨é‡Œåªæœ‰26ä¸ªå­—æ¯ï¼ˆ0-25ï¼‰ï¼Œæ‰€ä»¥åŠ å¯†çš„å¯†é’¥ä¸€å…±å°±æ˜¯0-25ä¹‹é—´çš„26ä¸ªæ•°å­—ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠ26ä¸ªæ•°å­—å…¨éƒ¨å½“ä½œå¯†é’¥è¯•ä¸€æ¬¡ï¼Œè§£å¯†å‡ºæ¥å…¶ä¸­æœ‰ä¸€ä¸ªæ˜æ–‡è‚¯å®šæ˜¯å¯¹çš„ã€‚</p>

<p>åƒè¿™ç§å°†æ‰€æœ‰å¯èƒ½çš„å¯†é’¥å…¨éƒ¨å°è¯•ä¸€éçš„ï¼Œæˆ‘ä»¬å«<strong>æš´åŠ›ç ´è§£(brute-force attack)</strong>ï¼Œè¿™ç§æ–¹æ³•æœ¬è´¨æ˜¯åœ¨æ‰€æœ‰çš„å¯†é’¥ä¸­æ‰¾å‡ºæ­£ç¡®çš„é‚£ä¸€ä¸ªï¼Œå› æ­¤åˆç§°ä¸º<strong>ç©·ä¸¾æœç´¢ï¼ˆexhaustive searchï¼‰</strong>ã€‚</p>

<p>å¯ä»¥å°†ä¸Šé¢çš„ä¾‹å­é€šè¿‡æš´åŠ›ç ´è§£è¯•ä¸€ä¸‹ï¼Œå¯†é’¥ä»0å¼€å§‹ï¼Œä¸€ç›´è¯•åˆ°25ï¼Œå¾—åˆ°å¦‚ä¸‹æ•ˆæœï¼š</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="no">FKLQD</span> <span class="o">-&gt;</span> <span class="err">ç¬¬</span><span class="mi">0</span><span class="err">æ¬¡ç ´è§£</span> <span class="o">-&gt;</span> <span class="n">fklqd</span>
</span><span class='line'><span class="no">FKLQD</span> <span class="o">-&gt;</span> <span class="err">ç¬¬</span><span class="mi">1</span><span class="err">æ¬¡ç ´è§£</span> <span class="o">-&gt;</span> <span class="n">ejkpc</span>
</span><span class='line'><span class="no">FKLQD</span> <span class="o">-&gt;</span> <span class="err">ç¬¬</span><span class="mi">2</span><span class="err">æ¬¡ç ´è§£</span> <span class="o">-&gt;</span> <span class="n">dijob</span>
</span><span class='line'><span class="no">FKLQD</span> <span class="o">-&gt;</span> <span class="err">ç¬¬</span><span class="mi">3</span><span class="err">æ¬¡ç ´è§£</span> <span class="o">-&gt;</span> <span class="n">china</span>
</span><span class='line'><span class="no">FKLQD</span> <span class="o">-&gt;</span> <span class="err">ç¬¬</span><span class="mi">4</span><span class="err">æ¬¡ç ´è§£</span> <span class="o">-&gt;</span> <span class="n">bghmz</span>
</span><span class='line'><span class="no">FKLQD</span> <span class="o">-&gt;</span> <span class="err">ç¬¬</span><span class="mi">5</span><span class="err">æ¬¡ç ´è§£</span> <span class="o">-&gt;</span> <span class="n">afgly</span>
</span><span class='line'><span class="no">FKLQD</span> <span class="o">-&gt;</span> <span class="err">ç¬¬</span><span class="mi">6</span><span class="err">æ¬¡ç ´è§£</span> <span class="o">-&gt;</span> <span class="n">zefkx</span>
</span><span class='line'><span class="no">FKLQD</span> <span class="o">-&gt;</span> <span class="err">ç¬¬</span><span class="mi">7</span><span class="err">æ¬¡ç ´è§£</span> <span class="o">-&gt;</span> <span class="n">ydejw</span>
</span><span class='line'><span class="no">FKLQD</span> <span class="o">-&gt;</span> <span class="err">ç¬¬</span><span class="mi">8</span><span class="err">æ¬¡ç ´è§£</span> <span class="o">-&gt;</span> <span class="n">xcdiv</span>
</span><span class='line'><span class="no">FKLQD</span> <span class="o">-&gt;</span> <span class="err">ç¬¬</span><span class="mi">9</span><span class="err">æ¬¡ç ´è§£</span> <span class="o">-&gt;</span> <span class="n">wbchu</span>
</span><span class='line'><span class="no">FKLQD</span> <span class="o">-&gt;</span> <span class="err">ç¬¬</span><span class="mi">10</span><span class="err">æ¬¡ç ´è§£</span> <span class="o">-&gt;</span> <span class="n">vabgt</span>
</span><span class='line'><span class="no">FKLQD</span> <span class="o">-&gt;</span> <span class="err">ç¬¬</span><span class="mi">11</span><span class="err">æ¬¡ç ´è§£</span> <span class="o">-&gt;</span> <span class="n">uzafs</span>
</span><span class='line'><span class="no">FKLQD</span> <span class="o">-&gt;</span> <span class="err">ç¬¬</span><span class="mi">12</span><span class="err">æ¬¡ç ´è§£</span> <span class="o">-&gt;</span> <span class="n">tyzer</span>
</span><span class='line'><span class="no">FKLQD</span> <span class="o">-&gt;</span> <span class="err">ç¬¬</span><span class="mi">13</span><span class="err">æ¬¡ç ´è§£</span> <span class="o">-&gt;</span> <span class="n">sxydq</span>
</span><span class='line'><span class="no">FKLQD</span> <span class="o">-&gt;</span> <span class="err">ç¬¬</span><span class="mi">14</span><span class="err">æ¬¡ç ´è§£</span> <span class="o">-&gt;</span> <span class="n">rwxcp</span>
</span><span class='line'><span class="no">FKLQD</span> <span class="o">-&gt;</span> <span class="err">ç¬¬</span><span class="mi">15</span><span class="err">æ¬¡ç ´è§£</span> <span class="o">-&gt;</span> <span class="n">qvwbo</span>
</span><span class='line'><span class="no">FKLQD</span> <span class="o">-&gt;</span> <span class="err">ç¬¬</span><span class="mi">16</span><span class="err">æ¬¡ç ´è§£</span> <span class="o">-&gt;</span> <span class="n">puvan</span>
</span><span class='line'><span class="no">FKLQD</span> <span class="o">-&gt;</span> <span class="err">ç¬¬</span><span class="mi">17</span><span class="err">æ¬¡ç ´è§£</span> <span class="o">-&gt;</span> <span class="n">otuzm</span>
</span><span class='line'><span class="no">FKLQD</span> <span class="o">-&gt;</span> <span class="err">ç¬¬</span><span class="mi">18</span><span class="err">æ¬¡ç ´è§£</span> <span class="o">-&gt;</span> <span class="n">nstyl</span>
</span><span class='line'><span class="no">FKLQD</span> <span class="o">-&gt;</span> <span class="err">ç¬¬</span><span class="mi">19</span><span class="err">æ¬¡ç ´è§£</span> <span class="o">-&gt;</span> <span class="n">mrsxk</span>
</span><span class='line'><span class="no">FKLQD</span> <span class="o">-&gt;</span> <span class="err">ç¬¬</span><span class="mi">20</span><span class="err">æ¬¡ç ´è§£</span> <span class="o">-&gt;</span> <span class="n">lqrwj</span>
</span><span class='line'><span class="no">FKLQD</span> <span class="o">-&gt;</span> <span class="err">ç¬¬</span><span class="mi">21</span><span class="err">æ¬¡ç ´è§£</span> <span class="o">-&gt;</span> <span class="n">kpqvi</span>
</span><span class='line'><span class="no">FKLQD</span> <span class="o">-&gt;</span> <span class="err">ç¬¬</span><span class="mi">22</span><span class="err">æ¬¡ç ´è§£</span> <span class="o">-&gt;</span> <span class="n">jopuh</span>
</span><span class='line'><span class="no">FKLQD</span> <span class="o">-&gt;</span> <span class="err">ç¬¬</span><span class="mi">23</span><span class="err">æ¬¡ç ´è§£</span> <span class="o">-&gt;</span> <span class="n">inotg</span>
</span><span class='line'><span class="no">FKLQD</span> <span class="o">-&gt;</span> <span class="err">ç¬¬</span><span class="mi">24</span><span class="err">æ¬¡ç ´è§£</span> <span class="o">-&gt;</span> <span class="n">hmnsf</span>
</span><span class='line'><span class="no">FKLQD</span> <span class="o">-&gt;</span> <span class="err">ç¬¬</span><span class="mi">25</span><span class="err">æ¬¡ç ´è§£</span> <span class="o">-&gt;</span> <span class="n">glmre</span>
</span></code></pre></td></tr></table></div></figure>


<p>å¯ä»¥çŸ¥é“ï¼Œå…¶å®åœ¨è¯•åˆ°ç¬¬3æ¬¡çš„æ—¶å€™ï¼Œæ˜æ–‡å°±è¢«è¯•å‡ºæ¥äº†
ä»£ç å¯ä»¥å‚è€ƒè¿™é‡Œ
<a href="https://github.com/xuyao91/cryptography/blob/master/caesar/caesar.rb#L26">https://github.com/xuyao91/cryptography/blob/master/caesar/caesar.rb#L26</a></p>

<h3>è„šæœ¬ç¤ºä¾‹</h3>

<p>  æˆ‘ä»¬ç”¨è„šæœ¬è¯•ä¸€ä¸‹ä¸Šé¢æ‰€è¯´çš„å„ç§æ–¹æ³•ï¼Œè„šæœ¬ä»£ç åœ¨è¿™é‡Œ</p>

<p><a href="https://github.com/xuyao91/cryptography/blob/master/caesar/caesar.rb">https://github.com/xuyao91/cryptography/blob/master/caesar/caesar.rb</a></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1">#æ˜æ–‡æ˜¯ I am peter, I love chinaï¼Œ å¯†é’¥æ˜¯6</span>
</span><span class='line'><span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;iampeterxuilovechina&quot;</span>
</span><span class='line'><span class="n">caesar</span> <span class="o">=</span> <span class="no">Caesar</span><span class="o">.</span><span class="n">new</span> <span class="mi">6</span>
</span><span class='line'>
</span><span class='line'><span class="c1">#è°ƒç”¨encoderæ–¹æ³•åŠ å¯†å‡ºå¯†æ–‡</span>
</span><span class='line'><span class="n">cipher</span> <span class="o">=</span> <span class="n">caesar</span><span class="o">.</span><span class="n">encoder</span><span class="p">(</span><span class="n">message</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="no">OGSVKZKXDAORUBKINOTG</span>
</span><span class='line'>
</span><span class='line'><span class="c1">#è°ƒç”¨decoderæ–¹æ³•è§£å¯†å‡ºæ˜æ–‡</span>
</span><span class='line'><span class="n">caesar</span><span class="o">.</span><span class="n">decoder</span><span class="p">(</span><span class="n">cipher</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">iampeterxuilovechina</span>
</span><span class='line'>
</span><span class='line'><span class="c1">#æš´åŠ›ç ´è§£</span>
</span><span class='line'><span class="no">OGSVKZKXDAORUBKINOTG</span> <span class="o">-&gt;</span> <span class="err">ç¬¬</span><span class="mi">0</span><span class="err">æ¬¡ç ´è§£</span> <span class="o">-&gt;</span> <span class="n">ogsvkzkxdaorubkinotg</span>
</span><span class='line'><span class="no">OGSVKZKXDAORUBKINOTG</span> <span class="o">-&gt;</span> <span class="err">ç¬¬</span><span class="mi">1</span><span class="err">æ¬¡ç ´è§£</span> <span class="o">-&gt;</span> <span class="n">nfrujyjwcznqtajhmnsf</span>
</span><span class='line'><span class="no">OGSVKZKXDAORUBKINOTG</span> <span class="o">-&gt;</span> <span class="err">ç¬¬</span><span class="mi">2</span><span class="err">æ¬¡ç ´è§£</span> <span class="o">-&gt;</span> <span class="n">meqtixivbympsziglmre</span>
</span><span class='line'><span class="no">OGSVKZKXDAORUBKINOTG</span> <span class="o">-&gt;</span> <span class="err">ç¬¬</span><span class="mi">3</span><span class="err">æ¬¡ç ´è§£</span> <span class="o">-&gt;</span> <span class="n">ldpshwhuaxloryhfklqd</span>
</span><span class='line'><span class="no">OGSVKZKXDAORUBKINOTG</span> <span class="o">-&gt;</span> <span class="err">ç¬¬</span><span class="mi">4</span><span class="err">æ¬¡ç ´è§£</span> <span class="o">-&gt;</span> <span class="n">kcorgvgtzwknqxgejkpc</span>
</span><span class='line'><span class="no">OGSVKZKXDAORUBKINOTG</span> <span class="o">-&gt;</span> <span class="err">ç¬¬</span><span class="mi">5</span><span class="err">æ¬¡ç ´è§£</span> <span class="o">-&gt;</span> <span class="n">jbnqfufsyvjmpwfdijob</span>
</span><span class='line'><span class="no">OGSVKZKXDAORUBKINOTG</span> <span class="o">-&gt;</span> <span class="err">ç¬¬</span><span class="mi">6</span><span class="err">æ¬¡ç ´è§£</span> <span class="o">-&gt;</span> <span class="n">iampeterxuilovechina</span>
</span><span class='line'><span class="no">OGSVKZKXDAORUBKINOTG</span> <span class="o">-&gt;</span> <span class="err">ç¬¬</span><span class="mi">7</span><span class="err">æ¬¡ç ´è§£</span> <span class="o">-&gt;</span> <span class="n">hzlodsdqwthknudbghmz</span>
</span><span class='line'><span class="no">OGSVKZKXDAORUBKINOTG</span> <span class="o">-&gt;</span> <span class="err">ç¬¬</span><span class="mi">8</span><span class="err">æ¬¡ç ´è§£</span> <span class="o">-&gt;</span> <span class="n">gykncrcpvsgjmtcafgly</span>
</span><span class='line'><span class="no">OGSVKZKXDAORUBKINOTG</span> <span class="o">-&gt;</span> <span class="err">ç¬¬</span><span class="mi">9</span><span class="err">æ¬¡ç ´è§£</span> <span class="o">-&gt;</span> <span class="n">fxjmbqbourfilsbzefkx</span>
</span><span class='line'><span class="no">OGSVKZKXDAORUBKINOTG</span> <span class="o">-&gt;</span> <span class="err">ç¬¬</span><span class="mi">10</span><span class="err">æ¬¡ç ´è§£</span> <span class="o">-&gt;</span> <span class="n">ewilapantqehkraydejw</span>
</span><span class='line'><span class="no">OGSVKZKXDAORUBKINOTG</span> <span class="o">-&gt;</span> <span class="err">ç¬¬</span><span class="mi">11</span><span class="err">æ¬¡ç ´è§£</span> <span class="o">-&gt;</span> <span class="n">dvhkzozmspdgjqzxcdiv</span>
</span><span class='line'><span class="no">OGSVKZKXDAORUBKINOTG</span> <span class="o">-&gt;</span> <span class="err">ç¬¬</span><span class="mi">12</span><span class="err">æ¬¡ç ´è§£</span> <span class="o">-&gt;</span> <span class="n">cugjynylrocfipywbchu</span>
</span><span class='line'><span class="no">OGSVKZKXDAORUBKINOTG</span> <span class="o">-&gt;</span> <span class="err">ç¬¬</span><span class="mi">13</span><span class="err">æ¬¡ç ´è§£</span> <span class="o">-&gt;</span> <span class="n">btfixmxkqnbehoxvabgt</span>
</span><span class='line'><span class="no">OGSVKZKXDAORUBKINOTG</span> <span class="o">-&gt;</span> <span class="err">ç¬¬</span><span class="mi">14</span><span class="err">æ¬¡ç ´è§£</span> <span class="o">-&gt;</span> <span class="n">asehwlwjpmadgnwuzafs</span>
</span><span class='line'><span class="no">OGSVKZKXDAORUBKINOTG</span> <span class="o">-&gt;</span> <span class="err">ç¬¬</span><span class="mi">15</span><span class="err">æ¬¡ç ´è§£</span> <span class="o">-&gt;</span> <span class="n">zrdgvkviolzcfmvtyzer</span>
</span><span class='line'><span class="no">OGSVKZKXDAORUBKINOTG</span> <span class="o">-&gt;</span> <span class="err">ç¬¬</span><span class="mi">16</span><span class="err">æ¬¡ç ´è§£</span> <span class="o">-&gt;</span> <span class="n">yqcfujuhnkybelusxydq</span>
</span><span class='line'><span class="no">OGSVKZKXDAORUBKINOTG</span> <span class="o">-&gt;</span> <span class="err">ç¬¬</span><span class="mi">17</span><span class="err">æ¬¡ç ´è§£</span> <span class="o">-&gt;</span> <span class="n">xpbetitgmjxadktrwxcp</span>
</span><span class='line'><span class="no">OGSVKZKXDAORUBKINOTG</span> <span class="o">-&gt;</span> <span class="err">ç¬¬</span><span class="mi">18</span><span class="err">æ¬¡ç ´è§£</span> <span class="o">-&gt;</span> <span class="n">woadshsfliwzcjsqvwbo</span>
</span><span class='line'><span class="no">OGSVKZKXDAORUBKINOTG</span> <span class="o">-&gt;</span> <span class="err">ç¬¬</span><span class="mi">19</span><span class="err">æ¬¡ç ´è§£</span> <span class="o">-&gt;</span> <span class="n">vnzcrgrekhvybirpuvan</span>
</span><span class='line'><span class="no">OGSVKZKXDAORUBKINOTG</span> <span class="o">-&gt;</span> <span class="err">ç¬¬</span><span class="mi">20</span><span class="err">æ¬¡ç ´è§£</span> <span class="o">-&gt;</span> <span class="n">umybqfqdjguxahqotuzm</span>
</span><span class='line'><span class="no">OGSVKZKXDAORUBKINOTG</span> <span class="o">-&gt;</span> <span class="err">ç¬¬</span><span class="mi">21</span><span class="err">æ¬¡ç ´è§£</span> <span class="o">-&gt;</span> <span class="n">tlxapepciftwzgpnstyl</span>
</span><span class='line'><span class="no">OGSVKZKXDAORUBKINOTG</span> <span class="o">-&gt;</span> <span class="err">ç¬¬</span><span class="mi">22</span><span class="err">æ¬¡ç ´è§£</span> <span class="o">-&gt;</span> <span class="n">skwzodobhesvyfomrsxk</span>
</span><span class='line'><span class="no">OGSVKZKXDAORUBKINOTG</span> <span class="o">-&gt;</span> <span class="err">ç¬¬</span><span class="mi">23</span><span class="err">æ¬¡ç ´è§£</span> <span class="o">-&gt;</span> <span class="n">rjvyncnagdruxenlqrwj</span>
</span><span class='line'><span class="no">OGSVKZKXDAORUBKINOTG</span> <span class="o">-&gt;</span> <span class="err">ç¬¬</span><span class="mi">24</span><span class="err">æ¬¡ç ´è§£</span> <span class="o">-&gt;</span> <span class="n">qiuxmbmzfcqtwdmkpqvi</span>
</span><span class='line'><span class="no">OGSVKZKXDAORUBKINOTG</span> <span class="o">-&gt;</span> <span class="err">ç¬¬</span><span class="mi">25</span><span class="err">æ¬¡ç ´è§£</span> <span class="o">-&gt;</span> <span class="n">phtwlalyebpsvcljopuh</span>
</span></code></pre></td></tr></table></div></figure>


<p>å¯ä»¥çŸ¥é“ï¼Œç§»ä½å¯†ç å…¶å®æ˜¯å¾ˆå¼±çš„ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“å°†ä»–ç ´è§£å‡ºæ¥ï¼Œä½†æ˜¯åœ¨å¤ä»£é‚£ä¼šè¿˜æ˜¯æŒºæœ‰ç”¨çš„ã€‚</p>

<h3>å‚è€ƒèµ„æ–™</h3>

<p>ã€å¯†ç å­¦åŸç†ä¸å®è·µï¼ˆç¬¬ä¸‰ç‰ˆï¼‰ã€‘</p>

<p>ã€å›¾è§£å¯†ç æŠ€æœ¯ã€‘</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[å¦‚ä½•ç†è§£RESTful]]></title>
    <link href="http://xuyao.club/blog/2018/03/12/how-to-understand-the-restful-router/"/>
    <updated>2018-03-12T11:07:56+08:00</updated>
    <id>http://xuyao.club/blog/2018/03/12/how-to-understand-the-restful-router</id>
    <content type="html"><![CDATA[<h3>ä»€ä¹ˆæ˜¯REST</h3>

<p>&emsp;&emsp;RESTçš„å…¨ç§°æ˜¯ï¼šRepresentational State Transfer,ç›´æ¥ç¿»è¯‘è¿‡æ¥å°±æ˜¯ï¼šè¡¨ç°å±‚çŠ¶æ€è½¬ç§»ï¼Œè¡¨ç°å±‚çš„æ„æ€å°±æ˜¯èµ„æº, è¿™ä¸ªè¯è¯­è¯»ç€æ¯”è¾ƒéš¾ç†è§£ï¼Œç½‘ä¸Šæœ‰ä¸€ç§å«æ³•æ¯”è¾ƒå®¹æ˜“ç†è§£ï¼Œå«ï¼šURLå®šä½èµ„æºï¼Œç”¨HTTPåŠ¨è¯ï¼ˆGET,POST,PUT,DELETEï¼‰æè¿°æ“ä½œã€‚å¾ˆç®€æ´ï¼Œå°±æ˜¯çœ‹urlå°±çŸ¥é“è¿™ä¸ªè·¯ç”±æ˜¯ä»€ä¹ˆäº†ï¼Œç„¶åçœ‹httpçš„åŠ¨è¯methodå°±æ˜ç™½è¦åšä»€ä¹ˆäº†ï¼Œæœ€åçœ‹ä»–çš„ status codeå°±çŸ¥é“è¿”å›ç»“æœäº†ã€‚RESTæœ€å¤§çš„å‡ ä¸ªç‰¹ç‚¹ä¸ºï¼šèµ„æºã€ç»Ÿä¸€æ¥å£ã€URIå’Œæ— çŠ¶æ€ã€‚</p>

<h3>RESTfulæ¶æ„</h3>

<p>&emsp;&emsp;RESTful æ˜¯ç°åœ¨æ¯”è¾ƒæµè¡Œçš„ä¸€ç§è®¾è®¡é£æ ¼ï¼Œå®ƒæä¾›äº†ä¸€ç»„è®¾è®¡åŸåˆ™å’Œçº¦æŸæ¡ä»¶ï¼Œä¸»è¦ç”¨äºå®¢æˆ·ç«¯ä¸æœåŠ¡å™¨çš„äº¤äº’ã€‚RESTfulæ¶æ„æ›´ç®€æ´ï¼Œæ›´æœ‰å±‚æ¬¡ï¼Œæ›´æ˜“äºå®ç°ç¼“å­˜ç­‰æœºåˆ¶ã€‚<br/>
&emsp;&emsp;è®°å¾—åˆšå·¥ä½œé‚£ä¼šï¼Œä»£ç å†™çš„æ¯”è¾ƒçƒ‚ï¼Œæ¯”å¦‚è¯´è¦å†™å¢åŠ å•†å“çš„è·¯ç”±ï¼Œä¼šå†™æˆä¸‹é¢è¿™æ ·,ä»RESTfulè§’åº¦æ¥è¯´ï¼Œè¿™æ ·å†™å…¶å®å·²ç»è¿èƒŒäº†ä»–ç»Ÿä¸€æ¥å£å’Œå¯¹URIçš„æ„ä¹‰çš„åŸåˆ™</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="no">POST</span> <span class="sr">/create_product</span>
</span></code></pre></td></tr></table></div></figure>


<!-- more -->


<p></p>

<ul>
<li>é¦–å…ˆURIä¸Šæœ€å¥½ä¸è¦æœ‰create,pudate,getç­‰è¿™ç§åŠ¨è¯ï¼ŒURIä¸Šåªè¦æè¿°ä»–æ˜¯ä»€ä¹ˆä¸œè¥¿å°±è¡Œäº†ï¼Œä¸”ä»¥å¤æ•°æœ€å¥½å§ï¼Œæ¯”å¦‚è¯´products,users,ordersç­‰ç­‰</li>
<li>å¦‚æœæ¥å£æ˜¯å¢åŠ ï¼Œåˆ é™¤ï¼Œæ›´æ–°ç­‰æ“ä½œå¯ä»¥åœ¨è¯·æ±‚æ–¹å¼ä¸Šæ¥è¡¨ç°ï¼Œå¸¸è§çš„æœ‰ä»¥ä¸‹è¿™äº›ï¼š<br/>
GET &emsp;&emsp;     ->è·å–ä¸€ä¸ªèµ„æº <br/>
POST &emsp;&emsp;    ->æ·»åŠ ä¸€ä¸ªèµ„æº <br/>
PUT &emsp;&emsp;     ->ä¿®æ”¹ä¸€ä¸ªèµ„æº <br/>
DELETE &emsp;&emsp;  ->åˆ é™¤ä¸€ä¸ªèµ„æº <br/>
æ¯”å¦‚è¯´è¦å¢åŠ ä¸€ä¸ªå•†å“ï¼Œå¯ä»¥å†™æˆè¿™æ ·</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1">#TODO å¢åŠ å•†å“</span>
</span><span class='line'><span class="no">POST</span> <span class="sr">/products</span>
</span><span class='line'>
</span><span class='line'><span class="sr">#TODO è·å–å•†å“åˆ—è¡¨</span>
</span><span class='line'><span class="sr">GET /</span><span class="n">products</span>
</span><span class='line'>
</span><span class='line'><span class="c1">#TODO è·å–æŸä¸ªå•ä¸ªå•†å“</span>
</span><span class='line'><span class="no">GET</span> <span class="sr">/products/</span><span class="mi">1</span>
</span><span class='line'>
</span><span class='line'><span class="c1">#TODO æ›´æ–°æŸä¸ªå•†å“</span>
</span><span class='line'><span class="no">PUT</span> <span class="sr">/products/</span><span class="mi">1</span>
</span><span class='line'>
</span><span class='line'><span class="c1">#TODO åˆ é™¤æŸä¸ªå•†å“</span>
</span><span class='line'><span class="no">DELETE</span> <span class="sr">/products/</span><span class="mi">1</span>
</span></code></pre></td></tr></table></div></figure>


<p> <br/>
ä¸Šé¢è¿™æ ·å†™æ˜æ˜¾å¾ˆç®€æ´ï¼Œè™½ç„¶æœ‰äº›URIæ˜¯ç›¸åŒçš„ï¼Œä½†å¹¶ä¸ä¼šå­˜åœ¨æ­§ä¹‰ï¼Œä½ åªè¦çœ‹ä»–çš„http methodå°±çŸ¥é“æ˜¯åšä»€ä¹ˆæ“ä½œçš„äº†ï¼Œè€Œä¸”è¿™æ ·æ˜æ˜¾æ›´æœ‰å±‚æ¬¡æ„Ÿï¼Œå¦‚æœæ˜¯åµŒå¥—è·¯ç”±çš„è¯ï¼Œå±‚æ¬¡æ„Ÿå°±æ›´æ˜æ˜¾äº†ã€‚<br/>
ä»¥ä¸Šæ˜¯ä¸€äº›äººä¸ªè§è§£ï¼Œä¸‹é¢æ˜¯ç½‘ä¸Šæ‘˜æ¥çš„ä¸€äº›æ¯”è¾ƒä¸“ä¸šçš„è¿°è¯­</p>

<h3>RESTfulè¯¦è§£</h3>

<h4>1.1 èµ„æºä¸URI</h4>

<p>è¿™é‡Œä»¥githubç½‘ç«™ä¸ºä¾‹ï¼Œç»™å‡ºä¸€äº›è¿˜ç®—ä¸é”™çš„URIï¼š</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="ss">https</span><span class="p">:</span><span class="sr">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">git</span>
</span><span class='line'><span class="ss">https</span><span class="p">:</span><span class="sr">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">git</span><span class="o">/</span><span class="n">git</span><span class="o">/</span><span class="n">blob</span><span class="o">/</span><span class="n">master</span><span class="o">/</span><span class="n">block</span><span class="o">-</span><span class="n">sha1</span><span class="o">/</span><span class="n">sha1</span><span class="o">.</span><span class="n">h</span>
</span><span class='line'><span class="ss">https</span><span class="p">:</span><span class="sr">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">git</span><span class="o">/</span><span class="n">git</span><span class="o">/</span><span class="n">pulls</span>
</span><span class='line'><span class="ss">https</span><span class="p">:</span><span class="sr">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">git</span><span class="o">/</span><span class="n">git</span><span class="o">/</span><span class="n">pulls?state</span><span class="o">=</span><span class="n">closed</span>
</span></code></pre></td></tr></table></div></figure>


<p>å…³äºURIè®¾è®¡æŠ€å·§:</p>

<ul>
<li>ä½¿ç”¨ _ æˆ– - æ¥è®©URIå¯è¯»æ€§æ›´å¥½ï¼Œä¾‹å¦‚<a href="http://www.github.com/blog/translate-reward-plan%E3%80%82">http://www.github.com/blog/translate-reward-plan%E3%80%82</a></li>
<li>ä½¿ç”¨ / æ¥è¡¨ç¤ºèµ„æºçš„å±‚çº§å…³ç³»ï¼Œä¾‹å¦‚ä¸Šé¢çš„/git/git/blob/master/block-sha1/sha1.h</li>
<li>ä½¿ç”¨ ? ç”¨æ¥è¿‡æ»¤èµ„æºï¼Œä¾‹å¦‚/git/pulls?state=closedç”¨æ¥è¡¨ç¤ºgité¡¹ç›®çš„æ‰€æœ‰æ¨å…¥è¯·æ±‚ä¸­å·²ç»å…³é—­çš„è¯·æ±‚ã€‚</li>
<li>ä½¿ç”¨,æˆ–;è¡¨ç¤ºåŒçº§èµ„æºå…³ç³»ï¼Œä¾‹å¦‚/git/sha1/compare/ef7b53d18;bd638e8c1</li>
</ul>


<h4>1.2 ç»Ÿä¸€èµ„æºæ¥å£</h4>

<p>RESTfulæ¶æ„åº”è¯¥éµå¾ªç»Ÿä¸€æ¥å£åŸåˆ™ï¼Œç»Ÿä¸€æ¥å£åŒ…å«äº†ä¸€ç»„å—é™çš„é¢„å®šä¹‰çš„æ“ä½œï¼Œæ‰€æœ‰èµ„æºçš„è®¿é—®æ¥å£åº”è¯¥ä½¿ç”¨æ ‡å‡†çš„HTTPæ–¹æ³•å¦‚GETï¼ŒPUTï¼ŒPOSTï¼ŒDELETEï¼Œå¹¶éµå¾ªè¿™äº›æ–¹æ³•çš„è¯­ä¹‰ã€‚</p>

<p>å¦‚æœæŒ‰ç…§HTTPæ–¹æ³•çš„è¯­ä¹‰æ¥æš´éœ²èµ„æºï¼Œé‚£ä¹ˆæ¥å£å°†ä¼šæ‹¥æœ‰å®‰å…¨æ€§å’Œå¹‚ç­‰æ€§çš„ç‰¹æ€§ï¼Œä¾‹å¦‚GETå’ŒHEADè¯·æ±‚éƒ½æ˜¯å®‰å…¨çš„ï¼Œ æ— è®ºè¯·æ±‚å¤šå°‘æ¬¡ï¼Œéƒ½ä¸ä¼šæ”¹å˜æœåŠ¡å™¨çŠ¶æ€ã€‚è€ŒGETã€HEADã€PUTå’ŒDELETEè¯·æ±‚éƒ½æ˜¯å¹‚ç­‰çš„ï¼Œæ— è®ºå¯¹èµ„æºæ“ä½œå¤šå°‘æ¬¡ï¼Œ ç»“æœæ€»æ˜¯ä¸€æ ·çš„ï¼Œåé¢çš„è¯·æ±‚å¹¶ä¸ä¼šäº§ç”Ÿæ¯”ç¬¬ä¸€æ¬¡æ›´å¤šçš„å½±å“ã€‚
ä¸‹é¢åˆ—å‡ºäº†GETï¼ŒDELETEï¼ŒPUTå’ŒPOSTçš„å…¸å‹ç”¨æ³•:</p>

<h6>GET</h6>

<p>&emsp;&emsp;å®‰å…¨ä¸”å¹‚ç­‰ è·å–è¡¨ç¤º å˜æ›´æ—¶è·å–è¡¨ç¤ºï¼ˆç¼“å­˜ï¼‰ 200ï¼ˆOKï¼‰ - è¡¨ç¤ºå·²åœ¨å“åº”ä¸­å‘å‡º 204ï¼ˆæ— å†…å®¹ï¼‰ - èµ„æºæœ‰ç©ºè¡¨ç¤º 301ï¼ˆMoved Permanentlyï¼‰ - èµ„æºçš„URIå·²è¢«æ›´æ–° 303ï¼ˆSee Otherï¼‰ - å…¶ä»–ï¼ˆå¦‚ï¼Œè´Ÿè½½å‡è¡¡ï¼‰ 304ï¼ˆnot modifiedï¼‰- èµ„æºæœªæ›´æ”¹ï¼ˆç¼“å­˜ï¼‰ 400 ï¼ˆbad requestï¼‰- æŒ‡ä»£åè¯·æ±‚ï¼ˆå¦‚ï¼Œå‚æ•°é”™è¯¯ï¼‰ 404 ï¼ˆnot foundï¼‰- èµ„æºä¸å­˜åœ¨ 406 ï¼ˆnot acceptableï¼‰- æœåŠ¡ç«¯ä¸æ”¯æŒæ‰€éœ€è¡¨ç¤º 500 ï¼ˆinternal server errorï¼‰- é€šç”¨é”™è¯¯å“åº” 503 ï¼ˆService Unavailableï¼‰- æœåŠ¡ç«¯å½“å‰æ— æ³•å¤„ç†è¯·æ±‚</p>

<h5>POST</h5>

<p>&emsp;&emsp;ä¸å®‰å…¨ä¸”ä¸å¹‚ç­‰ ä½¿ç”¨æœåŠ¡ç«¯ç®¡ç†çš„ï¼ˆè‡ªåŠ¨äº§ç”Ÿï¼‰çš„å®ä¾‹å·åˆ›å»ºèµ„æº åˆ›å»ºå­èµ„æº éƒ¨åˆ†æ›´æ–°èµ„æº å¦‚æœæ²¡æœ‰è¢«ä¿®æ”¹ï¼Œåˆ™ä¸è¿‡æ›´æ–°èµ„æºï¼ˆä¹è§‚é”ï¼‰ 200ï¼ˆOKï¼‰- å¦‚æœç°æœ‰èµ„æºå·²è¢«æ›´æ”¹ 201ï¼ˆcreatedï¼‰- å¦‚æœæ–°èµ„æºè¢«åˆ›å»º 202ï¼ˆacceptedï¼‰- å·²æ¥å—å¤„ç†è¯·æ±‚ä½†å°šæœªå®Œæˆï¼ˆå¼‚æ­¥å¤„ç†ï¼‰ 301ï¼ˆMoved Permanentlyï¼‰- èµ„æºçš„URIè¢«æ›´æ–° 303ï¼ˆSee Otherï¼‰- å…¶ä»–ï¼ˆå¦‚ï¼Œè´Ÿè½½å‡è¡¡ï¼‰ 400ï¼ˆbad requestï¼‰- æŒ‡ä»£åè¯·æ±‚ 404 ï¼ˆnot foundï¼‰- èµ„æºä¸å­˜åœ¨ 406 ï¼ˆnot acceptableï¼‰- æœåŠ¡ç«¯ä¸æ”¯æŒæ‰€éœ€è¡¨ç¤º 409 ï¼ˆconflictï¼‰- é€šç”¨å†²çª 412 ï¼ˆPrecondition Failedï¼‰- å‰ç½®æ¡ä»¶å¤±è´¥ï¼ˆå¦‚æ‰§è¡Œæ¡ä»¶æ›´æ–°æ—¶çš„å†²çªï¼‰ 415 ï¼ˆunsupported media typeï¼‰- æ¥å—åˆ°çš„è¡¨ç¤ºä¸å—æ”¯æŒ 500 ï¼ˆinternal server errorï¼‰- é€šç”¨é”™è¯¯å“åº” 503 ï¼ˆService Unavailableï¼‰- æœåŠ¡å½“å‰æ— æ³•å¤„ç†è¯·æ±‚</p>

<h5>PUT</h5>

<p>&emsp;&emsp;ä¸å®‰å…¨ä½†å¹‚ç­‰ ç”¨å®¢æˆ·ç«¯ç®¡ç†çš„å®ä¾‹å·åˆ›å»ºä¸€ä¸ªèµ„æº é€šè¿‡æ›¿æ¢çš„æ–¹å¼æ›´æ–°èµ„æº å¦‚æœæœªè¢«ä¿®æ”¹ï¼Œåˆ™æ›´æ–°èµ„æºï¼ˆä¹è§‚é”ï¼‰ 200 ï¼ˆOKï¼‰- å¦‚æœå·²å­˜åœ¨èµ„æºè¢«æ›´æ”¹ 201 ï¼ˆcreatedï¼‰- å¦‚æœæ–°èµ„æºè¢«åˆ›å»º 301ï¼ˆMoved Permanentlyï¼‰- èµ„æºçš„URIå·²æ›´æ”¹ 303 ï¼ˆSee Otherï¼‰- å…¶ä»–ï¼ˆå¦‚ï¼Œè´Ÿè½½å‡è¡¡ ï¼‰ 400 ï¼ˆbad requestï¼‰- æŒ‡ä»£åè¯·æ±‚ 404 ï¼ˆnot foundï¼‰- èµ„æºä¸å­˜åœ¨ 406 ï¼ˆnot acceptableï¼‰- æœåŠ¡ç«¯ä¸æ”¯æŒæ‰€éœ€è¡¨ç¤º 409 ï¼ˆconflictï¼‰- é€šç”¨å†²çª 412 ï¼ˆPrecondition Failedï¼‰- å‰ç½®æ¡ä»¶å¤±è´¥ï¼ˆå¦‚æ‰§è¡Œæ¡ä»¶æ›´æ–°æ—¶çš„å†²çªï¼‰ 415 ï¼ˆunsupported media typeï¼‰- æ¥å—åˆ°çš„è¡¨ç¤ºä¸å—æ”¯æŒ 500 ï¼ˆinternal server errorï¼‰- é€šç”¨é”™è¯¯å“åº” 503 ï¼ˆService Unavailableï¼‰- æœåŠ¡å½“å‰æ— æ³•å¤„ç†è¯·æ±‚</p>

<h5>DELETE</h5>

<p>&emsp;&emsp;ä¸å®‰å…¨ä½†å¹‚ç­‰ åˆ é™¤èµ„æº 200 ï¼ˆOKï¼‰- èµ„æºå·²è¢«åˆ é™¤ 301 ï¼ˆMoved Permanentlyï¼‰- èµ„æºçš„URIå·²æ›´æ”¹ 303 ï¼ˆSee Otherï¼‰- å…¶ä»–ï¼Œå¦‚è´Ÿè½½å‡è¡¡ 400 ï¼ˆbad requestï¼‰- æŒ‡ä»£åè¯·æ±‚ 404 ï¼ˆnot foundï¼‰- èµ„æºä¸å­˜åœ¨ 409 ï¼ˆconflictï¼‰- é€šç”¨å†²çª 500 ï¼ˆinternal server errorï¼‰- é€šç”¨é”™è¯¯å“åº” 503 ï¼ˆService Unavailableï¼‰- æœåŠ¡ç«¯å½“å‰æ— æ³•å¤„ç†è¯·æ±‚</p>

<p>&emsp;&emsp;æ¥ä¸‹æ¥å†æŒ‰ä¸€äº›å®è·µä¸­çš„å¸¸è§é—®é¢˜
POSTå’ŒPUTåœ¨åˆ›å»ºèµ„æºçš„åŒºåˆ«ï¼šæ‰€åˆ›å»ºçš„èµ„æºçš„åç§°(URI)æ˜¯å¦ç”±å®¢æˆ·ç«¯å†³å®šã€‚ ä¾‹å¦‚ä¸ºä¸ºåšå®¢å¢åŠ ä¸€ä¸ªandroidçš„åˆ†ç±»ï¼Œç”Ÿæˆçš„è·¯å¾„å°±æ˜¯åˆ†ç±»å/categories/androidï¼Œé‚£ä¹ˆå°±å¯ä»¥é‡‡ç”¨PUTæ–¹æ³•ã€‚
å®¢æˆ·ç«¯ä¸ä¸€å®šéƒ½æ”¯æŒè¿™äº›HTTPæ–¹æ³•ï¼šè¾ƒå¤è€çš„åŸºäºæµè§ˆå™¨çš„å®¢æˆ·ç«¯ï¼Œåªèƒ½æ”¯æŒGETå’ŒPOSTä¸¤ç§æ–¹æ³•ã€‚å¦¥åçš„è§£å†³æ–¹æ³•ï¼Œé€šè¿‡éšè—å‚æ•°_method=DELETEæ¥ä¼ é€’çœŸå®çš„è¯·æ±‚æ–¹æ³•ç­‰æªæ–½æ¥è§„é¿ã€‚
ç»Ÿä¸€èµ„æºæ¥å£å¯¹URIçš„æ„ä¹‰ï¼šç»Ÿä¸€èµ„æºæ¥å£è¦æ±‚ä½¿ç”¨æ ‡å‡†çš„HTTPæ–¹æ³•å¯¹èµ„æºè¿›è¡Œæ“ä½œï¼Œæ‰€ä»¥URIåªåº”è¯¥æ¥è¡¨ç¤ºèµ„æºçš„åç§°ï¼Œè€Œä¸åº”è¯¥åŒ…æ‹¬èµ„æºçš„æ“ä½œï¼Œå¦‚ä¸‹æ˜¯ä¸€äº›ä¸ç¬¦åˆç»Ÿä¸€æ¥å£è¦æ±‚çš„URI:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="no">GET</span> <span class="sr">/getUser/</span><span class="mi">1</span>
</span><span class='line'><span class="no">POST</span> <span class="sr">/createUser  </span>
</span><span class='line'><span class="sr">PUT /u</span><span class="n">pdateUser</span><span class="o">/</span><span class="mi">1</span>
</span><span class='line'><span class="no">DELETE</span> <span class="sr">/deleteUser/</span><span class="mi">1</span>
</span><span class='line'><span class="err">æ­£ç¡®å†™æ³•åº”è¯¥æ˜¯</span> <span class="sr">/User/</span><span class="mi">1</span>
</span></code></pre></td></tr></table></div></figure>


<p>ä¸åº”è¯¥åŒ…å«åŠ¨è¯ï¼Œå…·ä½“çš„åŠ¨ä½œç”±è¯·æ±‚æ–¹æ³•æ¥ä½“ç°ã€‚</p>

<h5>1.3 èµ„æºçš„è¡¨è¿°</h5>

<p>&emsp;&emsp;èµ„æºçš„è¡¨è¿°æ˜¯æŒ‡å¯¹èµ„æºåœ¨ç‰¹å®šæ—¶åˆ»çš„çŠ¶æ€çš„æè¿°ï¼Œå®¢æˆ·ç«¯é€šè¿‡HTTPæ–¹æ³•å¯ä»¥è·å–èµ„æºï¼Œæ›´å‡†ç¡®è¯´æ˜¯èµ„æºçš„è¡¨è¿°è€Œå·²ã€‚ èµ„æºåœ¨å¤–ç•Œçš„å…·ä½“å‘ˆç°ï¼Œå¯ä»¥æœ‰å¤šç§è¡¨è¿°å½¢å¼ï¼Œåœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ä¹‹é—´ä¼ é€çš„ä¹Ÿæ˜¯èµ„æºçš„è¡¨è¿°ï¼Œè€Œä¸æ˜¯èµ„æºæœ¬èº«ã€‚ ä¾‹å¦‚æ–‡æœ¬èµ„æºå¯ä»¥é‡‡ç”¨htmlã€xmlã€jsonç­‰æ ¼å¼ï¼Œå›¾ç‰‡å¯ä»¥ä½¿ç”¨PNGæˆ–JPGå±•ç°å‡ºæ¥ã€‚</p>

<p>&emsp;&emsp;èµ„æºçš„è¡¨è¿°åŒ…æ‹¬æ•°æ®å’Œæè¿°æ•°æ®çš„å…ƒæ•°æ®ï¼Œä¾‹å¦‚ï¼ŒHTTPå¤´â€Content-Typeâ€ å°±æ˜¯è¿™æ ·ä¸€ä¸ªå…ƒæ•°æ®å±æ€§ã€‚é€šè¿‡HTTPå†…å®¹åå•†ï¼Œå®¢æˆ·ç«¯å¯ä»¥é€šè¿‡Acceptå¤´è¯·æ±‚ä¸€ç§ç‰¹å®šæ ¼å¼çš„è¡¨è¿°ï¼ŒæœåŠ¡ç«¯åˆ™é€šè¿‡Content-Typeå‘Šè¯‰å®¢æˆ·ç«¯èµ„æºçš„è¡¨è¿°å½¢å¼ã€‚</p>

<h5>1.4 èµ„æºçš„é“¾æ¥</h5>

<p>&emsp;&emsp;RESTæ˜¯ä½¿ç”¨æ ‡å‡†çš„HTTPæ–¹æ³•æ¥æ“ä½œèµ„æºçš„ï¼Œä½†ä»…ä»…å› æ­¤å°±ç†è§£æˆå¸¦CURDçš„Webæ•°æ®åº“æ¶æ„å°±å¤ªè¿‡äºç®€å•äº†ã€‚è¿™ç§åæ¨¡å¼å¿½ç•¥äº†ä¸€ä¸ªæ ¸å¿ƒæ¦‚å¿µï¼šâ€è¶…åª’ä½“å³åº”ç”¨çŠ¶æ€å¼•æ“â€ã€‚ è¶…åª’ä½“æ˜¯ä»€ä¹ˆ?å½“ä½ æµè§ˆWebç½‘é¡µæ—¶ï¼Œä»ä¸€ä¸ªè¿æ¥è·³åˆ°ä¸€ä¸ªé¡µé¢ï¼Œå†ä»å¦ä¸€ä¸ªè¿æ¥è·³åˆ°å¦å¤–ä¸€ä¸ªé¡µé¢ï¼Œå°±æ˜¯åˆ©ç”¨äº†è¶…åª’ä½“çš„æ¦‚å¿µï¼šæŠŠä¸€ä¸ªä¸ªæŠŠèµ„æºé“¾æ¥èµ·æ¥.
&emsp;&emsp;è¦è¾¾åˆ°è¿™ä¸ªç›®çš„ï¼Œå°±è¦æ±‚åœ¨è¡¨è¿°æ ¼å¼é‡Œè¾¹åŠ å…¥é“¾æ¥æ¥å¼•å¯¼å®¢æˆ·ç«¯ã€‚åœ¨ã€ŠRESTful Web Servicesã€‹ä¸€ä¹¦ä¸­ï¼Œä½œè€…æŠŠè¿™ç§å…·æœ‰é“¾æ¥çš„ç‰¹æ€§æˆä¸ºè¿é€šæ€§ã€‚ä¸‹é¢æˆ‘ä»¬å…·ä½“æ¥çœ‹ä¸€äº›ä¾‹å­ã€‚</p>

<h5>1.5 çŠ¶æ€çš„è½¬ç§»</h5>

<p>&emsp;&emsp;RESTåŸåˆ™ä¸­çš„æ— çŠ¶æ€é€šä¿¡åŸåˆ™ï¼Œå¹¶ä¸æ˜¯è¯´å®¢æˆ·ç«¯åº”ç”¨ä¸èƒ½æœ‰çŠ¶æ€ï¼Œè€Œæ˜¯æŒ‡æœåŠ¡ç«¯ä¸åº”è¯¥ä¿å­˜å®¢æˆ·ç«¯çŠ¶æ€ã€‚</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[2017å¹´è€ƒç ”è®°]]></title>
    <link href="http://xuyao.club/blog/2018/01/09/about-pg-entrance-exam/"/>
    <updated>2018-01-09T16:10:41+08:00</updated>
    <id>http://xuyao.club/blog/2018/01/09/about-pg-entrance-exam</id>
    <content type="html"><![CDATA[<h3>å‰è¨€</h3>

<p>&emsp;&emsp;17å¹´ä¸ŠåŠå¹´ï¼Œä¸ºäº†å‡‘ä¸ªé¦–ä»˜ï¼Œä¸¤äººæ­ä¸Šäº†å‡ å¹´çš„æ‰€æœ‰ç§¯è“„ï¼Œè¿˜æ‰¾äº²æœ‹å¥½å‹å€Ÿäº†ä¸€å †ï¼Œå¹³å¸¸å°±ä¸å¤ªå–œæ¬¢æ‰¾äººå€Ÿé’±ï¼Œè„¸çš®è–„ï¼Œå¼€ä¸äº†å£ï¼Œè¿™æ¬¡æ²¡åŠæ³•ï¼Œæ€¥ç”¨é’±ã€‚å€Ÿé’±è¿˜ç®—é¡ºåˆ©ï¼Œé™¤äº†å‡ ä¸ªå§å§ä¸»åŠ¨å€Ÿç»™æˆ‘çš„ï¼Œè·ŸåŒå­¦å€Ÿçš„ä¹Ÿéƒ½ç»™äº†ï¼Œä¹‹å‰ä¹Ÿå€Ÿè¿‡ä»–ä»¬ï¼Œæ‰€ä»¥å€Ÿçš„æ¯”è¾ƒé¡ºåˆ©ã€‚é‚£å¤©åˆ·å¡æ—¶æ²¡å¤ªå¤šçŸ¥è§‰ï¼Œè·Ÿå¾€å¸¸ä¹°è¡£æœåˆ·å¡ä¸€æ ·ï¼Œåªæ˜¯å¤šç­¾äº†å‡ æ¬¡å­—ï¼Œäº‹åæƒ³æƒ³æŒºå¿ƒç—›ï¼Œä¸¤ä¸ªäººå‡ å¹´çš„å­˜æ¬¾å¤–åŠ å€Ÿçš„å€ºå°±è¿™æ ·è½»æ¾çš„åˆ’èµ°äº†ï¼Œæ¢æ¥äº†ä¸€æœ¬åˆåŒã€‚<br/>
&emsp;&emsp;å¶å°”ä¹Ÿæ„Ÿæ…¨ï¼Œç”Ÿæ´»å°±åƒä¸€å¼ ç™½çº¸ï¼Œèƒ½ç”»å‡ºä»€ä¹ˆå¥½çœ‹çš„ä¸œè¥¿ï¼Œå€¼ä¸å€¼é’±ï¼Œå…¨å‡­ä½ è‡ªå·±ã€‚å›é¡¾è¿™å‡ å¹´çš„å·¥ä½œï¼Œç”Ÿæ´»ç»å†ï¼Œè™½ç„¶ä¹Ÿæœ‰ä¸€äº›å°å¹…çš„è¿›æ­¥ï¼Œä½†å¹¶æ²¡æœ‰ä»æ ¹æœ¬ä¸Šæ”¹å˜ä»€ä¹ˆï¼Œåªæ˜¯å·¥ä½œç»éªŒå¤šäº†å‡ å¹´è€Œå·²ã€‚å¤šè¯»äº†å‡ æœ¬ä¹¦åï¼Œå‘ç°è‡ªå·±çš„èƒ½åŠ›è¿˜æ˜¯æ’‘ä¸èµ·æ¢¦æƒ³ï¼Œç”Ÿæ´»åœ¨é­”éƒ½ï¼Œæ¯ä¸ªäººéƒ½ä¸ç¼ºæ¢¦æƒ³ï¼Œæ¢¦æƒ³ä¹Ÿå€¼ä¸äº†é’±ã€‚</p>

<!-- more -->


<p>&emsp;&emsp;å¹´åˆçš„æ—¶å€™å°±ç»™è‡ªå·±å®šè¿‡ä¸€ä¸ªè®¡åˆ’ï¼Œæš‚ä¸”å«ä»–â€œä¸‰ä¸‰è®¡åˆ’â€ï¼Œå¤§æ¦‚æ„æ€å°±æ˜¯ä»¥æ¯ä¸‰å¹´ä¸ºä¸€ä¸ªå•ä½é˜¶æ®µï¼Œæ¯ä¸ªé˜¶æ®µéƒ½æœ‰éœ€è¦å®ç°çš„å¤§ç›®æ ‡ï¼Œæ¯ä¸ªå¤§ç›®æ ‡å†åˆ’åˆ†æˆæ¯å¹´çš„å°ç›®æ ‡ï¼Œæ¯å¹´éœ€è¦å®Œæˆè¿™äº›å°ç›®æ ‡ï¼Œå°ç›®æ ‡ç§¯ä¹…äº†å°±æ˜¯å¤§ç›®æ ‡ï¼Œé‡å˜æ€»ä¼šæœ‰ç‚¹è´¨å˜ï¼Œè®¾å®šä¸‰ä¸ªä¸‰å¹´ï¼Œä¹Ÿå°±æ˜¯ä¹å¹´çš„æ—¶é—´ï¼Œä¹å¹´æ—¶é—´ï¼Œæˆ‘è¦å®Œæˆä¸‰ä¸ªå¤§ç›®æ ‡ï¼Œè·Ÿæˆ‘å…šçš„ç™¾å¹´å¤§è®¡ä¸€æ ·ï¼Œä»Šå¹´æ˜¯ç¬¬åä¸‰ä¸ªäº”å¹´ã€‚<br/>
&emsp;&emsp;å½“ç„¶å¹¶ä¸æ˜¯ä¸€å¼€å§‹å°±æƒ³å¥½äº†ï¼Œä¸€ä¸‰ï¼ŒäºŒä¸‰ï¼Œä¸‰ä¸‰çš„å…¨éƒ¨ç›®æ ‡ï¼Œè€Œæ˜¯æ ¹æ®æ¯ä¸ªé˜¶æ®µå®Œæˆçš„ç›®æ ‡ç¨‹åº¦æ¥åˆ¶å®šä¸‹ä¸ªä¸‰å¹´è®¡åˆ’ï¼Œ è¿™ä¸ªä¸–ç•Œå˜åŒ–å¾ˆå¿«ï¼Œè°ä¹Ÿä¸çŸ¥é“ä¸‹ä¸ªä¸‰å¹´ä¼šå‘ç”Ÿä»€ä¹ˆã€‚å…¶å®åˆ¶å®šè¿™ä¸ªè®¡åˆ’çš„åˆè¡·å¾ˆç®€å•ï¼Œå°±æ˜¯ä¸æƒ³è®©è‡ªå·±ç¢Œç¢Œæ— ä¸ºã€‚æ¯å¤©å¥”æ³¢äºä¸Šç­å’Œä½å®¿ä¹‹é—´ï¼Œé‚£åªæ˜¯åˆ«äººçœ‹èµ·æ¥ä½ å¾ˆå¿™ï¼Œäººç”Ÿå°±æ˜¯è¿™æ ·ï¼Œä¸å…¶æ¯å¤©æµ‘æµ‘å™©å™©ï¼Œéšæ³¢é€æµï¼Œä¸å¦‚è‡ªå·±ä¸»å®°è‡ªå·±çš„äººç”Ÿï¼Œæ¯•ç«Ÿäººçš„ä¸€ç”Ÿå¾ˆçŸ­ï¼Œç”Ÿå‘½ï¼Œæ—¶é—´è¯šå¯è´µã€‚</p>

<h3>ä¸ºä»€ä¹ˆè¦è€ƒç ”ï¼Ÿ</h3>

<p>&emsp;&emsp;å…¶å®å½“åˆæ¥ä¸Šæµ·çš„ä¸»è¦ç›®çš„å¹¶ä¸æ˜¯ä¸ºäº†æ‰¾å·¥ä½œï¼Œè€Œæ˜¯ä¸ºäº†è€ƒç ”ï¼Œä¹Ÿç®—æ˜¯ä¸€æ—¶å†²åŠ¨å§ï¼Œå°±è¾äº†å·¥ä½œï¼Œè·‘æ¥ä¸Šæµ·ï¼Œç»“æœå‘ç°è‡ªå·±å•¥éƒ½æ²¡å‡†å¤‡ï¼Œç»“æœè¿˜æ˜¯ä¹–ä¹–åœ°æ‰¾äº†ä»½å·¥ä½œä¸Šç­ï¼Œç›´åˆ°ä»Šå¹´ä¸ŠåŠå¹´ï¼Œçªç„¶æƒ³èµ·å½“åˆæ¥ä¸Šæµ·çš„åˆè¡·ï¼Œè™½ç„¶å·²ç»è¿‡äº†ä¸‰ï¼Œå››å¹´äº†ï¼Œä½†è¿™äº‹ä¸€ç›´æåœ¨å¿ƒé‡Œï¼Œæ‰€ä»¥ä¸ŠåŠå¹´å°±é¼“èµ·äº†å‹‡æ°”å‡†å¤‡è€ƒç ”ï¼Œå½“ç„¶è€ƒçš„æ˜¯éå…¨èŒåˆ¶ï¼Œä¸€ä¸ªå·²ç»å·¥ä½œäº†5ï¼Œ6å¹´ï¼Œèº«ä¸Šè¿˜èƒŒè´Ÿç€æˆ¿è´·ï¼Œé©¬ä¸Šè¦ç»“å©šçš„äººï¼Œå»è¯»å…¨æ—¥åˆ¶è‚¯å®šæ˜¯ä¸å¯èƒ½çš„äº†ï¼Œçªç„¶å‘ç°å¹´è½»çœŸå¥½ï¼Œå¯ä»¥æ˜¯æ— å¿Œæƒ®çš„åšå†³å®šï¼Œä¸åƒæˆ‘ä»¬è¿™ä¸ªå¹´çºªï¼Œèº«ä¸ŠèƒŒç€å„ç§è´£ä»»ï¼Œæ¯åšä¸€æ­¥é€‰æ‹©éƒ½è¦æ·±æ€ç†Ÿè™‘ã€‚<br/>
&emsp;&emsp;è€ƒç ”æ˜¯ä¸€ä»¶éå¸¸ç—›è‹¦çš„äº‹æƒ…ï¼Œå¦‚æœä»…ä»…æ˜¯å› ä¸ºå½“åˆæ¥ä¸Šæµ·çš„æƒ…æ€€å»è€ƒè¯•ï¼Œæˆ‘è¿˜æ²¡æœ‰è¿™ä¹ˆå¤§çš„å‹‡æ°”åšè¿™ä¸ªå†³å®šï¼ŒçœŸæ­£è®©æˆ‘å»è€ƒç ”çš„è¿˜æ˜¯æˆ‘çš„â€œä¸€ä¸‰è®¡åˆ’â€,ä¹Ÿå°±æ˜¯è¯´è€ƒç ”æ˜¯æˆ‘â€œä¸€ä¸‰è®¡åˆ’â€é‡Œ2017å¹´éœ€è¦å®ç°çš„ç¬¬ä¸€ä¸ªç›®æ ‡ï¼Œè¿™åªæ˜¯ä¸€ä¸ªå¼€å§‹ï¼Œæˆ‘ç›¸ä¿¡æœªæ¥æ¯”è¿™ä¸ªéš¾çš„ç›®æ ‡è¿˜æœ‰å¾ˆå¤šï¼Œä¸ä¸€å®šèƒ½å…¨éƒ¨å®ç°ï¼Œä½†ä¸è¯•ä¸€ä¸‹ï¼Œä½ æ€ä¹ˆçŸ¥é“ä¸è¡Œï¼Œäººçš„ä¸€ç”Ÿéƒ½æ˜¯åœ¨å®è·µã€è¯•é”™ä¸­åº¦è¿‡ï¼Œå®è·µæ˜¯æ£€éªŒçœŸç†çš„å”¯ä¸€æ ‡å‡†ï¼Œä¸å»å®è·µä½ è¿é”™çš„æœºä¼šéƒ½æ²¡æœ‰ï¼Œè€Œä¸”å¹¶ä¸æ˜¯æ¯ä¸ªäººéƒ½èƒ½é‡åˆ°å¼¯é“è¶…è½¦çš„æœºä¼šï¼Œè„šè¸å®åœ°æ‰èƒ½èµ°å‡ºè‡ªå·±çš„è·¯ï¼Œ<br/>
&emsp;&emsp;è€ƒç ”æ˜¯ä¸€å—å«è„šçŸ³ï¼Œå¹¶ä¸€å®šå¯ä»¥è®©ä½ ç«™çš„é«˜ä¸€ç‚¹ï¼Œä½†èµ·ç å¯ä»¥è®©ä½ æ¯”ç°åœ¨å¥½ä¸€ç‚¹ï¼Œä¸å…¶è‡ªå·±æ¯å¤©æµ‘æµ‘å™©å™©ï¼Œä¸¤ç‚¹ä¸€çº¿çš„ç”Ÿæ´»ï¼Œä¸å¦‚æ‰¾ä¸ªæ–°æ–¹å‘ï¼ŒåŠªåŠ›åŠªåŠ›ã€‚<br/>
è‡³äºè€ƒç ”çœŸçš„èƒ½å¸¦æ¥ä»€ä¹ˆï¼Œä¼šæœ‰ä»€ä¹ˆæ”¹å˜ï¼Œæˆ‘è§‰å¾—å¼ é›ªå³°è€å¸ˆè¯´çš„éå¸¸å¯¹
<a href="https://www.zhihu.com/question/63319033/answer/209939978">https://www.zhihu.com/question/63319033/answer/209939978</a></p>

<h3>è€ƒç ”æœ‰å¤šè¾›è‹¦</h3>

<p>&emsp;&emsp;ä¸€å¼€å§‹æ‰“ç®—è€ƒç ”çš„æ—¶å€™ï¼Œæƒ³ç€å¤æ—¦å¤§å­¦è½¯ä»¶å·¥ç¨‹çš„åœ¨èŒç ”ç©¶ç”Ÿæ¯”äº¤å¤§çš„åˆ†æ•°ä½ï¼Œè‹±è¯­è€ƒçš„è¿˜æ˜¯è‹±è¯­äºŒï¼Œæƒ³æƒ³è‡ªå·±åœ¨å®¶çœ‹çœ‹ä¹¦ï¼Œåº”è¯¥å¯ä»¥ï¼Œåæ¥å‘ç°è¿˜æ˜¯ too young too simple, ä»…ä¸€é—¨é«˜æ•°å°±è®©æˆ‘å´©æºƒï¼Œåœ¨å®¶è‡ªå·±çœ‹äº†ä¸¤ä¸ªæœˆå·¦å³çš„é«˜æ•°å’Œçº¿æ€§ä»£æ•°ï¼Œè¯¾åä¹ é¢˜åšç€æ„Ÿè§‰è¿˜è¡Œï¼Œä½†ä¸€åšè€ƒç ”çš„é¢˜ç›®ï¼Œå°±å®Œå…¨è’™é€¼äº†ï¼Œè¿™å®Œå…¨æ˜¯ä¸¤ä¸ªä¸åŒéš¾åº¦çš„ï¼Œå› ä¸ºå¤§å­¦æœ¬æ¥å°±æ²¡å­¦è¿‡çº¿æ€§ä»£æ•°ï¼Œè€Œä¸”æ¯•ä¸š5å¹´å¤šï¼Œå¤§éƒ¨åˆ†éƒ½å¿˜è®°çš„ä¸€å¹²äºŒå‡€ï¼Œç°åœ¨å­¦ç¡®å®æœ‰ç‚¹æ£˜æ‰‹ï¼Œåæ¥å‘ç°è¿™æ ·å­¦ä¹ æ•ˆç‡å®åœ¨æ˜¯ä¸è¡Œï¼Œçœ‹åˆ°è€ƒè¯•äº†éƒ½çœ‹ä¸äº†ä¸‰åˆ†ä¹‹ä¸€ï¼Œå°±å†³å®šå»æŠ¥ä¸€ä¸ªè¾…å¯¼ç­(è¯è¯´é‚£ä¸ªè¾…å¯¼ç­çš„ä»·æ ¼ä¸æ˜¯ä¸€èˆ¬çš„è´µ)ã€‚<br/>
&emsp;&emsp;æ¥ä¸‹æ¥çš„åŠå¹´å°±æ˜¯å‘¨ä¸€åˆ°å‘¨äº”ç™½å¤©ä¸Šç­ã€æ™šä¸Šå¤ä¹ ï¼Œå‘¨å…­ï¼Œå‘¨æ—¥ä¸Šè¯¾ï¼Œå‘¨æœ«è¦èµ·å¾—æ¯”ä¸Šç­è¿˜æ—©ã€‚ã€‚ã€‚æƒ³æƒ³ä»¥å‰å‘¨æœ«èƒ½ç¡ä¸ªæ‡’è§‰çœŸæ˜¯å¤ªå¹¸ç¦äº†ã€‚<br/>
&emsp;&emsp;è·Ÿç€è¾…å¯¼ç­çš„è€å¸ˆå­¦ä¹ ï¼Œè¿›åº¦ç¡®å®æ˜¯èµ¶ä¸Šäº†ï¼Œä½†è‡ªå·±åŸºç¡€è¿˜æ˜¯ä¸æ‰å®ï¼Œå†åŠ ä¸Šæ²¡æœ‰è¶³å¤Ÿçš„æ—¶é—´å¤ä¹ ï¼Œè™½ç„¶æ¯å¤©æ™šä¸Šå¤ä¹ åˆ°å‡Œæ™¨1ï¼Œ2ç‚¹ï¼Œä½†å› ä¸ºæ˜¯åœ¨èŒï¼Œè€Œä¸”åªæœ‰åŠå¹´çš„æ—¶é—´ï¼Œæ—¶é—´éå¸¸ç´§å¼ ï¼Œè¿™ç‚¹æ—¶é—´å®Œå…¨æ˜¯ä¸å¤Ÿçš„ï¼Œé«˜æ•°å­¦å¾—æ–­æ–­ç»­ç»­ï¼Œå¾ˆå¤šä¸œè¥¿è¿è´¯ä¸èµ·æ¥ï¼Œéšä¾¿è´´å‡ ä¸ªå¤ä¹ è®¡åˆ’å§ã€‚</p>

<ul>
<li>é«˜æ•°ï¼šæ¯å¤©ä¸‹ç­ä¸»è¦æ˜¯å¤ä¹ é«˜æ•°å’Œçº¿æ€§ä»£æ•°ï¼Œå‰5æœˆåŸºæœ¬ä¸Šæ˜¯çœ‹é«˜æ•°ä¹¦å’Œçº¿æ€§ä»£æ•°çš„æ•°ï¼ŒåŠ ä¸Šè€å¸ˆçš„è¯¾ç¨‹å’Œç½‘ä¸Šçš„è§†é¢‘æ•™ç¨‹ï¼Œå2ä¸ªæœˆå°±æ˜¯ç›´æ¥ä¸Šå¾€å¹´çš„è€ƒç ”è¯•å·ï¼Œåˆ°è€ƒå‰ä¸€å…±æ‰åšäº†10å¥—ï¼Œä¸¤ç¯‡ã€‚å¤ä¹ é«˜æ•°æ˜¯æœ€ç—›è‹¦çš„ï¼Œæ¯æ¬¡çœ‹é«˜æ•°éƒ½çœ‹å¾—ä¸¤çœ¼å†’é‡‘æ˜Ÿï¼Œæœ‰ç§æ€æ¡Œå­çš„å†²åŠ¨ã€‚</li>
<li>è‹±è¯­ï¼šè‹±è¯­åŸºæœ¬ä¸Šæ˜¯è€ƒå‰3ä¸ªå¤šæœˆæ¯å¤©æ—©ä¸Šåœ¨åœ°é“èƒŒå•è¯ï¼Œæ¯å¤©èƒŒ30ä¸ªå•è¯ï¼ŒåšæŒäº†100å¤šå¤©ï¼ŒèƒŒäº†è€ƒç ”æ ¸å¿ƒ3000å¤šä¸ªå•è¯ï¼Œä½†æ˜¯æ•ˆæœå¹¶ä¸å¥½ï¼ŒåŸºæœ¬ä¸Šæ˜¯èƒŒäº†å¿˜ï¼ŒèƒŒäº†å¿˜ï¼Œåå‡ ä¸ªæœˆæ˜¯æ¯å¤©æ—©ä¸Šé€å¥ç¿»è¯‘å¾€å¹´çš„é˜…è¯»ç†è§£ï¼Œå¹¶æŠŠé¢˜ç›®åšå‡ºæ¥ï¼Œåšäº†ä¸¤ä¸ªå¤šæœˆï¼Œæ•ˆæœè¿˜æ˜¯å¾ˆä¸é”™çš„ï¼Œæœ€åä¸€ä¸ªæœˆåŸºæœ¬ä¸Šæ˜¯èƒŒå¤§å°ä½œæ–‡ï¼Œèƒ½èƒŒå¤šå°‘èƒŒå¤šå°‘ã€‚</li>
<li>æ”¿æ²»ï¼šæ”¿æ²»åŸºæœ¬ä¸Šæ˜¯è·Ÿç€è€å¸ˆçš„è¯¾ç¨‹èµ°ï¼Œæ²¡å è¯¾ä½™çš„å¤ªå¤šæ—¶é—´ï¼Œæœ€åä¸€ä¸ªæœˆåšè‚–8ï¼Œå’Œè‚–4ï¼Œæœ€åä¸€ä¸ªæ˜ŸæœŸç‹‚èƒŒè€å¸ˆç»™çš„æŠ¼é¢˜å’Œè‚–4çš„æŠ¼é¢˜ï¼ˆè¾…å¯¼ç­çš„æ”¿æ²»è€å¸ˆå¾ˆè´Ÿè´£ä»»ï¼‰ã€‚</li>
<li>ä¸“ä¸šè¯¾ï¼šè·Ÿç€è€å¸ˆçš„è¯¾ç¨‹èµ°ï¼Œè¯¾ååŸºæœ¬ä¸Šæ²¡æ—¶é—´çœ‹ï¼Œæœ€åä¸€ä¸ªæœˆç‹‚èƒŒè½¯ä»¶å·¥ç¨‹ï¼Œçœ‹æ•°æ®ç»“æ„çš„ä»£ç ã€‚</li>
</ul>


<h4>æœ€åè¯´å‡ å¥æ„Ÿæƒ³å§ï¼Œ</h4>

<p>1ã€åœ¨èŒè€ƒç ”ç¡®å®å‹åŠ›æ¯”è¾ƒå¤§ï¼Œå› ä¸ºå­¦æ ¡çš„å­¦ç”Ÿå¯ä»¥æ¯å¤©èŠ±12ä¸ªå°æ—¶æ¥å­¦ä¹ ï¼Œè€Œæˆ‘ä»¬åœ¨èŒçš„ç®—ä¸Šç†¬å¤œæœ€å¤šåªæœ‰4ï¼Œ5ä¸ªå°æ—¶æ¥å­¦ä¹ ï¼Œæœ€åçš„ç»“æœå°±æ˜¯æ¯å¤©å¹²ç€æ€¥ï¼Œçœ‹ç€ä¸€å †ä¸ä¼šåšçš„é«˜æ•°çœŸçš„æ€¥å•Šï¼Œåˆæ²¡è¶³å¤Ÿçš„æ—¶é—´å»çœ‹ï¼Œç„¦è™‘ç—‡éƒ½è¦å‡ºæ¥ã€‚<br/>
2ã€ä¸Šäº†å¹´çºªçš„äººåƒä¸‡ä¸è¦å†ç†¬å¤œäº†ï¼Œå‰æ®µæ—¶é—´ä¸ºäº†å¤ä¹ ï¼Œæ¯å¤©ç†¬åˆ°å‡Œæ™¨1ï¼Œ2ç‚¹ï¼Œæ—©ä¸Šåˆä¸€æ—©èµ·æ¥ï¼ŒçœŸå¿ƒæ„Ÿè§‰åƒä¸æ¶ˆï¼Œç°åœ¨æ˜æ˜¾æ„Ÿè§‰èº«ä½“å¤§ä¸å¦‚ä»å‰ï¼Œæ‰€ä»¥åƒä¸‡ä¸è¦ç†¬å¤œï¼Œè€ƒä¸ªç ”æœ€åæŠŠèº«ä½“æåäº†å¾—ä¸å¿å¤±ï¼Œæ¯•ç«Ÿä¸æ˜¯å¹´è½»æ—¶å€™ï¼Œå»ç½‘å§ä¸Šä¸ªé€šå®µï¼Œç¬¬äºŒå¤©ç…§å¸¸ä¸Šè¯¾ã€‚<br/>
3ã€æˆ‘å†ä¹Ÿä¸æƒ³çœ‹å¾®ç§¯åˆ†äº†ã€‚<br/>
4ã€å…¶å®åœ¨å†™è¿™ç¯‡æ–‡ç« çš„æ—¶å€™å·²ç»è€ƒå®Œç ”äº†ï¼Œè€Œä¸”æˆ‘é¢„æ–™åˆ°æˆ‘å¯èƒ½ä¼šæŒ‚åœ¨é«˜æ•°ä¸Šï¼Œæƒ³æƒ³è¿™åŠå¹´å¤šåƒçš„è‹¦ï¼Œç¡®å®æœ‰ç‚¹ä¸ç”˜å¿ƒã€‚</p>

<h4>å†è´´å‡ å¼ å¤ä¹ æ—¶å€™çš„ç…§ç‰‡ï¼Œç•™ä¸ªå¿µæƒ³</h4>

<p>è€ƒç ”ä¸Šçš„è¾…å¯¼ç­,ä¸€èˆ¬ä¸“ä¸šè¯¾å‡ ä¸ªç­åˆåœ¨ä¸€èµ·ä¸Šï¼Œä¸Šè¯¾çš„äººæ¯”è¾ƒå¤š<img src="http://7xjibn.com1.z0.glb.clouddn.com/WechatIMG490.jpeg?imageMogr2/thumbnail/!50p" alt="" /></p>

<p>è€ƒç ”å‰å‡ å¤©ï¼Œæ™šä¸Šéƒ½åœ¨ä¸Šæ”¿æ²»è¯¾ï¼Œ<img src="http://7xjibn.com1.z0.glb.clouddn.com/WechatIMG482.jpeg?imageMogr2/thumbnail/!50p" alt="" /></p>

<p>ä¸‡æ¶çš„é«˜æ•°å’Œçº¿ä»£ï¼Œè€ƒç ”é‡Œçš„å¾®åˆ†å­¦å’Œç§¯åˆ†å­¦æ˜¯çœŸå¿ƒéš¾ï¼ˆä¹Ÿå¯èƒ½æ˜¯æˆ‘åŸºç¡€å·®ï¼‰ï¼Œè€Œä¸”æœ‰äº›é¢˜è®¡ç®—é‡è¶…å¤§ï¼Œè€ƒè¯•æ—¶æœ‰äº›é¢˜çœŸæ˜¯ä¼šåšï¼Œä½†å°±æ˜¯æ²¡æ—¶é—´äº†ï¼Œè®¡ç®—é‡å¤ªå¤§
<img src="http://7xjibn.com1.z0.glb.clouddn.com/WechatIMG477.jpeg?imageMogr2/thumbnail/!50p" alt="" />
<img src="http://7xjibn.com1.z0.glb.clouddn.com/WechatIMG489.jpeg?imageMogr2/thumbnail/!50p" alt="" />
<img src="http://7xjibn.com1.z0.glb.clouddn.com/WechatIMG486.jpeg?imageMogr2/thumbnail/!50p" alt="" /></p>

<p>å¤ä¹ æ—¶ä½¿ç”¨ç™¾è¯æ–©èƒŒè‹±è¯­å•è¯ï¼Œè¿˜æ˜¯æŒºå¥½ç”¨çš„ï¼Œç»å¸¸åœ¨ruby chinaä¸Šçœ‹åˆ°ä»–ä»¬æ‹›ruby
<img src="http://7xjibn.com1.z0.glb.clouddn.com/WechatIMG491.jpeg?imageMogr2/thumbnail/!50p" alt="" /></p>

<p>æœ‰æ¬¡è¾…å¯¼ç­æ¨¡æ‹Ÿè€ƒè¯•ï¼Œè‹±è¯­è€ƒäº†67åˆ†ï¼Œæ¯”ä¸Šæ¬¡è€ƒæ¬¡è¿›æ­¥äº†ä¸äº†
<img src="http://7xjibn.com1.z0.glb.clouddn.com/WechatIMG487.jpeg?imageMogr2/thumbnail/!50p" alt="" /></p>

<p>ä¸Šä¸“ä¸šè¯¾ï¼Œæœ‰ä¸‰ä¸ªè€å¸ˆï¼Œæ¯ä¸ªè€å¸ˆè®²ä¸€é—¨è¯¾ï¼Œæœ€åå‡ å¤©ç‹‚èƒŒè½¯ä»¶å·¥ç¨‹çš„ä¸€äº›åè¯æ¦‚å¿µï¼Œç»“æœè€ƒè¯•æ—¶å‘ç°è½¯ä»¶å·¥ç¨‹å°±å‡ºäº†ä¸€é“æ¦‚å¿µé¢˜ï¼Œå…¶å®ƒå…¨æ˜¯ç”»è®¾è®¡å›¾ï¼Œæ™•æ­»ï¼Œ<br/>
<img src="http://7xjibn.com1.z0.glb.clouddn.com/WechatIMG471.jpeg?imageMogr2/thumbnail/!50p" alt="" />
<img src="http://7xjibn.com1.z0.glb.clouddn.com/WechatIMG472.jpeg?imageMogr2/thumbnail/!50p" alt="" />
<img src="http://7xjibn.com1.z0.glb.clouddn.com/WechatIMG473.jpeg?imageMogr2/thumbnail/!50p" alt="" />
<img src="http://7xjibn.com1.z0.glb.clouddn.com/WechatIMG484.jpeg?imageMogr2/thumbnail/!50p" alt="" />
<img src="http://7xjibn.com1.z0.glb.clouddn.com/WechatIMG485.jpeg?imageMogr2/thumbnail/!50p" alt="" /></p>

<p>è€ƒè¯•å‰è¯·äº†ä¸€ä¸ªæ˜ŸæœŸçš„å‡ï¼Œåœ¨å¤æ—¦å¤§å­¦ä¸»æ¥¼é‡Œè‡ªä¹ ï¼Œæ¯å¤©6ç‚¹èµ·åºŠï¼Œèµ¶åˆ°è¿™é‡ŒèƒŒæ”¿æ²»ï¼Œè¿™ä¸ªåœ°æ–¹å…‰çº¿å¥½ï¼Œæœ‰å¤ªé˜³ç…§è¿›æ¥ï¼Œé‚£å‡ å¤©ç‰¹åˆ«å†·<br/>
<img src="http://7xjibn.com1.z0.glb.clouddn.com/WechatIMG481.jpeg?imageMogr2/thumbnail/!50p" alt="" />
<img src="http://7xjibn.com1.z0.glb.clouddn.com/WechatIMG478.jpeg?imageMogr2/thumbnail/!50p" alt="" />
<img src="http://7xjibn.com1.z0.glb.clouddn.com/WechatIMG479.jpeg?imageMogr2/thumbnail/!50p" alt="" /></p>

<p>å‡†è€ƒè¯å’Œè€ƒåœºå‡ºæ¥äº†<br/>
<img src="http://7xjibn.com1.z0.glb.clouddn.com/WechatIMG492.jpeg?imageMogr2/thumbnail/!50p" alt="" />
<img src="http://7xjibn.com1.z0.glb.clouddn.com/WechatIMG476.jpeg?imageMogr2/thumbnail/!50p" alt="" /></p>

<p>è€ƒè¯•å½“å¤©èµ·äº†ä¸ªå¤§æ—©å°±èµ¶å»è€ƒåœºäº†
<img src="http://7xjibn.com1.z0.glb.clouddn.com/WechatIMG475.jpeg?imageMogr2/thumbnail/!50p" alt="" />
æ’é˜Ÿè¿›è€ƒåœº
<img src="http://7xjibn.com1.z0.glb.clouddn.com/WechatIMG474.jpeg?imageMogr2/thumbnail/!50p" alt="" /><br/></p>

<h3>åè®°</h3>

<p>&emsp;&emsp;è·¯æ¼«æ¼«æœŸä¿®è¿œå…®ï¼Œå¾å°†ä¸Šä¸‹è€Œæ±‚ç´¢ï¼Œâ€œä¸€ä¸‰è®¡åˆ’â€æ‰åˆšå¼€å§‹ï¼Œæœªæ¥çš„è·¯è¿˜å¾ˆé•¿ï¼Œä¸å¥¢æœ›å‰æ–¹çš„è·¯æœ‰å¤šå¹³å¦ï¼Œè‡ªå·±å°½å¿ƒå°±å¥½ï¼Œä¸ç•™é—æ†¾ã€‚
å¦‚æœè€ƒä¸Šäº†ï¼Œä¼šåœ¨è¿™é‡Œæ›´æ–°ä¸€ä¸‹æˆ‘çš„å½•å–é€šçŸ¥ä¹¦ï¼Œå¦‚æœæ²¡è€ƒä¸Šï¼Œé‚£å°±ç®—äº†ã€‚ <br/>
&emsp;&emsp;æœ€åç”¨ä¸€å¥è‘›å¤§çˆ·åœ¨ã€ç”²æ–¹ä¹™æ–¹ã€‘é‡Œç»å…¸çš„è¯ä½œä¸ªç»“å°¾ï¼š2017å¹´è¿‡å»äº†ï¼Œæˆ‘å¾ˆæ€€å¿µã€‚
<img src="http://7xjibn.com1.z0.glb.clouddn.com/4fa2c09ct5f53e319895d.jpeg" alt="" /></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Rubyå…ƒç¼–ç¨‹ä¹‹çŒ´å­è¡¥ä¸]]></title>
    <link href="http://xuyao.club/blog/2017/05/06/metaprogramming-ruby-of-monkeypatch/"/>
    <updated>2017-05-06T16:48:53+08:00</updated>
    <id>http://xuyao.club/blog/2017/05/06/metaprogramming-ruby-of-monkeypatch</id>
    <content type="html"><![CDATA[<h3>æ‰“å¼€ç±»</h3>

<p>å…ˆçœ‹ä¸€ä¸ªä¾‹å­ï¼Œ</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="mi">3</span><span class="o">.</span><span class="n">times</span> <span class="k">do</span>
</span><span class='line'>  <span class="k">class</span> <span class="nc">Dog</span>
</span><span class='line'>    <span class="nb">puts</span> <span class="s2">&quot;wang...&quot;</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'><span class="o">=&gt;</span> <span class="n">wang</span><span class="o">.</span><span class="n">.</span><span class="o">.</span>
</span><span class='line'>   <span class="n">wang</span><span class="o">.</span><span class="n">.</span><span class="o">.</span>
</span><span class='line'>   <span class="n">wang</span><span class="o">.</span><span class="n">.</span><span class="o">.</span>
</span></code></pre></td></tr></table></div></figure>


<!-- more -->


<p>ä¸Šé¢çš„ä»£ç å¹¶éå®šä¹‰ä¸‰ä¸ªåŒåçš„ç±»ï¼Œè€Œæ˜¯ç¬¬ä¸€æ¬¡å®šä¹‰ä¸€ä¸ªç±»ï¼Œå…¶å®ƒä¸¤æ¬¡æ˜¯é‡æ–°æ‰“å¼€è¿™ä¸ªç±»ã€‚</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">Dog</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">say</span>
</span><span class='line'>    <span class="nb">puts</span> <span class="s2">&quot;wang wang...&quot;</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">class</span> <span class="nc">Dog</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">eat</span>
</span><span class='line'>    <span class="nb">puts</span> <span class="s2">&quot;bone&quot;</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="n">dog</span> <span class="o">=</span> <span class="no">Dog</span><span class="o">.</span><span class="n">new</span>
</span><span class='line'><span class="n">dog</span><span class="o">.</span><span class="n">say</span>    <span class="c1">#=&gt; wang wang...</span>
</span><span class='line'><span class="n">day</span><span class="o">.</span><span class="n">eat</span>     <span class="c1">#= bone</span>
</span></code></pre></td></tr></table></div></figure>


<p>â€ƒä»ä¸Šé¢çš„ä¾‹å­å¯ä»¥çœ‹å‡ºï¼Œå½“Rubyå¼€å§‹ç€æ‰‹å®šä¹‰ä¸€ä¸ªç±»ï¼Œå¹¶å®šä¹‰say()æ–¹æ³•ï¼Œç¬¬äºŒæ¬¡å†æåŠDogç±»æ—¶ï¼Œå¦‚æœå®ƒå·²ç»å­˜åœ¨ï¼ŒRubyå°±ä¸ç”¨å†å®šä¹‰äº†ï¼Œåªéœ€è¦é‡æ–°æ‰“å¼€è¿™ä¸ªå·²ç»å­˜åœ¨çš„ç±»ï¼Œå¹¶å®šä¹‰eat()æ–¹æ³•ã€‚</p>

<p>&emsp;åƒè¿™ç§ä½ æ€»æ˜¯å¯ä»¥é‡æ–°æ‰“å¼€ä¸€ä¸ªå·²ç»å­˜åœ¨çš„ç±»å¹¶å¯¹å®ƒè¿›è¡ŒåŠ¨æ€ä¿®æ”¹çš„æŠ€æœ¯ï¼Œå¯ä»¥ç§°ä¹‹ä¸º<strong><em>æ‰“å¼€ç±»(open class)</em></strong></p>

<h3>çŒ´å­æ‰“è¡¥ä¸</h3>

<p>&emsp;ä½ å†™äº†ä¸€ä¸ªsubstituteæ–¹æ³•ï¼ŒåŠŸèƒ½æ˜¯åœ¨ä¸€ä¸ªæ•°ç»„ä¸­ï¼ŒæŠŠä¸€ä¸ªæŒ‡å®šçš„å…ƒç´ æ›¿æ¢æˆå¦ä¸€ä¸ªå…ƒç´ çš„,ä»£ç å¦‚ä¸‹</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'>  <span class="k">def</span> <span class="nf">substitute</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">from</span><span class="p">,</span> <span class="n">to</span><span class="p">)</span>
</span><span class='line'>    <span class="n">array</span><span class="o">.</span><span class="n">each_with_index</span> <span class="k">do</span> <span class="o">|</span><span class="n">v</span><span class="p">,</span> <span class="n">i</span><span class="o">|</span>
</span><span class='line'>      <span class="n">array</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="n">to</span> <span class="k">if</span> <span class="n">v</span> <span class="o">==</span> <span class="n">from</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="c1">#=&gt; </span>
</span><span class='line'><span class="n">a</span> <span class="o">=</span> <span class="o">[</span><span class="s2">&quot;zh&quot;</span><span class="p">,</span> <span class="s2">&quot;usa&quot;</span><span class="p">,</span> <span class="s2">&quot;ja&quot;</span><span class="p">,</span> <span class="s2">&quot;ck&quot;</span><span class="o">]</span>
</span><span class='line'><span class="n">substitute</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="s2">&quot;ja&quot;</span><span class="p">,</span> <span class="s2">&quot;kr&quot;</span><span class="p">)</span>
</span><span class='line'><span class="o">[</span><span class="s2">&quot;zh&quot;</span><span class="p">,</span> <span class="s2">&quot;usa&quot;</span><span class="p">,</span> <span class="s2">&quot;kr&quot;</span><span class="p">,</span> <span class="s2">&quot;ck&quot;</span><span class="o">]</span>
</span></code></pre></td></tr></table></div></figure>


<p>&emsp;æœç„¶æ˜¯ä¸ªå¥½æ–¹æ³•ï¼Œç”¨èµ·æ¥å¾ˆæ–¹ä¾¿ï¼Œä½†æ˜¯å¾ˆå¿«ä½ å‘ç°å…¶å®è¿™ä¸ªæ–¹æ³•å¯ä»¥å†é‡æ„ä¸€ä¸‹ï¼ŒæŠŠå®ƒå®šä¹‰æˆArrayä¸­çš„ä¸€ä¸ªå®ä¾‹æ–¹æ³•å²‚ä¸æ˜¯æ›´å¥½ï¼Œäºæ˜¯ä½ åˆæ”¹äº†ä¸€ä¸‹ï¼Œä»£ç å¦‚ä¸‹</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">Array</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">substitute</span><span class="p">(</span><span class="n">from</span><span class="p">,</span> <span class="n">to</span><span class="p">)</span>
</span><span class='line'>    <span class="nb">self</span><span class="o">.</span><span class="n">each_with_index</span> <span class="k">do</span> <span class="o">|</span><span class="n">v</span><span class="p">,</span> <span class="n">i</span><span class="o">|</span>
</span><span class='line'>      <span class="nb">self</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="n">to</span> <span class="k">if</span> <span class="n">v</span> <span class="o">==</span> <span class="n">from</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="c1">#=&gt; </span>
</span><span class='line'><span class="n">a</span> <span class="o">=</span> <span class="o">[</span><span class="s2">&quot;zh&quot;</span><span class="p">,</span> <span class="s2">&quot;usa&quot;</span><span class="p">,</span> <span class="s2">&quot;ja&quot;</span><span class="p">,</span> <span class="s2">&quot;ck&quot;</span><span class="o">]</span>
</span><span class='line'><span class="n">a</span><span class="o">.</span><span class="n">substitute</span><span class="p">(</span><span class="s2">&quot;ja&quot;</span><span class="p">,</span> <span class="s2">&quot;kr&quot;</span><span class="p">)</span>
</span><span class='line'><span class="o">[</span><span class="s2">&quot;zh&quot;</span><span class="p">,</span> <span class="s2">&quot;usa&quot;</span><span class="p">,</span> <span class="s2">&quot;kr&quot;</span><span class="p">,</span> <span class="s2">&quot;ck&quot;</span><span class="o">]</span>
</span></code></pre></td></tr></table></div></figure>


<p>&emsp;ä¸Šé¢çš„ä»£ç æ˜¯æ‰“å¼€Arrayç±»ï¼Œå¹¶å†ç±»ä¸­æ·»åŠ substitute()æ–¹æ³•ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œä½ å¹¶æ²¡æœ‰ä¿®æ”¹åŸå§‹çš„Arrayç±»åº“ï¼Œè€Œä»…ä»…æ˜¯é‡æ–°æ‰“å¼€äº†å®ƒï¼Œå†å¾€é‡Œé¢å¢åŠ æ–¹æ³•ï¼Œ
ç®€ç›´æ˜¯å¤ªå®Œç¾äº†ï¼ŒArrayç±»ä¸­ç«Ÿç„¶ç¼ºå°‘è¿™ä¹ˆä¸€ä¸ªå¥½ç”¨çš„æ–¹æ³•ï¼Œè¿˜å¥½ä½ æŠŠå®ƒåŠ ä¸Šäº†ã€‚</p>

<p>&emsp;åƒè¿™ç§åœ¨ä¸æ”¹å˜æºç çš„æƒ…å†µä¸‹ï¼Œå¯¹åŠŸèƒ½è¿›è¡ŒåŠ¨æ€è¿½åŠ ã€ä¿®æ”¹çš„æŠ€æœ¯å«åš<em><strong>çŒ´å­è¡¥ä¸(Monkey patch)</strong></em></p>

<h3>çŒ´å­è¡¥ä¸å¼•èµ·çš„é—®é¢˜</h3>

<p>&emsp;å¦‚ä¸Šæ‰€è¯´ï¼Œåœ¨Rubyä¸­ï¼Œå¯ä»¥å¾ˆè½»æ¾åœ°æ‰“å¼€ä¸€ä¸ªå·²ç»å®šä¹‰çš„ç±»ï¼Œå¹¶å¾€ç±»ä¸­å¡æ–¹æ³•ï¼ˆåŒ…æ‹¬String,Arrayç±»ï¼‰
â€ƒè¿™æ—¶ä½ çªç„¶å‘ç°substituteè¿™ä¸ªå•è¯å¤ªé•¿ï¼Œå½±å“ä½¿ç”¨ï¼Œä½ å·²ç»æƒ³åˆ°äº†ä¸€ä¸ªæ›´å¥½çš„æ–¹æ³•åreplace,äºæ˜¯ä½ æŠŠä»£ç åˆæ”¹äº†ä¸€æ¬¡ï¼Œå¦‚ä¸‹ï¼šâ€ƒ</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'>  <span class="k">class</span> <span class="nc">Array</span>
</span><span class='line'>    <span class="k">def</span> <span class="nf">replace</span><span class="p">(</span><span class="n">from</span><span class="p">,</span> <span class="n">to</span><span class="p">)</span>
</span><span class='line'>      <span class="nb">self</span><span class="o">.</span><span class="n">each_with_index</span> <span class="k">do</span> <span class="o">|</span><span class="n">v</span><span class="p">,</span> <span class="n">i</span><span class="o">|</span>
</span><span class='line'>        <span class="nb">self</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="n">to</span> <span class="k">if</span> <span class="n">v</span> <span class="o">==</span> <span class="n">from</span>
</span><span class='line'>      <span class="k">end</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>&emsp;ç®€ç›´å¤ªå®Œç¾äº†ï¼Œä½ è½»è½»æ¾æ¾å°±åœ¨Rubyè‡ªå·±çš„ç±»åº“ä¸­æ·»åŠ äº†æ–¹æ³•ï¼Œè¿™æ—¶ä½ æ—è¾¹çš„åŒäº‹ä¸€å¤´é›¾æ°´çš„åœ¨æ‰¾bug,è¯´è‡ªå·±æ˜æ˜æ²¡æ”¹è¿‡è¿™å—ä»£ç ï¼Œæ€ä¹ˆç°åœ¨ä»£ç å´æŠ¥é”™äº†ï¼Œä½ ä»å®¹åœ°å‡‘è¿‡å»çœ‹ï¼Œå¸®ä»–æ‰¾bug, ä»£ç å¦‚ä¸‹ã€‚</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">a</span> <span class="o">=</span> <span class="o">[</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">,</span> <span class="s2">&quot;e&quot;</span> <span class="o">]</span>
</span><span class='line'><span class="n">a</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="o">[</span> <span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;z&quot;</span> <span class="o">]</span><span class="p">)</span>
</span><span class='line'><span class="c1">#=&gt;[ &quot;x&quot;, &quot;y&quot;, &quot;z&quot; ]  #TODO ä½ åŒäº‹é¢„æœŸå‡ºæ¥çš„ç»“æœ</span>
</span></code></pre></td></tr></table></div></figure>


<p>&emsp;å¤©å•¦å™œï¼Œä½ åŒäº‹æ€ä¹ˆè¿™ä¹ˆå¿«å°±ç”¨äº†ä½ åˆšå®šä¹‰çš„replace()æ–¹æ³•ï¼Œè¿˜SBä¸€æ ·åé¢åªå¸¦ä¸€ä¸ªå‚æ•°ï¼Œæˆ‘æ–¹æ³•é‡Œé¢æ˜æ˜æœ‰ä¸¤ä¸ªå‚æ•°ã€‚ã€‚ã€‚
ä½ åŒäº‹è¯´ï¼Œæˆ‘æ˜æ˜è®°å¾—Arrayç±»ä¸­æœ‰ä¸ªreplace()æ–¹æ³•ï¼Œæ˜¯æŠŠå½“å‰æ•°ç»„å†…å®¹æ›¿æ¢ï¼Œæ€ä¹ˆä¼šæŠ¥é”™å‘¢ï¼Ÿ
è¿™æ—¶ä½ å¥½åƒæ˜ç™½äº†ä»€ä¹ˆï¼ŒArrayç±»ä¸­æœ¬æ¥å°±æœ‰replace()æ–¹æ³•ï¼Œæˆ‘åˆšæ‰æ— æ„ä¸­æŠŠè¿™ä¸ªreplace()ç»™è¦†å†™äº†ï¼Œä¸ºäº†è¯æ˜ä½ çš„è¯´æ³•ï¼Œä½ æŠŠåˆšæ‰å®šä¹‰çš„æ–¹æ³•å»æ‰ï¼Œå¹¶åœ¨Arrayä¸­çš„æ–¹æ³•æ‰¾äº†ä¸€éï¼Œçœ‹ä¸‹æ˜¯å¦æœ‰å·²ç»å®šä¹‰è¿‡çš„replace()æ–¹æ³•</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="o">[].</span><span class="n">methods</span><span class="o">.</span><span class="n">grep</span><span class="p">(</span><span class="sr">/replace/</span><span class="p">)</span>
</span><span class='line'><span class="c1">#=&gt; [:replace] </span>
</span></code></pre></td></tr></table></div></figure>


<p>&emsp;å¥½äº†ï¼Œä½ çš„é—®é¢˜æ‰¾åˆ°äº†ï¼Œæ˜¯åˆšæ‰ä½ æ„æƒ³å¤©å¼€åœ°åœ¨Arrayç±»ä¸­åŠ äº†ä¸€ä¸ªå·²ç»å­˜åœ¨çš„æ–¹æ³•(è¦†å†™äº†æ–¹æ³•),ä½ æ‚„æ‚„åœ°æŠŠä»£ç æ”¹å›å»ï¼Œå¹¶è®©ä½ åŒäº‹pullä¸€ä¸‹ä»£ç ï¼Œå†è¯•ä¸‹ï¼Œåº”è¯¥ä¸ä¼šé”™ï¼Œä½ åŒäº‹pulläº†ä»£ç ï¼Œè¿è¡Œä¸€ä¸‹æœç„¶æ²¡é”™ï¼Œè¿™æ—¶æ›´ä¸€å¤´é›¾æ°´ï¼Œä½ è¯´æ²¡é—®é¢˜å°±è¡Œäº†ï¼Œå»åƒé¥­ã€‚ã€‚ã€‚</p>

<p>ç»è¿‡ä¸Šé¢çš„äº‹æƒ…ï¼Œä½ æ€»ç»“å‡ºäº†å‡ æ¡ç»éªŒ<br/>
1.  æ‰“å¼€ä¸€ä¸ªå·²å®šä¹‰çš„ç±»ï¼Œå¹¶å¾€é‡Œé¢æ·»åŠ æ–¹æ³•æ˜¯å¾ˆå±é™©çš„ï¼Œå› ä¸ºä½ å¹¶ä¸çŸ¥é“ç±»ä¸­æ˜¯å¦å·²ç»å­˜åœ¨è¿™ä¸ªæ–¹æ³•.<br/>
2.  çŒ´å­è¡¥ä¸æ˜¯å…¨å±€æ€§çš„ï¼Œä¸€æ—¦ä½ ä¿®æ”¹äº†Arrayä¸­çš„replace()æ–¹æ³•ï¼Œåˆ™ç³»ç»Ÿä¸­çš„æ‰€æœ‰æ•°ç»„éƒ½ä¼šåŠ è½½è¿™ä¸ªæ–¹æ³•<br/>
3.  çŒ´å­è¡¥ä¸æ˜¯ä¸å¯è§çš„ï¼Œå¦‚æœé‡å®šä¹‰äº†Array#replace()  æ–¹æ³•ï¼Œåˆ™å¾ˆéš¾å‘ç°è¿™ä¸ªæ–¹æ³•è¢«ä¿®æ”¹äº†ï¼Œç”±äºæ˜¯å…¨å±€æ€§çš„ï¼Œä½ å¾ˆéš¾å‘ç°é—®é¢˜æ‰€åœ¨ï¼Œä¹Ÿå¾ˆéš¾æ‰¾å‡ºåœ¨å“ªä¸ªåœ°æ–¹å®šä¹‰äº†è¿™ä¸ªæ–¹æ³•ã€‚</p>

<h3>å¦‚ä½•é¿å…çŒ´å­è¡¥ä¸å¼•èµ·çš„é—®é¢˜</h3>

<p>æˆ‘ä»¬å…ˆæ¥çœ‹ä¸ªä¾‹å­ï¼Œ</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">module</span> <span class="nn">M</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">my_method</span>
</span><span class='line'>    <span class="s2">&quot;M#my_method()&quot;</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">class</span> <span class="nc">C</span>
</span><span class='line'>  <span class="kp">include</span> <span class="n">M</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">class</span> <span class="nc">D</span> <span class="o">&lt;</span> <span class="n">C</span><span class="p">;</span> <span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="n">D</span><span class="o">.</span><span class="n">new</span><span class="o">.</span><span class="n">my_method</span><span class="p">()</span>  <span class="c1">#=&gt;&quot;M#my_method()&quot;</span>
</span><span class='line'><span class="c1">#TODO æŸ¥çœ‹ç±»Dçš„æ‰€çš„çˆ¶ç±»</span>
</span><span class='line'><span class="n">D</span><span class="o">.</span><span class="n">ancestors</span>   <span class="c1">#=&gt; [D, C, M, Object, Kernel, BasicObject]</span>
</span></code></pre></td></tr></table></div></figure>


<p>&emsp;ä»ä¸Šé¢åˆ—å­å¯ä»¥çœ‹åˆ°ï¼Œå½“æˆ‘ä»¬åœ¨ä¸€ä¸ªç±»ä¸­åŒ…å«(include)ä¸€ä¸ªæ¨¡å—æ—¶ï¼ŒRubyåˆ›å»ºäº†ä¸€ä¸ªå°è£…è¯¥æ¨¡å—çš„åŒ¿åç±»ï¼Œå¹¶æŠŠè¿™ä¸ªåŒ¿åç±»æ’å…¥åˆ°ç¥–å…ˆé“¾ä¸­ï¼Œå…¶åœ¨é“¾ä¸­çš„ä½ç½®æ­£å¥½åŒ…å«åœ¨å®ƒçš„ç±»çš„ä¸Šæ–¹ï¼Œè¿™äº›å°è£…çš„ç±»å°±å«åš<strong><em>åŒ…å«ç±»(include class)</em></strong>,æˆ–è€…å«<strong><em>ä»£ç†ç±»(proxy class)</em></strong>ã€‚</p>

<p>æ¥ä¸‹æ¥æˆ‘ä»¬é‡æ–°æ‰“å¼€rubyçš„irb,è¯•ç€æŸ¥çœ‹ä¸€ä¸‹Arrayçš„ç¥–å…ˆé“¾</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="nb">Array</span><span class="o">.</span><span class="n">ancestors</span>
</span><span class='line'><span class="o">=&gt;</span> <span class="o">[</span><span class="nb">Array</span><span class="p">,</span> <span class="no">Enumerable</span><span class="p">,</span> <span class="no">Object</span><span class="p">,</span> <span class="no">Kernel</span><span class="p">,</span> <span class="no">BasicObject</span><span class="o">]</span>
</span><span class='line'><span class="c1">#TODOå¯ä»¥çœ‹åˆ°Rubyåˆå§‹Arrayç±»ä¸­çš„ç¥–å…ˆä¸€å…±æœ‰5ä¸ª</span>
</span></code></pre></td></tr></table></div></figure>


<p>&emsp;ç„¶åæˆ‘ä»¬å†æ‰“å¼€railsç¯å¢ƒä¸‹çš„console(å‘½ä»¤rails console),å…¶ç¯å¢ƒåŠ è½½äº†åŒ…æ‹¬railsçš„å„ç§gemsæºç å’Œä½ è‡ªå·±çš„ä»£ç ï¼ŒåŒæ ·çš„æŸ¥çœ‹Arrayä¸­çš„ç¥–å…ˆé“¾</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="nb">Array</span><span class="o">.</span><span class="n">ancestors</span>
</span><span class='line'><span class="o">=&gt;</span> <span class="o">[</span><span class="nb">Array</span><span class="p">,</span> <span class="no">RQRCode</span><span class="o">::</span><span class="no">CoreExtensions</span><span class="o">::</span><span class="nb">Array</span><span class="o">::</span><span class="no">Behavior</span><span class="p">,</span> <span class="no">V8</span><span class="o">::</span><span class="no">Conversion</span><span class="o">::</span><span class="nb">Array</span><span class="p">,</span> <span class="no">JSON</span><span class="o">::</span><span class="no">Ext</span><span class="o">::</span><span class="no">Generator</span><span class="o">::</span><span class="no">GeneratorMethods</span><span class="o">::</span><span class="nb">Array</span><span class="p">,</span> <span class="no">Enumerable</span><span class="p">,</span> <span class="no">Object</span><span class="p">,</span> <span class="no">PP</span><span class="o">::</span><span class="no">ObjectMixin</span><span class="p">,</span> <span class="no">ActiveSupport</span><span class="o">::</span><span class="no">Dependencies</span><span class="o">::</span><span class="no">Loadable</span><span class="p">,</span> <span class="no">V8</span><span class="o">::</span><span class="no">Conversion</span><span class="o">::</span><span class="no">Object</span><span class="p">,</span> <span class="no">JSON</span><span class="o">::</span><span class="no">Ext</span><span class="o">::</span><span class="no">Generator</span><span class="o">::</span><span class="no">GeneratorMethods</span><span class="o">::</span><span class="no">Object</span><span class="p">,</span> <span class="no">Kernel</span><span class="p">,</span> <span class="no">BasicObject</span><span class="o">]</span>
</span></code></pre></td></tr></table></div></figure>


<p>&emsp;å¤©å‘ï¼ŒArrayç±»æ€ä¹ˆå¤šå‡ºæ¥è¿™ä¹ˆå¤šçˆ¶ç±»ï¼Œä¸ºäº†æ‰¾å‡ºåŸå› ï¼Œä½ éšä¾¿æ‰¾äº†ä¸ªçˆ¶ç±»ActiveSupport::Dependencies::Loadableç ”ç©¶ä¸‹ï¼Œå¯ä»¥çœ‹åˆ°æºç <a href="https://github.com/rails/rails/blob/f243e7f0d0b2cef350127fd518532fedb65f0bd0/activesupport/lib/active_support/dependencies.rb">ç‚¹è¿™é‡Œ</a>,å…¶ä¸­æœ‰ä¸€ä¸ªhook!æ–¹æ³•</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">def</span> <span class="nf">hook!</span>
</span><span class='line'>  <span class="no">Object</span><span class="o">.</span><span class="n">class_eval</span> <span class="p">{</span> <span class="kp">include</span> <span class="no">Loadable</span> <span class="p">}</span>
</span><span class='line'>  <span class="no">Module</span><span class="o">.</span><span class="n">class_eval</span> <span class="p">{</span> <span class="kp">include</span> <span class="no">ModuleConstMissing</span> <span class="p">}</span>
</span><span class='line'>  <span class="no">Exception</span><span class="o">.</span><span class="n">class_eval</span> <span class="p">{</span> <span class="kp">include</span> <span class="no">Blamable</span> <span class="p">}</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>&emsp;å®ƒçš„ä½œç”¨å°±æ˜¯å°†æ‰€éœ€çš„å„ç§Meta ProgrammingæŒ‚åˆ°Objectå’ŒModuleä¸‹ï¼Œè€Œå…¶å®è¿™é‡ŒActiveSupport::Dependencies::Loadableå¹¶ä¸æ˜¯ä¸€ä¸ªçœŸæ­£çš„ç±»ï¼Œçœ‹æºç æˆ‘ä»¬å°±å¯ä»¥å‘ç°ï¼Œå®ƒå…¶å®ƒæ˜¯ä¸€ä¸ªæ¨¡å—ï¼Œè¢«includeåˆ°äº†Objectç±»é‡Œï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬ä¸Šé¢è®²åˆ°çš„ï¼ŒActiveSupport::Dependencies::Loadableå…¶å®æ˜¯ä¸€ä¸ªä»£ç†ç±»ï¼Œé‚£ä¸ºä»€ä¹ˆè¦è¿™æ ·åšå‘¢ï¼Œå› ä¸ºä½¿ç”¨æ¨¡å—(å¸¦äº†å„ç§namespaceçš„)å¯ä»¥è®©çŒ´å­è¡¥ä¸æ›´æ˜æ˜¾ä¸€äº›ï¼Œæƒ³å¯¹è€Œè¨€æ¯”è¾ƒå®¹æ˜“è¿½è¸ªåˆ°ä»–ä»¬ï¼Œå› ä¸ºè¿™ç§æ–¹å¼è‡³å°‘å¯ä»¥åœ¨ç¥–å…ˆç±»ä¸­çœ‹åˆ°è¿™ä¸ªæ¨¡å—ã€‚</p>

<p>æ‰€ä»¥ä½¿ç”¨<strong><em>å‘½åç©ºé—´(namespace)</em></strong>å¯ä»¥æœ‰æ•ˆåœ°è§£å†³ç±»åå†²çªï¼Œä»è€Œé¿å…çŒ´å­è¡¥ä¸å¼•èµ·çš„é—®é¢˜</p>

<h3>Railsä¸­å¦‚ä½•é˜²æ­¢çŒ´å­è¡¥ä¸å¼•èµ·çš„é—®é¢˜</h3>

<p>&emsp;railsåœ¨ActviteRecordä¸­ï¼Œæœ‰ä¸ªinstance_method_already_implemented?()æ–¹æ³•ï¼Œç‚¹å‡»<a href="https://github.com/rails/rails/blob/master/activerecord/lib/active_record/attribute_methods.rb">æŸ¥çœ‹æºç </a>,å®ƒä¼šåœ¨ä½ å®šä¹‰ä¸€ä¸ªåŠ¨æ€æ–¹æ³•å‰ï¼Œé¦–å…ˆä¼šæ£€æŸ¥æœ‰æ²¡æœ‰åŒåæ–¹æ³•å­˜åœ¨ï¼Œå¦‚æœæœ‰çš„è¯ï¼Œæ–¹æ³•ä¼šæŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ï¼Œå¦åˆ™è¿”å›false,è¯´æ˜å¯ä»¥å®šä¹‰æ–¹æ³•ï¼Œä¸¾ä¸ªæ —å­</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">Patient</span> <span class="o">&lt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">save</span>
</span><span class='line'>    <span class="s1">&#39;already defined by Active Record&#39;</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="no">Patient</span><span class="o">.</span><span class="n">instance_method_already_implemented?</span><span class="p">(</span><span class="ss">:save</span><span class="p">)</span>
</span><span class='line'><span class="c1">#=&gt;  ActiveRecord::DangerousAttributeError: save is defined by Active Record. Check to make sure that you don&#39;t have an attribute or method with the same name.</span>
</span><span class='line'><span class="no">Patient</span><span class="o">.</span><span class="n">instance_method_already_implemented?</span><span class="p">(</span><span class="ss">:aaaaaa</span><span class="p">)</span>
</span><span class='line'> <span class="c1">#=&gt; false </span>
</span></code></pre></td></tr></table></div></figure>


<h3>Rakeä¸­å¦‚ä½•é˜²æ­¢çŒ´å­è¡¥ä¸å¼•èµ·çš„é—®é¢˜</h3>

<p>&emsp;åœ¨rake ä¸­æœ‰ä¸€ä¸ªåä¸ºModule#rake_extension()çš„æ–¹æ³•ï¼Œè¿™é‡Œçœ‹æºç <a href="https://github.com/ruby/rake/blob/93e55a4ef1dbaee42f0f355f86d837c4e2551fc1/lib/rake/ext/core.rb">ç‚¹å‡»æŸ¥çœ‹</a></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'>  <span class="k">def</span> <span class="nf">rake_extension</span><span class="p">(</span><span class="nb">method</span><span class="p">)</span> <span class="c1"># :nodoc:</span>
</span><span class='line'>    <span class="k">if</span> <span class="nb">method_defined?</span><span class="p">(</span><span class="nb">method</span><span class="p">)</span>
</span><span class='line'>      <span class="vg">$stderr</span><span class="o">.</span><span class="n">puts</span> <span class="s2">&quot;WARNING: Possible conflict with Rake extension: &quot;</span> <span class="o">+</span>
</span><span class='line'>        <span class="s2">&quot;</span><span class="si">#{</span><span class="nb">self</span><span class="si">}</span><span class="s2">#</span><span class="si">#{</span><span class="nb">method</span><span class="si">}</span><span class="s2"> already exists&quot;</span>
</span><span class='line'>    <span class="k">else</span>
</span><span class='line'>      <span class="k">yield</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>&emsp;Rakeåœ¨å®ƒæƒ³æ‰“å¼€ç±»æ¥æ·»åŠ æ–¹æ³•æ—¶ï¼Œä¼šä½¿ç”¨rake_extension()æ–¹æ³•æ£€æŸ¥å®ƒæ˜¯å¦å·²ç»å­˜åœ¨ï¼Œå¦‚æœé”™è¯¯åœ°é‡å®šä¹‰ä¸€ä¸ªå·²ç»å­˜åœ¨çš„æ–¹æ³•ï¼Œé‚£ä¹ˆrake_extension()ä¼šæŠ›å‡ºä¸€ä¸ªè­¦å‘Šä¿¡æ¯</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="nb">require</span> <span class="s1">&#39;rake&#39;</span>
</span><span class='line'><span class="k">class</span> <span class="nc">String</span>
</span><span class='line'>  <span class="n">rake_extension</span><span class="p">(</span><span class="s2">&quot;xyz&quot;</span><span class="p">)</span> <span class="k">do</span>
</span><span class='line'>    <span class="k">def</span> <span class="nf">xyz</span>
</span><span class='line'>      <span class="s2">&quot;xyz&quot;</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'><span class="c1">#=&gt; :xyz</span>
</span><span class='line'>
</span><span class='line'><span class="k">class</span> <span class="nc">String</span>
</span><span class='line'>  <span class="n">rake_extension</span><span class="p">(</span><span class="s2">&quot;to_s&quot;</span><span class="p">)</span> <span class="k">do</span>
</span><span class='line'>    <span class="k">def</span> <span class="nf">to_s</span>
</span><span class='line'>      <span class="s2">&quot;to_s&quot;</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="c1">#=&gt; WARNING: Possible conflict with Rake extension: String#to_s already exists</span>
</span></code></pre></td></tr></table></div></figure>


<p>&emsp;æœ€åï¼Œåœ¨ä½¿ç”¨çŒ´å­è¡¥ä¸çš„æ—¶å€™ï¼Œåƒä¸‡ä¸è¦è¦†å†™ã€ä¿®æ”¹äº†åŸç±»ä¸­çš„æ–¹æ³•ï¼Œä¸ç„¶ä½ ä¼šèµ°ä¸Šä¸€æ¡ä¸å½’è·¯çš„ã€‚</p>

<h6>å‚è€ƒèµ„æ–™</h6>

<p>ã€ŠRubyå…ƒç¼–ç¨‹ã€‹<br/>
<a href="https://en.wikipedia.org/wiki/Monkey_patch">https://en.wikipedia.org/wiki/Monkey_patch</a>
<a href="https://web.archive.org/web/20120730014107/http://wiki.zope.org/zope2/MonkeyPatch">https://web.archive.org/web/20120730014107/http://wiki.zope.org/zope2/MonkeyPatch</a>
<a href="https://github.com/rails/rails">https://github.com/rails/rails</a><br/>
<a href="http://thekaiway.com/2013/07/04/code-loading-of-rails/">http://thekaiway.com/2013/07/04/code-loading-of-rails/</a>
<a href="https://github.com/ruby/rake/blob/master/lib/rake/ext/core.rb">https://github.com/ruby/rake/blob/master/lib/rake/ext/core.rb</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[å›é¡¾2016å¹´]]></title>
    <link href="http://xuyao.club/blog/2017/01/16/review-2016/"/>
    <updated>2017-01-16T19:54:57+08:00</updated>
    <id>http://xuyao.club/blog/2017/01/16/review-2016</id>
    <content type="html"><![CDATA[<p>&emsp;å¹´è¿‡å®Œäº†ï¼Œå‡æœŸä¹Ÿæ²¡äº†ï¼Œå‹å²é’±ä¹Ÿå‘å…‰äº†ï¼Œæ˜¯æ—¶å€™åä¸‹æ¥å†™å†™æ€»ç»“äº†ã€‚</p>

<!-- more -->


<p>&emsp;2016æ˜¯ä¸å¹³å‡¡çš„ä¸€å¹´ï¼ŒæœŸé—´ç»å†äº†å¾ˆå¤šäº‹æƒ…ï¼Œå¥½äº‹åäº‹éƒ½æœ‰ï¼Œæ­£æ˜¯ç»å†äº†æœ‰äº›äº‹æƒ…ï¼Œæ‰å‘ç°äº†ä¸ä¸€æ ·çš„ã€å¦ä¸€é¢çš„æˆ‘ï¼Œçªç„¶å‘ç°å¾ˆå¤šäº‹æƒ…ç¡®å®æ˜¯é€¼ä¸€ä¸‹æ‰åšçš„æ›´å¥½ã€‚
æ›²æŠ˜çš„2015 <br/>
&emsp;15å¹´å¹´ä¸­æ¢äº†ä¸€ä»½å·¥ä½œï¼Œå†™ç®€å†çš„æ—¶å€™çªç„¶å‘ç°è‡ªå·±å·¥ä½œå·²ç»å¿«ä¸‰å¹´äº†ï¼Œæœ‰ç‚¹æ„Ÿæ…¨ï¼Œä¸‰å¹´çœŸçš„æ˜¯ä¸€æ™ƒå°±è¿‡å»äº†ï¼Œå›å¤´æƒ³æƒ³ä¸‰å¹´çš„æŠ€æœ¯æ²‰æ·€ï¼Œæ€»è§‰å¾—è‡ªå·±è¿›æ­¥å¾ˆæ…¢ï¼Œçœ‹åˆ«äººä¸‰å¹´çš„æŠ€æœ¯ç»éªŒæ„Ÿè§‰å¾ˆç‰›é€¼çš„æ ·å­ã€‚æ›´è¦å‘½çš„æ˜¯å‘ç°è‡ªå·±å·¥ä½œä¸‰å¹´ï¼Œèº«ä¸Šç«Ÿç„¶æ²¡æœ‰å¤šå°‘ç»“ä½™èµ„é‡‘ï¼Œæœ‰ç§ä¸‰å¹´ç™½æ´»çš„æ„Ÿè§‰ã€‚<br/>
&emsp;15å¹´ä¸ŠåŠå¹´è‚¡å¸‚ç–¯ç‹‚ä¸Šæ¶¨ï¼Œèº«è¾¹åŒäº‹éƒ½åœ¨è°ˆè®ºè‡ªå·±çš„è‚¡ç¥¨æ¶¨äº†å¤šå°‘ï¼Œæˆ‘è‚¯å®šçŸ¥é“è‚¡ç¥¨æ˜¯é«˜é£é™©çš„ä¸œè¥¿ï¼Œæœºæ™ºçš„æˆ‘æœæ–­ä¹°äº†ç¨å¾®ä½é£é™©çš„åŸºé‡‘ï¼Œä¸€ä¸¤ä¸ªæœˆåï¼ŒåŸºé‡‘æœç„¶æ¶¨äº†ä¸€ç‚¹ï¼Œæ­£å½“äº«å—ç€è‡ªå·±â€˜æŠ•èµ„â€™çš„æˆæœæ—¶ï¼Œäº”æœˆä»½è‚¡å¸‚ä¸€è·¯ç‹‚è·Œï¼Œåˆ°9æœˆä»½åŸºé‡‘è·Œäº†50%ï¼ŒæˆåŠŸåœ°è¢«å‰²äº†éŸ­èœï¼Œå¥—çš„è€ç‰¢å›ºäº†ï¼Œä»æ­¤ä¸€å¬è§è‚¡ç¥¨åŸºé‡‘å°±æ¥æ°”ã€‚</p>

<center>  
<img src="http://yydys-prd-shop.oss-cn-hangzhou.aliyuncs.com/mall/banners/202557dcs3ch2rfllii7e1.jpg" /> 
</center>


<p>
&emsp;å› ä¸ºæ¢äº†å·¥ä½œå’Œä½æ‰€ï¼Œä¸Šç­éœ€è¦ååœ°é“ï¼Œååœ°é“æœ‰ä¸€æ®µç©ºä½™çš„æ—¶é—´ï¼Œä¸ºäº†æ‰“å‘æ—¶é—´ï¼Œå¥³æœ‹å‹ç»™æˆ‘ä¹°äº†ä¸ªkindleï¼Œåœ¨åœ°é“ä¸Šçœ‹çœ‹ä¹¦ä¹Ÿæ˜¯æå¥½çš„ã€‚åœ¨kindleç”µå­ä¹¦1å…ƒä¸“åŒºä¸‹è½½äº†ä¸€äº›ç‰¹ä»·ä¹¦ï¼Œå½“ç„¶ç¬¬ä¸€æœ¬è‚¯å®šæ˜¯çº¢æ¥¼æ¢¦äº†ï¼Œè¿˜ä¸‹è½½äº†ä¸€äº›è¯„è®ºå¾ˆé«˜çš„ä¹¦ï¼Œæœ‰ã€å¯Œçˆ¸çˆ¸ï¼Œç©·çˆ¸çˆ¸ã€‘ï¼Œã€å°ç‹—é’±é’±ã€‘ç­‰ï¼Œçœ‹å®Œå¯Œçˆ¸çˆ¸ç©·çˆ¸çˆ¸åï¼Œæ„Ÿè§‰ä¸‰è§‚éƒ½è¢«åˆ·æ–°äº†ï¼Œä¹¦ä¸­çš„è§‚ç‚¹é’ˆé’ˆè§è¡€çš„é˜è¿°äº†è´¢å¯Œå¢é•¿åŠæ¶ˆè€—ï¼Œåœ¨è¿™é‡Œä¹Ÿæ‰¾åˆ°ä¸ºä»€ä¹ˆè‡ªå·±æ˜¯æ²¡å­˜åˆ°é’±çš„åŸå› ï¼Œè‡ªå·±é™¤äº†å·¥ä½œæ²¡æœ‰å…¶ä»–çš„èµ„é‡‘æ¥æºï¼Œè€Œä¸”ç»å¸¸ä¹°ä¸€ä¸‹ä¸å¸¸ç”¨çš„æ¶ˆè€—å“åŠè´Ÿå€ºï¼Œåœ¨èµ„é‡‘æ¥æºä¸è¶³ï¼Œè´Ÿå€ºè¿‡å¤šçš„æƒ…å†µï¼Œå¯¼è‡´ç§¯è“„ä¸¥é‡å­˜å‚¨ä¸è¶³ï¼Œä¸å¾—ä¸è¯´çœŸçš„æ˜¯ä¸€æœ¬ç†è´¢çš„å¯è’™å¥½ä¹¦ï¼Œå°ç‹—é’±é’±ä¹Ÿæ˜¯éå¸¸å¥½çš„ä¸€æœ¬ç†è´¢å¯è’™ä¹¦ï¼Œä¹¦ä¸­ç«™åœ¨å°å­©å­çš„è§‚ç‚¹é˜è¿°äº†å¦‚ä½•ä»èº«è¾¹çš„ç”Ÿæ´»å°äº‹å‘ç°èµšé’±çš„æœºä¼šï¼Œå¹¶ä¸”å¦‚ä½•ä½¿ç”¨è¿™ç¬”èµšåˆ°çš„èµ„é‡‘ï¼Œè®©é’±ç”Ÿé’±ã€‚</p>

<center>
<img width="315px" height="430px" src="http://7xkvxi.com1.z0.glb.clouddn.com/u=935494884,700337048&fm=23&gp=0.jpg" />
<img src="http://7xkvxi.com1.z0.glb.clouddn.com/timg.jpeg" />
</center>


<p>&emsp;å¯¹ç†è´¢æœ‰äº†ä¸€å®šäº†è§£åï¼Œæ‰å‘ç°è‡ªå·±åœ¨15å¹´è‚¡å¸‚ç–¯ç‹‚çš„æ—¶å€™ä¹°åŸºé‡‘æ˜¯å¤šä¹ˆæ„šè ¢çš„ä¸€ä»¶äº‹ï¼Œå®Œå…¨æ˜¯ç›²ç›®è·Ÿé£ï¼Œæ²¡æœ‰è‡ªå·±çš„è§‚å¿µï¼Œä¸è¿‡ç°åœ¨æƒ³æƒ³ä¹Ÿæ²¡æœ‰é‚£ä¹ˆæƒ‹æƒœï¼Œå°±ç®—æ˜¯äº¤äº†ä¸€ç¬”å­¦è´¹ï¼Œè‡³å°‘è¿™ä»¶äº‹ä¹‹åè®©æˆ‘æœ‰å…´è¶£çœ‹äº†å¾ˆå¤šæŠ•èµ„ç†è´¢çš„ä¹¦ï¼Œå¹¶ä»ä¸­å­¦åˆ°äº†å¾ˆå¤šç†è´¢çš„çŸ¥è¯†ï¼Œæ„Ÿè§‰æ‰“å¼€äº†å¦ä¸€æ‰‡æ€æƒ³å¤§é—¨ä¸€æ ·ï¼Œå‘ç°ä¸€ä¸ªå…¨æ–°çš„ä¸–ç•Œï¼Œè¿™æ ·æƒ³æƒ³ä¹Ÿå°±ä¸é‚£ä¹ˆå¯æƒœäº†ã€‚
&emsp;è¯´åˆ°ç†è´¢çš„ä¹¦ï¼Œä¸å¾—ä¸è¯´å¦ä¸€æœ¬ç†è´¢åŠæˆåŠŸå­¦çš„ä¹¦ã€æ€è€ƒè‡´å¯Œã€‘ï¼Œè¿™æœ¬ä¹¦ç»™æˆ‘å°è±¡å¾ˆæ·±åˆ»ï¼Œä½œè€…ä¸€ç›´æŒ‡å‡ºï¼ŒæˆåŠŸæ˜¯æœ‰æ–¹æ³•çš„ï¼Œä»–é‡‡è®¿çš„200ä½åäººä¸­ï¼Œæ¯ä¸ªäººæˆåŠŸçš„æ–¹æ³•éƒ½å‡ºå¥‡çš„ä¸€è‡´ï¼Œæ²¡æœ‰äººèƒ½éšéšä¾¿ä¾¿å°±æˆåŠŸï¼Œå°±èƒ½èµšåˆ°é’±ï¼Œæ¯ä¸ªäººéƒ½ä»˜å‡ºäº†å¸¸äººä¸èƒ½æ¯”çš„æ±—æ°´ï¼Œæ¯…åŠ›ã€‚ç›´åˆ°ç°åœ¨æˆ‘è¿˜ä¼šä¸æ—¶ç¿»å‡ºè¿™æœ¬ä¹¦æ¥çœ‹çœ‹ã€‚</p>

<center>
  <img width="400", height="500" src="http://7xkvxi.com1.z0.glb.clouddn.com/timg%20%281%29.jpeg"  />
</center>


<p>&emsp;çœ‹äº†è¿™ä¹ˆå¤šç†è´¢ä¹¦åï¼Œè‡ªå·±ä¹ŸåŠ¨æ‰‹å®è·µäº†ä¸€äº›ï¼Œå¸å–äº†ä¸Šæ¬¡çš„æ•™è®­ï¼Œå®šæŠ•äº†ä¸€äº›åŸºé‡‘ï¼Œä¹°äº†ä¸€äº›å€ºåˆ¸åŸºé‡‘å’Œä¸€äº›ä¿¡èª‰æ¯”è¾ƒå¥½çš„P2Pç†è´¢ã€‚
æŠ€æœ¯ä¸Šé¢è‡ªå·±è¿˜æ˜¯æ„Ÿè§‰è¿›æ­¥ä¸æ˜¯å¾ˆå¤§ï¼Œåœ¨åœ°é“ä¸Šçœ‹è¿‡ä¸€äº›mysql,ruby,redisæ–¹é¢çš„ä¹¦ï¼Œä¹Ÿç®—æ˜¯åŠ å¼ºä¸€ä¸‹ç†è§£å§ï¼Œä¸è¿‡æœ‰ä¸€ç‚¹æ¯”è¾ƒæ¬£æ…°çš„æ˜¯ï¼Œç°åœ¨åšé¡¹ç›®ï¼Œä¸ä¼šé‡åˆ°é‚£ç§å†™ä¸å‡ºæ¥çš„çª˜å¢ƒï¼Œåªæ˜¯å†™çš„å¥½ä¸å¥½çš„é—®é¢˜ï¼Œå§‘ä¸”ç®—æ˜¯ä¸€ç›´è¿›æ­¥çš„ï¼Œä¼°è®¡æ˜å¹´è¿™ç§ä¼˜è¶Šæ„Ÿå°±æ²¡äº†ï¼Œå› ä¸ºå·¥ä½œè¿™ä¹ˆå¤šå¹´ã€‚æœ‰è¿˜æœ‰å†™ä¸å‡ºæ¥çš„ä»£ç ï¼Œé‚£çœŸæ˜¯å¤ªä¸¢äººäº†ã€‚</p>

<p>ä¸çŸ¥é“å†™ä»€ä¹ˆå¥½ï¼Œå°±åˆ—ä¸¾ä¸€äº›å»å¹´è§‰å¾—åšè¿‡æœ‰æ„ä¹‰çš„äº‹æƒ…å§<br/>
1.   ä¸€æœˆä»½å¼€å§‹å®šæŠ•ä¸€åªä¸­å°æ¿çš„åŸºé‡‘ä¸€ç›´åˆ°ç°åœ¨ï¼Œæœ‰ä¸€å¹´å¤šäº†å§ï¼Œå»å¹´åˆ›ä¸šæ¿ä¸‹è·Œäº†å¾ˆå¤šï¼ŒåŸºé‡‘ç›®å‰äºæŸä¸­ï¼Œä½†æ˜¯å¹¶ä¸æ‹…å¿ƒï¼Œå®šæŠ•è¶Šæ˜¯ä¸‹è·Œçš„æ—¶å€™ï¼Œè¶Šæ˜¯è¦åšæŒå®šæŠ•ã€‚<br/>
2.   ä¸‰æœˆå¼€å§‹å¼€å¯äº†æ¯æœˆè®°è´¦çš„ä¹ æƒ¯ï¼Œè®°å¾—æ¯”è¾ƒç®€å•ï¼Œå°±æ˜¯æ¯æœˆåº•ç»Ÿè®¡ä¸€ä¸‹ä¸Šæœˆå¤§æ¦‚çš„èŠ±é”€ï¼Œå’Œä¸Šæœˆçš„ç»“ä½™ï¼Œè¿™æ ·èƒ½æ¯”è¾ƒç›´è§‚åœ°çŸ¥é“é’±èŠ±å“ªå»äº†ï¼Œè¿™æ˜¯ä¸€ä¸ªå¥½ä¹ æƒ¯ï¼Œéœ€è¦ä¸€ç›´åšæŒä¸‹å»<br/>
3.   å››æœˆä»½å¼€å§‹å®šæŠ•äº†ä¸€åªæ²ªæ·±300çš„æŒ‡æ•°åŸºé‡‘ï¼Œç›®å‰ä¸ºæ­¢æœ‰5%çš„æ”¶ç›Šã€‚<br/>
4.   ç«¯åˆå’Œå¥³æœ‹å‹ä¸€èµ·ç¬¬ä¸€æ¬¡å›äº†èººå®¶é‡Œã€‚<br/>
5.   å…­æœˆä»½å¼€å§‹åšå…¬å¸çš„ä¸€ä¸ªè‡ªåŠ¨åŒ–æµ‹è¯•çš„é¡¹ç›®ï¼Œç¬¬ä¸€æ¬¡åšè¿™ç§æµ‹è¯•æ–¹é¢çš„é¡¹ç›®ï¼Œæ„Ÿè§‰è¿˜æ˜¯æœ‰ç‚¹æ„ä¹‰çš„ã€‚<br/>
6.   å…«æœˆä»½å’Œå¥³æœ‹å‹ç¬¬ä¸€æ¬¡å›äº†å¥¹çš„å®¶ï¼Œæœ‰ç‚¹æ¿€åŠ¨ï¼Œä¹Ÿç¥è´ºå¥³æœ‹å‹çš„å¼Ÿå¼Ÿè£è·å¸‚é‡Œæ–‡ç§‘çŠ¶å…ƒï¼Œè¢«å¤æ—¦å¤§å­¦å½•å–<br/>
7.   åä¸€æœˆå¼€å§‹åœ¨è±†ç“£ä¸ŠæŒç»­è®°å½•æ¯å‘¨æ€»ç»“ï¼Œä¸»è¦æ˜¯è®°å½•ä¸€ä¸‹ä¸Šå‘¨å·¥ä½œã€å­¦ä¹ æƒ…å†µã€åŠä¸€äº›æ„Ÿæƒ³ï¼Œè¿™ä¹Ÿæ˜¯ä¸€ä¸ªå¥½ä¹ æƒ¯ï¼Œå°†ä¼šä¸€ç›´æŒç»­ä¸‹å»ã€‚</p>

<h2>æœªå®Œï¼Œä¸ç»­ã€‚ã€‚ã€‚</h2>

<center><img width="300" height="300" src="http://7xkvxi.com1.z0.glb.clouddn.com/e04d442c11dfa9ec094b1f0664d0f703908fc1dc.jpg" /></center>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[å…³äºrails-jwplayer Gem]]></title>
    <link href="http://xuyao.club/blog/2017/01/16/about-gem-rails-jwplayer/"/>
    <updated>2017-01-16T19:54:57+08:00</updated>
    <id>http://xuyao.club/blog/2017/01/16/about-gem-rails-jwplayer</id>
    <content type="html"><![CDATA[<p>&emsp;è¿™å‡ å¤©å…¬å¸æœ‰ä¸ªä¸šåŠ¡ï¼Œæœ‰ä¸€äº›è¯¾ç¨‹ï¼ˆè§†é¢‘æ’­æ”¾ï¼‰éœ€è¦ç»Ÿè®¡ç”¨æˆ·çš„è§‚çœ‹æ•°æ®ï¼ŒåŒ…æ‹¬ç”¨æˆ·çœ‹äº†å¤šé•¿æ—¶é—´ï¼Œåœ¨å“ªäº›åœ°æ–¹å¿«è¿›äº†ï¼Œå“ªäº›åœ°æ–¹æš‚åœäº†ï¼Œå“ªäº›åœ°æ–¹é‡å¤çœ‹äº†ç­‰ä¸€äº›ç”¨æˆ·çš„è¡Œä¸ºæ“ä½œï¼Œè°ƒæŸ¥äº†ä¸€ç¿»ï¼ŒH5è‡ªå¸¦çš„videoæ˜¯ä¸æ”¯æŒè¿™äº›åŠŸèƒ½ï¼Œå¥½åœ¨å‘ç°å›½å¤–æœ‰ä¸ª<a href="https://www.jwplayer.com/">jwplayer</a>çš„è§†é¢‘æ’­æ”¾æ’ä»¶ï¼ŒåŠŸèƒ½ä¸æ˜¯ä¸€èˆ¬çš„å¼ºå¤§ï¼Œæ”¯æŒå„ç§è‡ªå®šä¹‰åŠŸèƒ½ï¼Œäºæ˜¯çœ‹å®Œæ–‡æ¡£åï¼Œè‡ªå·±å°±é›†æˆäº†ä¸€ä¸ªåŸºäºjwplayerçš„rails gemï¼ˆ<a href="https://github.com/xuyao91/rails-jwplayer">rails-jwplayer</a>ï¼‰ï¼Œä¾¿äºä»¥åè‡ªå·±ç”¨ã€‚</p>

<p>&emsp;ç›®å‰åŠŸèƒ½åšçš„æ¯”è¾ƒç®€å•ï¼Œå°±æ˜¯é›†æˆäº†ä¸€äº›åŸºæœ¬çš„åŠŸèƒ½ï¼ŒåæœŸä¼šæŠŠspecæµ‹è¯•è¡¥é½ï¼ŒåŠå†åšä¸€äº›æ·±åº¦çš„é›†å¯æˆã€‚
å…·ä½“å¦‚ä½•ä½¿ç”¨ï¼Œå¯ä»¥åˆ°githubä¸Šçœ‹ä¸‹<a href="https://github.com/xuyao91/rails-jwplayer/blob/master/README.md">rails-jwplayer</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Appè‡ªåŠ¨åŒ–æµ‹è¯•å¹³å°æ­å»ºè®°å½•ä¹‹é—®é¢˜æ±‡æ€»]]></title>
    <link href="http://xuyao.club/blog/2016/12/05/2app-text-automation-platform-building-record-of-some-issues/"/>
    <updated>2016-12-05T18:25:38+08:00</updated>
    <id>http://xuyao.club/blog/2016/12/05/2app-text-automation-platform-building-record-of-some-issues</id>
    <content type="html"><![CDATA[<p>æ­å»ºæµ‹è¯•å¹³å°åŠå†™æµ‹è¯•caseæ—¶ï¼Œé‡åˆ°äº†ä¸€äº›é—®é¢˜ï¼Œç°åœ¨ç»Ÿä¸€åšä¸ªæ±‡æ€»ï¼Œè®°å½•ä¸€ä¸‹</p>

<!-- more -->


<h3>é—®é¢˜1ï¼š æµ‹è¯•æ•°æ®çš„é—®é¢˜</h3>

<p>a,æµ‹è¯•æ¯ä¸ªcaseæ—¶ï¼Œéƒ½ä¼šäº§ç”Ÿæµ‹è¯•æ•°æ®ï¼Œæ€ä¹ˆå¤„ç†æµ‹è¯•æ•°æ®<br/>
b,æœ‰äº›caseæœ‰ä¸Šä¸‹æ–‡é€»è¾‘å…³ç³»ï¼Œå¦‚æœç¬¬ä¸€ä¸ªcaseæ²¡è·‘ï¼Œç›´æ¥è·‘ç¬¬äºŒä¸ªcaseï¼Œè‚¯å®šæ˜¯è·‘ä¸é€šçš„ï¼Œä¹Ÿå°±æ˜¯è¯´æ•°æ®ä¹‹é—´ä¹Ÿæœ‰é€»è¾‘å…³ç³»<br/>
c,æ­£å¸¸æƒ…å†µä¸‹åšè‡ªåŠ¨åŒ–æµ‹è¯•è‚¯å®šæ˜¯åœ¨ç”Ÿäº§ç¯å¢ƒæˆ–è€…ç±»ä¼¼ç”Ÿäº§ç¯å¢ƒä¸Šåšæµ‹è¯•ï¼Œè‚¯å®šä¸èƒ½åœ¨æµ‹è¯•ç¯å¢ƒä¸Šåšï¼Œå› ä¸ºè¦ä¿è¯ç°åœ¨æµ‹è¯•çš„ä¸œè¥¿è·Ÿç”Ÿäº§ç¯å¢ƒæ˜¯ä¸€æ¨¡ä¸€æ ·çš„ï¼Œä½†æ˜¯ç”Ÿäº§ç¯å¢ƒä¸Šæµ‹è¯•è‚¯å®šä¼šäº§ç”Ÿå¾ˆå¤šçš„æµ‹è¯•æ•°æ®</p>

<p>è§£å†³æ–¹æ³•ï¼š<br/>
ä»¥ä¸Šé—®é¢˜è§£å†³æ–¹æ¡ˆæ˜¯é¦–å…ˆæŠŠç°æœ‰çš„åä¸ªæœåŠ¡å…¨éƒ¨å•ç‹¬éƒ¨ç½²ä¸€å¥—ï¼ˆè¿™ä¸ªä»£ä»·æœ‰ç‚¹å¤§ï¼‰ï¼Œè¿™ä¸ªç¯å¢ƒæ˜¯ä»‹äºæµ‹è¯•å’Œç”Ÿäº§ä¹‹é—´ï¼Œä¹Ÿå°±æ˜¯è¯´ä»£ç æ˜¯ç”Ÿäº§ç¨³å®šç‰ˆæœ¬ï¼Œæ•°æ®åº“æ˜¯å¤‡ä»½ç”Ÿäº§çš„æ•°æ®åº“ä¸‹æ¥ï¼ˆç›¸å½“äºæ˜¯ä¸€ä¸ªé¢„å‘ç¯å¢ƒï¼‰ï¼Œè¿™æ ·å°±ä¿è¯appçš„ç‰ˆæœ¬è·Ÿç”Ÿäº§æ˜¯ä¸€æ ·çš„ï¼Œåªæ˜¯æ•°æ®ä¸ä¸€æ ·è€Œå·²ï¼›å› ä¸ºæ•°æ®åº“ä¸æ˜¯ç”Ÿäº§çš„ï¼Œæ‰€ä»¥é‡Œé¢æ•°æ®æˆ‘ä»¬å¯ä»¥éšæ„åˆ å‡ï¼Œæ¯å¤©è·‘æµ‹è¯•caseæ—¶ï¼Œæˆ‘ä¼šå†™ä¸€ä¸ªè„šæœ¬ï¼ŒæŠŠä¹‹å‰çš„æµ‹è¯•æ•°æ®å…¨éƒ¨åˆ é™¤ï¼Œå†è‡ªåŠ¨å¢åŠ ä¸€ä¸ªé€»è¾‘ä¸Šçš„æµ‹è¯•æ•°æ®ä¸Šå»ï¼Œè¿™æ ·èƒ½ä¿è¯åœ¨æ¯å¤©è·‘æµ‹è¯•caseæ—¶ï¼Œæ•°æ®åº“æ˜¯å¹²å‡€çš„ï¼Œè€Œä¸”å„caseéƒ½èƒ½ä¿è¯ä¹‹é—´çš„é€»è¾‘æ•°æ®èƒ½è¡”æ¥ï¼Œç°åœ¨çš„åšæ³•æ˜¯æ¯ä¸ªè·‘caseä¹‹å‰ï¼Œå®šæ—¶è·‘ä¸€ä¸ªè„šæœ¬ï¼Œåˆ é™¤ä¸€äº›æµ‹è¯•æ•°æ®ï¼ŒåŠå¢åŠ ä¸€äº›é€»è¾‘æ•°æ®ï¼Œä½†æ˜¯å¦‚æœcaseå¤šäº†ï¼Œè„šæœ¬å¤æ‚ï¼Œå…¶å®å¾ˆéš¾ç¡®ä¿åˆ é™¤å¤„ç†å®Œåï¼Œä¿è¯caseèƒ½é¡ºåˆ©é€šè¿‡ï¼Œæœ€å¥½çš„åŠæ³•åº”è¯¥æ˜¯è·‘æ¯ä¸ªcaseä¹‹å‰æŠŠæ•°æ®åˆ é™¤åŠå¢åŠ é€»è¾‘æ•°æ®ï¼Œè€Œä¸æ˜¯ä¸€èµ·è·‘ï¼Œè¿™æ ·å°±èƒ½ç¡®ä¿æ¯ä¸ªcaseçš„é€šè¿‡ç‡ã€‚</p>

<h3>é—®é¢˜2: å¦‚ä½•æµ‹è¯•H5ã€hybrid app</h3>

<p>appé‡Œé¢æ··å…¥h5é¡µé¢å¾ˆæ­£å¸¸ï¼Œåœ¨ä¸€ä¸ªå³æœ‰åŸç”Ÿé¡µé¢åˆæœ‰H5é¡µé¢ï¼Œåº”è¯¥è¦æ€ä¹ˆæµ‹è¯•å‘¢ã€‚appiumå…¶ä¸­çš„ä¸€ä¸ªç†å¿µå°±æ˜¯ä½ ä¸èƒ½ä¸ºäº†æµ‹è¯•åº”ç”¨è€Œä¿®æ”¹åº”ç”¨ã€‚ä¸ºäº†ç¬¦åˆè¿™ä¸ªæ–¹æ³•å­¦ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Selenium æµ‹è¯•ä¼ ç»Ÿ web åº”ç”¨çš„æ–¹æ³•æ¥æµ‹è¯•æ··åˆ web åº”ç”¨ (æ¯”å¦‚ï¼ŒiOS åº”ç”¨é‡Œçš„å…ƒç´  &ldquo;UIWebView&rdquo; )ï¼Œè¿™æ˜¯æœ‰å¯èƒ½çš„ã€‚è¿™é‡Œä¼šæœ‰ä¸€äº›æŠ€æœ¯æ€§çš„å¤æ‚ï¼ŒAppium éœ€è¦çŸ¥é“ä½ æ˜¯æƒ³æµ‹è¯•åŸç”Ÿéƒ¨åˆ†å‘¢è¿˜æ˜¯webéƒ¨åˆ†ã€‚å¹¸è¿çš„æ˜¯ï¼Œæˆ‘ä»¬è¿˜èƒ½éµå®ˆ WebDriver çš„åè®®ã€‚è¯¦ç»†æ–‡æ¡£å¯ä»¥çœ‹<a href="https://github.com/appium/appium/blob/master/docs/en/advanced-concepts/hybrid.md">è¿™é‡Œ</a>
appiumä¼šè°ƒç”¨ GET session/:sessionId/contexts æ¥å£æ¥è·å¾—å½“å‰æœ‰contextä¿¡æ¯ï¼Œ ä¹Ÿå¯ä»¥ä½¿ç”¨POST session/:sessionId/contextæ¥è®¿é—®å½“å‰çš„contextå¯ä»¥å…·ä½“çœ‹ä¸‹ä»£ç </p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="err">æŸ¥çœ‹å½“å‰é¡µé¢æœ‰å¤šå°‘ä¸ª</span><span class="n">contexts</span>
</span><span class='line'><span class="n">pry</span><span class="p">(</span><span class="n">main</span><span class="p">)</span><span class="o">&gt;</span> <span class="n">available_contexts</span>
</span><span class='line'><span class="o">[</span>
</span><span class='line'>    <span class="o">[</span><span class="mi">0</span><span class="o">]</span> <span class="s2">&quot;NATIVE_APP&quot;</span><span class="p">,</span>
</span><span class='line'>    <span class="o">[</span><span class="mi">1</span><span class="o">]</span> <span class="s2">&quot;WEBVIEW_49&quot;</span>
</span><span class='line'><span class="o">]</span>
</span><span class='line'>
</span><span class='line'><span class="err">æŸ¥çœ‹å½“å‰çš„</span><span class="n">context</span>
</span><span class='line'><span class="o">[</span><span class="mi">2</span><span class="o">]</span> <span class="n">pry</span><span class="p">(</span><span class="n">main</span><span class="p">)</span><span class="o">&gt;</span> <span class="n">current_context</span>
</span><span class='line'><span class="s2">&quot;NATIVE_APP&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="err">è½¬æ¢</span><span class="n">context</span>
</span><span class='line'><span class="o">[</span><span class="mi">3</span><span class="o">]</span> <span class="n">pry</span><span class="p">(</span><span class="n">main</span><span class="p">)</span><span class="o">&gt;</span> <span class="n">webview</span> <span class="o">=</span> <span class="n">available_contexts</span><span class="o">.</span><span class="n">last</span>
</span><span class='line'><span class="s2">&quot;WEBVIEW_49&quot;</span>
</span><span class='line'><span class="o">[</span><span class="mi">4</span><span class="o">]</span> <span class="n">pry</span><span class="p">(</span><span class="n">main</span><span class="p">)</span><span class="o">&gt;</span> <span class="n">set_context</span> <span class="n">webview</span>
</span><span class='line'><span class="kp">nil</span>
</span></code></pre></td></tr></table></div></figure>


<p>è¿™é‡Œéœ€è¦ç‰¹æ®Šå¤„ç†ä¸‹æ˜¯çš„iosç¯å¢ƒï¼Œå½“åœ¨çœŸæœºä¸Šè¿è¡Œç”¨ä¾‹æ—¶ï¼Œappium æ— æ³•ç›´æ¥è®¿é—® web è§†å›¾ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦é€šè¿‡ USB çº¿ç¼†æ¥å»ºç«‹è¿æ¥ã€‚æˆ‘ä»¬ä½¿ç”¨ ios-webkit-debugger-proxyå»ºç«‹è¿æ¥ã€‚ä½¿ç”¨ brew å®‰è£…æœ€æ–°çš„ ios-webkit-debug-proxyã€‚åœ¨ç»ˆç«¯è¿è¡Œä¸€ä¸‹å‘½ä»¤:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># å¦‚æœä½ æ²¡æœ‰å®‰è£… brew çš„è¯ï¼Œå…ˆå®‰è£… brewã€‚</span>
</span><span class='line'><span class="o">&gt;</span> <span class="n">ruby</span> <span class="o">-</span><span class="n">e</span> <span class="s2">&quot;$(curl -fsSL https://raw.github.com/mxcl/homebrew/go/install)&quot;</span>
</span><span class='line'><span class="o">&gt;</span> <span class="n">brew</span> <span class="n">update</span>
</span><span class='line'><span class="o">&gt;</span> <span class="n">brew</span> <span class="n">install</span> <span class="n">ios</span><span class="o">-</span><span class="n">webkit</span><span class="o">-</span><span class="n">debug</span><span class="o">-</span><span class="n">proxy</span>
</span></code></pre></td></tr></table></div></figure>


<p>ä¸€æ—¦å®‰è£…å¥½äº†ï¼Œ ä½ å°±å¯ä»¥å¯åŠ¨ä»£ç†ï¼š</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># å°†udidæ›¿æ¢æˆä½ çš„è®¾å¤‡çš„udidã€‚ç¡®ä¿ç«¯å£ 27753 æ²¡æœ‰è¢«å ç”¨</span>
</span><span class='line'><span class="c1"># remote-debugger å°†ä¼šä½¿ç”¨è¿™ä¸ªç«¯å£ã€‚</span>
</span><span class='line'><span class="o">&gt;</span> <span class="n">ios_webkit_debug_proxy</span> <span class="o">-</span><span class="n">c</span> <span class="ss">c2848f21a19fa7dd3e83d4153225b77e9930039c</span><span class="p">:</span><span class="mi">27753</span> <span class="o">-</span><span class="n">d</span>
</span></code></pre></td></tr></table></div></figure>


<p>è¿˜æœ‰ä¸€ä¸ªé—®é¢˜å°±æ˜¯appium 1.6ä»¥ä¸Šç‰ˆæœ¬éœ€è¦xcode8æ‰“å‡ºæ¥çš„ipaåŒ…ï¼Œ1.6ä»¥ä¸‹è¯·ç”¨xcode7æ‰“åŒ…</p>

<h3>æœªå®Œå¾…ç»­ã€‚ã€‚ã€‚</h3>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Railsçš„å„ç§web Application Server]]></title>
    <link href="http://xuyao.club/blog/2016/11/17/rails-web-server/"/>
    <updated>2016-11-17T11:12:15+08:00</updated>
    <id>http://xuyao.club/blog/2016/11/17/rails-web-server</id>
    <content type="html"><![CDATA[<h3>Ruby app serveræ˜¯å¦‚ä½•å·¥ä½œçš„</h3>

<p>ä½†æ˜¯åœ¨æ·±å…¥è¯¦ç»†è®²è§£ä¹‹å‰ï¼Œè¿™é‡Œå…ˆå¯¹Ruby app serverçš„æ¦‚å¿µè¿›è¡Œä¸€äº›ä»‹ç»</p>

<!-- more -->


<h4>ä»€ä¹ˆæ˜¯rack</h4>

<p>å®ƒæä¾›ä¸€ä¸ªä»‹äºWebserverä¸rubyï¼ˆæˆ–rubyæ¡†æ¶ï¼‰ä¹‹é—´çš„ä¸€ä¸ªéå¸¸å°ä¸”åˆå®¹æ˜“ä½¿ç”¨çš„æ¥å£<br/>
å¯ä»¥ç†è§£æˆå°±æ˜¯ä¸€ä¸ªruby package,è¿™ä¸ªpackageæä¾›äº†ä¸€ä¸ªåŸºäºRuby Net::HTTPåº“å¼€å‘çš„easy-to-use interface
<img src="http://7xjibn.com1.z0.glb.clouddn.com/rack-logo.png" alt="rack-logo" />
Ruby web appé€šå¸¸æƒ…å†µä¸‹å¹¶ä¸ä¸HTTPçš„è¯·æ±‚å’Œå“åº”ç›´æ¥å‘ç”Ÿå…³ç³»ï¼Œå®ƒæ˜¯é€šè¿‡ä¸€ä¸ªæŠ½è±¡å±‚rackæ¥ä¸HTTPäº¤äº’ï¼Œå®ƒåªéœ€è¦å¤„ç†ä¸€ä¸ªæŠ½è±¡è¿‡çš„HTTPè¯·æ±‚å’Œå“åº”ï¼Œweb appå“åº”ä¸€ä¸ªè¯·æ±‚æ—¶ä¼šè°ƒç”¨ä¸€ä¸ªcallæ–¹æ³•ï¼Œæ¥å—ä¸€ä¸ªenvironmentçš„hashå‚æ•°ï¼ŒåŒæ—¶ä¼šå“åº”ä¸€ä¸ªæ•°ç»„ï¼Œæ•°ç»„é‡Œé¢åŒ…æ‹¬ The status, the headers, and the body.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">App</span>
</span><span class='line'>  <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">call</span><span class="p">(</span><span class="n">env</span><span class="p">)</span>
</span><span class='line'>    <span class="o">[</span>
</span><span class='line'>      <span class="mi">200</span><span class="p">,</span>
</span><span class='line'>      <span class="p">{</span> <span class="s1">&#39;Content-Type&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;text/html&#39;</span> <span class="p">},</span>
</span><span class='line'>      <span class="o">[</span> <span class="s2">&quot;&lt;html&gt;&quot;</span><span class="p">,</span> <span class="s2">&quot;get rack</span><span class="se">\&#39;</span><span class="s2">d&quot;</span><span class="p">,</span> <span class="s2">&quot;&lt;/html&gt;&quot;</span> <span class="o">]</span>
</span><span class='line'>    <span class="o">]</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>æ‰€ä»¥rackçš„ä½œç”¨å°±æ˜¯è§„èŒƒä¸¤ä»¶åŸºæœ¬äº‹æƒ…ï¼Œç¬¬ä¸€æ˜¯serveråº”è¯¥å‘é€ä»€ä¹ˆç»™ruby appï¼Œruby appåº”è¯¥è¿”å›ä»€ä¹ˆç»™server</p>

<p>å¯ä»¥åˆ›å»ºä¸€ä¸ªå¾ˆç®€å•çš„æ¨¡æ‹ŸWeb Serverä¾‹å­çœ‹ä¸‹ï¼Œåˆ›å»ºä¸€ä¸ªconfig.ruæ–‡ä»¶ï¼Œå†ä½¿ç”¨å‘½ä»¤rackupå¯åŠ¨å®ƒ</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># config.ru</span>
</span><span class='line'><span class="n">run</span> <span class="no">Proc</span><span class="o">.</span><span class="n">new</span> <span class="p">{</span> <span class="o">|</span><span class="n">env</span><span class="o">|</span> <span class="o">[</span><span class="s1">&#39;200&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;Content-Type&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;text/html&#39;</span><span class="p">},</span> <span class="o">[</span><span class="s1">&#39;get rack\&#39;d&#39;</span><span class="o">]]</span> <span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>è®¿é—®<a href="http://127.0.0.1:9292">http://127.0.0.1:9292</a> ï¼Œå°±å¯ä»¥çœ‹åˆ°è¿”å›çš„body
<img src="http://7xjibn.com1.z0.glb.clouddn.com/FAFD25AD-7D90-4986-A499-CEBC456798E4.png" alt="body" /></p>

<p>Rackæ˜¯Rubyçš„HTTPæŠ½è±¡å±‚ã€‚æ‰€æœ‰çš„Ruby app serveréƒ½å®ç°äº†Rackæ¥å£ï¼Œæ‰€ä»¥æ‰€æœ‰çš„Ruby web frameworkèƒ½å¤Ÿä¸æ‰€æœ‰Ruby app serverè¿›è¡Œæ— ç¼å·¥ä½œã€‚
æ‰€ä»¥app serverçš„èŒè´£æ˜¯æ¥æ”¶å’Œåˆ†æHTTPè¯·æ±‚ï¼Œç„¶ååœ¨åº•å±‚ä¸web appé€šè¿‡RackæŠ½è±¡åè®®è¿›è¡Œå¯¹è¯ï¼Œæ¥ç€æŠŠRackçš„å“åº”ï¼ˆä¹Ÿå°±æ˜¯applicationçš„è¿”å›å€¼ï¼‰è½¬æ¢å›çœŸæ­£çš„HTTPå“åº”ã€‚</p>

<p><img src="http://7xjibn.com1.z0.glb.clouddn.com/rack.jpg" alt="rack-server" /></p>

<h3>Rails on Rack</h3>

<p>åœ¨æœ¬åœ°å¼€å‘æ—¶ï¼Œä½¿ç”¨rails serveræ¥å¯åŠ¨æœåŠ¡æ—¶ä¼šåˆ›å»º Rack::Server å¯¹è±¡å¹¶å¯åŠ¨æœåŠ¡å™¨,åˆ›å»º Rack::Server å®ä¾‹çš„æ–¹æ³•å¦‚ä¸‹ï¼šä¼ é€é—¨
<a href="https://github.com/rails/rails/blob/83776676e54b387fc52081ff31cfd7710bae9e03/railties/lib/rails/commands/server/server_command.rb#L150">https://github.com/rails/rails/blob/83776676e54b387fc52081ff31cfd7710bae9e03/railties/lib/rails/commands/server/server_command.rb#L150</a></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="no">Rails</span><span class="o">::</span><span class="no">Server</span><span class="o">.</span><span class="n">new</span><span class="o">.</span><span class="n">tap</span> <span class="k">do</span> <span class="o">|</span><span class="n">server</span><span class="o">|</span>
</span><span class='line'>  <span class="nb">require</span> <span class="no">APP_PATH</span>
</span><span class='line'>  <span class="no">Dir</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="no">Rails</span><span class="o">.</span><span class="n">application</span><span class="o">.</span><span class="n">root</span><span class="p">)</span>
</span><span class='line'>  <span class="n">server</span><span class="o">.</span><span class="n">start</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>Rails::Server ç»§æ‰¿è‡ª Rack::Serverï¼Œä½¿ç”¨ä¸‹é¢çš„æ–¹å¼è°ƒç”¨ Rack::Server#start æ–¹æ³•ï¼š</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">Server</span> <span class="o">&lt;</span> <span class="o">::</span><span class="no">Rack</span><span class="o">::</span><span class="no">Server</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">start</span>
</span><span class='line'>    <span class="o">.</span><span class="n">.</span><span class="o">.</span>
</span><span class='line'>    <span class="k">super</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>æˆ‘ä»¬çŸ¥é“åœ¨railsé¡¹ç›®çš„æ ¹ç›®å½•æœ‰ä¸€ä¸ªconfig.ruæ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># This file is used by Rack-based servers to start the application.</span>
</span><span class='line'>
</span><span class='line'><span class="nb">require</span> <span class="o">::</span><span class="no">File</span><span class="o">.</span><span class="n">expand_path</span><span class="p">(</span><span class="s1">&#39;../config/environment&#39;</span><span class="p">,</span> <span class="bp">__FILE__</span><span class="p">)</span>
</span><span class='line'><span class="n">run</span> <span class="no">Rails</span><span class="o">.</span><span class="n">application</span>
</span></code></pre></td></tr></table></div></figure>


<p>æ‰€ä»¥æˆ‘ä»¬å…¶å®å¯ä»¥ä½¿ç”¨rackupå‘½ä»¤æ¥ä»£æ›¿rails server</p>

<h3>å¤šè¿›ç¨‹é˜»å¡I/Oï¼šUnicorn</h3>

<ul>
<li>unicornæ˜¯ä¸€ä¸ªRackåº”ç”¨çš„http server</li>
<li>å…·æœ‰ä½å»¶è¿Ÿã€é«˜å¸¦å®½è¿æ¥ã€åˆ©ç”¨Unix/Unix-like å†…æ ¸ç‰¹æ€§çš„ä¸€ä¸ªå¤šè¿›ç¨‹æœåŠ¡</li>
<li>Unicorn ä¼šè·å–å’Œé‡å¯å› åº”ç”¨ç¨‹åºå‡ºé”™å¯¼è‡´æ­»äº¡çš„ä»»åŠ¡ï¼Œä¸éœ€è¦è‡ªå·±ç®¡ç†å¤šä¸ªè¿›ç¨‹å’Œç«¯å£ã€‚Unicorn å¯ä»¥äº§ç”Ÿå’Œç®¡ç†ä»»ä½•æ•°é‡çš„ä»»åŠ¡è¿›ç¨‹ã€‚</li>
<li>ä¸éœ€è¦å…³å¿ƒåº”ç”¨ç¨‹åºæ˜¯å¦æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œworkers è¿è¡Œåœ¨ç‰¹ä»¬è‡ªå·±ç‹¬ç«‹çš„åœ°å€ç©ºé—´ï¼Œä¸”ä¸€æ¬¡åªä¸ºä¸€ä¸ªå®¢æˆ·ç«¯æœåŠ¡ã€‚</li>
<li>unicornæ˜¯çƒ­å¯åŠ¨ï¼Œnginx å¼çš„äºŒè¿›åˆ¶å‡çº§ï¼Œä¸ä¸¢å¤±è¿æ¥ã€‚ä½ å¯ä»¥å‡çº§ Unicornã€ä½ çš„æ•´ä¸ªåº”ç”¨ç¨‹åºã€åº“ã€ç”šè‡³ Ruby ç¼–è¾‘å™¨è€Œä¸ä¸¢å¤±å®¢æˆ·ç«¯è¿æ¥ã€‚</li>
<li>unicronæ˜¯å¤šè¿›ç¨‹é˜»å¡I/Oï¼Œæ¯ä¸€ä¸ªè¿›ç¨‹ä¸€æ¬¡å¤„ç†ä¸€ä¸ªclientã€‚å¹¶å‘çš„å®ç°æ˜¯é€šè¿‡æ„é€ å¤šä¸ªè¿›ç¨‹ï¼Œ
å¦‚æœå¯¹æ–¹æ²¡æœ‰æ•°æ®å‘é€ï¼Œé‚£ä¹ˆreadæ“ä½œå°±ä¼šè¢«é˜»å¡ï¼Œå¦‚æœå¯¹æ–¹æ¥æ”¶æ•°æ®å¤ªæ…¢ï¼Œé‚£ä¹ˆwriteæ“ä½œä¹Ÿä¼šè¢«é˜»å¡ã€‚ç”±äºè¿™ç§é˜»å¡è¡Œä¸ºï¼Œä¸€ä¸ªapplicationä¸€æ¬¡åªèƒ½å¤„ç†ä¸€ä¸ªclientã€‚é‚£ä¹ˆæˆ‘ä»¬å¦‚ä½•ä¸€æ¬¡å¤„ç†å¤šä¸ªclientå‘¢ï¼Ÿé‚£å°±æ„é€ å¤šä¸ªè¿›ç¨‹.<br/>
<img src="http://7xjibn.com1.z0.glb.clouddn.com/multi-process-io.jpg" alt="unicorn_process" /><br/>
ç¼ºç‚¹ï¼š</li>
<li>è¿›ç¨‹æœ¬èº«å¾ˆé‡ï¼Œå¼€é”€å¤§ï¼Œæ‰€ä»¥å¦‚æœä½ éœ€è¦è®¸å¤šI/Oå¹¶å‘ï¼ˆä¾‹å¦‚å¤„ç†WebSocketï¼Œæˆ–è€…ä½ çš„appéœ€è¦åšå¾ˆå¤šHTTPçš„APIè°ƒç”¨ï¼‰ï¼Œé‚£ä¹ˆç”¨è¿™ç§æ¨¡å‹å¹¶ä¸æ˜¯å¤ªåˆé€‚ã€‚å‡è®¾æˆ‘ä»¬ç”Ÿäº§ç¯å¢ƒæœ‰8ä¸ªworkerï¼Œæ¯ä¸ªworkerå ç”¨å†…å­˜250Mï¼Œé‚£ä¹ˆ8ä¸ªworkerå·®ä¸å¤šéœ€è¦2Gçš„å†…å­˜ï¼Œæ¶ˆè€—æ¯”è¾ƒå¤§ã€‚</li>
<li>unicornå¤šè¿›ç¨‹é˜»å¡I/Oæ¨¡å‹,é‚£ä¹ˆapp serverå¿…é¡»è¦é€šè¿‡ä½¿ç”¨â€œåå‘ä»£ç†ç¼“å­˜ï¼ˆbuffering reverse proxyï¼‰â€è¿›è¡Œä¿æŠ¤ï¼Œåå‘ä»£ç†ç¼“å­˜å¯ä»¥å¤„ç†æ›´å¤šæ•°é‡çš„I/Oå¹¶å‘ã€‚åå‘ä»£ç†ç¼“å­˜çš„è¯·æ±‚å’Œå“åº”æ˜¯ç”¨ä»¥é¿å…app serveræ‹’ç»(against)slow clientï¼Œè¿™äº›ä¸ªslow clientä¼šå¯¹applicationçš„å…¶ä»–æ–¹é¢è¿›è¡Œé˜»å¡ï¼Œè€Œåå‘ä»£ç†ç¼“å­˜å¯ä»¥é«˜æ•ˆçš„å°†slow clientè¿›è¡Œçºªå½•ã€‚</li>
</ul>


<h3>å¤šçº¿ç¨‹é˜»å¡I/O: puma</h3>

<ul>
<li>pumaæ˜¯ä¸€ä¸ªç®€æ´ã€å¿«é€Ÿã€å¤šçº¿ç¨‹ã€é«˜å¹¶å‘HTTP 1.1serverä¸“é—¨ä¸ºRuby web applicationsæ‰“é€ çš„ä¸€ä¸ªweb server</li>
<li>å®ƒå¯ä»¥ç”¨äºä»»ä½•æ”¯æŒRackçš„applicationï¼Œå¯ä»¥ç”¨åœ¨å¼€å‘ç¯å¢ƒå’Œç”Ÿäº§ç¯å¢ƒ</li>
<li>æ¯ä¸€ä¸ªè¿›ç¨‹æœ‰å¤šä¸ªçº¿ç¨‹ã€‚æ¯ä¸€ä¸ªçº¿ç¨‹ä¸€æ¬¡å¤„ç†ä¸€ä¸ªclientã€‚å¹¶å‘çš„å®ç°é€šè¿‡æ„é€ å°æ•°é‡çš„è¿›ç¨‹ï¼Œæ¯ä¸€ä¸ªè¿›ç¨‹åŒ…å«æœ‰å¤šä¸ªçº¿ç¨‹ã€‚
<img src="http://7xjibn.com1.z0.glb.clouddn.com/multithreaded-io.jpg" alt="multithreaded" /></li>
</ul>


<p>ä¸€ä¸ªè¿›ç¨‹æœ‰å¤šä¸ªçº¿ç¨‹ï¼Œæ¯ä¸€ä¸ªçº¿ç¨‹ä¸€æ¬¡å¤„ç†ä¸€ä¸ªclientã€‚å› ä¸ºçº¿ç¨‹æ˜¯è½»é‡çº§çš„ï¼Œæ‰€ä»¥ä½ å¯ä»¥ç”¨æ›´å°‘çš„å†…å­˜å¤„ç†ç›¸åŒæ•°é‡çš„I/Oå¹¶å‘ï¼Œpumaæ¯”unicornæœ€å¤§çš„å¥½å¤„å°±æ˜¯èŠ‚çœå†…å­˜</p>

<p>ç¼ºç‚¹:</p>

<ul>
<li>ä½ çš„applicationæ‰€æœ‰ä»£ç æˆ–ç¨‹åºåº“å¿…é¡»éƒ½å¾—æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚</li>
<li>app serveråº”è¯¥è¢«åå‘ä»£ç†ç¼“å­˜è¿›è¡Œä¿æŠ¤ï¼ŒåŸå› å’Œå¤šè¿›ç¨‹I/Oé˜»å¡æ¨¡å‹ä¸€æ ·ã€‚ç›¸æ¯”è¾ƒè€Œè¨€ï¼Œå¤šçº¿ç¨‹çš„app serverä¸å¤ªå®¹æ˜“å—slow clientå½±å“ï¼Œç„¶è€Œå¤šçº¿ç¨‹çš„app serverå¹¶æ²¡æœ‰å®Œå…¨è§£å†³slow clienté—®é¢˜ã€‚</li>
</ul>


<h3>slow Client</h3>

<p>ä»€ä¹ˆæ˜¯â€œslow clientâ€ä»¥åŠä¸ºä»€ä¹ˆè¿™ä¼šæˆä¸ºä¸€ä¸ªé—®é¢˜ï¼Ÿslow clientå¯èƒ½æ˜¯mobile clientã€‚mobileç½‘ç»œçš„é«˜å»¶è¿Ÿéå¸¸çš„æ¶å¿ƒã€‚ç½‘ç»œé˜»å¡ä¼šè®©æ­£å¸¸çš„clientå˜æˆslowã€‚ä¸€äº›clientå˜æˆslowç›®çš„å°±æ˜¯è¦æ”»å‡»ä½ çš„serverï¼Œæ‰“ä¸ªæ¯”æ–¹ï¼ŒæŠŠä½ çš„applicationæƒ³è±¡æˆä¸€ä¸ªå¸‚æ”¿åºœï¼ŒæŠŠapp serveræƒ³è±¡æˆå¸‚æ”¿åºœé‡Œçš„åŠå…¬æ¡Œã€‚äººä»¬èµ°è¿‘ä¸€å¼ åŠå…¬æ¡Œï¼ˆå‘é€ä¸€ä¸ªè¯·æ±‚ï¼‰ï¼Œå¤„ç†ä¸€äº›æ–‡ä»¶ç±»çš„å·¥ä½œï¼ˆåœ¨appå†…éƒ¨è¿›è¡Œå¤„ç†ï¼‰ï¼Œéšåäººä»¬å¸¦ç€ç›–æœ‰å°ç« çš„æ–‡ä»¶ç¦»å¼€ï¼ˆæ”¶åˆ°ä¸€ä¸ªå“åº”ï¼‰ã€‚slow clientå°±åƒæ˜¯äººä»¬èµ°è¿‘ä¸€å¼ åŠå…¬æ¡Œï¼Œä½†æ˜¯ä¸€ç›´ä¸ç¦»å¼€ï¼Œè¿™ä¸ªæ—¶å€™å·¥ä½œäººå‘˜å°±æ— æ³•å¸®åŠ©å…¶ä»–äººã€‚<br/>
<img src="http://7xjibn.com1.z0.glb.clouddn.com/slowclientproblem.jpg" alt="slowclientproblem" /><br/>
slow Clientå¯ä»¥é€šè¿‡ä½¿ç”¨åå‘ä»£ç†ç¼“å­˜è§£å†³ï¼Œåå‘ä»£ç†ç¼“å­˜å¯ä»¥å¤„ç†æ›´å¤§é‡çš„I/Oå¹¶å‘ã€‚æƒ³è±¡ä¸€ä¸‹æˆ‘ä»¬æŠŠç™¾ä¸‡çš„å·¥ä½œäººå‘˜æ”¾åˆ°å¸‚æ”¿åºœå¤–é¢ã€‚è¿™äº›å·¥ä½œäººå‘˜å¹¶æ²¡æœ‰å—è¿‡å¤„ç†æ–‡ä»¶çš„è®­ç»ƒã€‚äºæ­¤ç›¸åï¼Œä»–ä»¬åªæ˜¯æ¥æ”¶ä½ çš„æ–‡ä»¶ï¼ˆç¼“å­˜ä½ çš„è¯·æ±‚ï¼‰ï¼ŒæŠŠè¿™äº›æ–‡ä»¶å¸¦åˆ°å¸‚æ”¿åºœå†…éƒ¨ï¼Œç„¶åæŠŠå¸¦æœ‰å°ç« çš„æ–‡ä»¶å†è¿”è¿˜ç»™ä½ ï¼ˆç¼“å­˜ä½ çš„å“åº”ï¼‰ã€‚è¿™äº›å¤–éƒ¨çš„å·¥ä½œäººå‘˜æ°¸è¿œä¸ä¼šä¸€ç›´ç«™åœ¨åŠå…¬æ¡Œå‰é¢ï¼Œæ‰€ä»¥ä»–ä»¬æ°¸è¿œä¸ä¼šå¼•èµ·slow clienté—®é¢˜ã€‚å› ä¸ºè¿™äº›å¤–éƒ¨å·¥ä½œäººå‘˜åªæ˜¯å—åˆ°è¿‡ç®€å•çš„è®­ç»ƒï¼Œæ‰€ä»¥ä»–ä»¬çš„é›‡ä½£è´¹ç”¨å¾ˆä½ï¼ˆRAMå ç”¨ä½ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥é›‡ä½£å¾ˆå¤šã€‚<br/>
åå‘ä»£ç†é€šå¸¸æ¥è¯´å°±æ˜¯Nginxï¼ŒNginxç¼“å­˜äº†æ‰€æœ‰çš„ä¸œè¥¿ï¼Œå¹¶ä¸”å¯ä»¥å¤„ç†ä¸€ä¸ªè¢«è™šæ‹ŸåŒ–äº†çš„æ— é™æ•°é‡çš„clientï¼ŒåƒPumaè¿™ç§å¤šçº¿ç¨‹serverä¸æ˜¯å¾ˆå®¹æ˜“å—åˆ°å½±å“ï¼Œè¿™æ˜¯å› ä¸ºå®ƒä»¬åœ¨å¸‚æ”¿åºœå†…éƒ¨æœ‰æ›´å¤šçš„åŠå…¬æ¡Œï¼Œä½†æ˜¯è¿™äº›åŠå…¬æ¡Œåœ¨æ•°é‡ä¸Šä»ç„¶æ˜¯æœ‰é™çš„ï¼Œå› ä¸ºæ¯”èµ·å¸‚æ”¿åºœå¤–é¢é›‡ä½£è´¹ç”¨å¾ˆä½çš„å·¥ä½œäººå‘˜æ¥è¯´ï¼Œå†…éƒ¨çš„å·¥ä½œäººå‘˜éœ€è¦æ›´å¤šçš„è®­ç»ƒï¼ˆå ç”¨æ›´å¤šçš„RAMï¼‰ã€‚<br/>
<img src="http://7xjibn.com1.z0.glb.clouddn.com/bufferingreverseproxy.jpg" alt="bufferingreverseproxy" /></p>

<h6>é¢˜å¤–é˜…è¯»</h6>

<h3>Raptor</h3>

<p><a href="https://github.com/garybernhardt/raptor">Raptor</a>æ˜¯ä¸€æ¬¾å…¨æ–°çš„app server,è‡ªç§°æ€§èƒ½å¥½çš„æ— äººèƒ½æ¯”
<a href="http://www.akitaonrails.com/2014/10/19/the-new-kid-on-the-block-for-ruby-servers-raptor#.VEdVfvmSxb8">http://www.akitaonrails.com/2014/10/19/the-new-kid-on-the-block-for-ruby-servers-raptor#.VEdVfvmSxb8</a></p>

<h6>å‚è€ƒèµ„æ–™</h6>

<p><a href="http://blog.gauravchande.com/what-is-rack-in-ruby-rails">http://blog.gauravchande.com/what-is-rack-in-ruby-rails</a>
<a href="http://ohcoder.com/blog/2014/11/11/raptor-part-1/">http://ohcoder.com/blog/2014/11/11/raptor-part-1/</a>
<a href="https://blog.engineyard.com/2015/understanding-rack-apps-and-middleware">https://blog.engineyard.com/2015/understanding-rack-apps-and-middleware</a>
<a href="http://guides.ruby-china.org/rails_on_rack.html#resources">http://guides.ruby-china.org/rails_on_rack.html#resources</a><br/>
<a href="http://baike.baidu.com/view/1298606.htm">http://baike.baidu.com/view/1298606.htm</a><br/>
<a href="http://zh.wikipedia.org/zh-cn/%E7%BA%BF%E7%A8%8B%E5%AE%89%E5%85%A8">http://zh.wikipedia.org/zh-cn/%E7%BA%BF%E7%A8%8B%E5%AE%89%E5%85%A8</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[å…³äºRSAåŠ å¯†çš„ä¸€äº›é—®é¢˜]]></title>
    <link href="http://xuyao.club/blog/2016/10/20/about-rsa/"/>
    <updated>2016-10-20T18:35:23+08:00</updated>
    <id>http://xuyao.club/blog/2016/10/20/about-rsa</id>
    <content type="html"><![CDATA[<p>åšæ”¯ä»˜çš„æ—¶å€™ç»å¸¸æœ‰å„ç§åŠ å¯†ï¼Œæœ€å¸¸è§çš„ç®—æ˜¯RSAåŠ å¯†äº†ï¼Œä»¥å‰ä¸€ç›´ä¸å¤ªæ˜ç™½RSAåŠ å¯†æ˜¯ä»€ä¹ˆæ ·çš„ï¼Œå¦‚ä½•å·¥ä½œçš„ï¼Œä»Šå¤©çœ‹äº†ä¸€äº›æ–‡æ¡£ï¼Œæœ‰äº†ä¸€äº›åŸºæœ¬äº†è§£ï¼Œè®°å½•ä¸‹æ¥ï¼Œåšä¸ªå¤‡ä»½</p>

<h4>ä»€ä¹ˆæ˜¯RSA</h4>

<p>RSAæ˜¯ä¸€ç§éå¯¹ç§°åŠ å¯†ç®—æ³•ï¼Œåœ¨å…¬å¼€å¯†é’¥åŠ å¯†å’Œç”µå­å•†ä¸šè¢«å¹¿æ³›ä½¿ç”¨ï¼Œåå­—æ˜¯ç”±ä¸‰ä¸ªåˆ›å§‹äººçš„åå­—é¦–å­—æ¯ç»„æˆï¼Œæ›´å¤šä¿¡æ¯è¯·æŸ¥çœ‹<a href="https://zh.wikipedia.org/wiki/RSA%E5%8A%A0%E5%AF%86%E6%BC%94%E7%AE%97%E6%B3%95">https://zh.wikipedia.org/wiki/RSA%E5%8A%A0%E5%AF%86%E6%BC%94%E7%AE%97%E6%B3%95</a></p>

<!-- more -->


<h4>RSAçš„å·¥ä½œåŸç†</h4>

<p>å‡è®¾Aè¦å‘é€ä¸€æ®µæ–‡å­—ç»™Bï¼Œå¦‚æœAå‘é€çš„ä¿¡æ¯éœ€è¦ä½¿ç”¨RSAåŠ å¯†ï¼Œåˆ™æ•´ä¸ªè¿‡ç¨‹å¦‚ä¸‹
*   é¦–å…ˆéœ€è¦ç»™ç”¨æˆ·Aå’ŒBåˆ†åˆ«ç”Ÿæˆå…¬é’¥å’Œç§é’¥ï¼ŒåŒæ–¹çš„å…¬é’¥ä¿¡æ¯éƒ½å…¬å¼€ï¼Œç§é’¥åˆ™è‡ªå·±ä¿ç•™<br/>
*   Aè¦å‘é€ä¸€ä¸²å­—ç¬¦ç»™B,åˆ™å…ˆä½¿ç”¨Bçš„å…¬é’¥åŠ å¯†ï¼Œç”Ÿæˆå¯†æ–‡ï¼ŒBæ”¶åˆ°å¯†æ–‡åä½¿ç”¨ç§é’¥è§£å¯†å°±å¾—åˆ°æ˜æ–‡
*   åŒæ ·çš„é“ç†ï¼ŒBå‘é€ä¸€ä¸²å­—ç¬¦ç»™A,ä½¿ç”¨Açš„å…¬é’¥åŠ å¯†åå‘é€ç»™Aï¼ŒAæ”¶åˆ°åä½¿ç”¨è‡ªå·±çš„ç§é’¥è§£å¯†å°±å¯å¾—åˆ°æ˜æ–‡
å…·ä½“çš„åŠ å¯†ã€è§£å¯†ç®—æ³•åŸç†å¯ä»¥çœ‹<a href="http://www.ruanyifeng.com/blog/2013/06/rsa_algorithm_part_one.html">http://www.ruanyifeng.com/blog/2013/06/rsa_algorithm_part_one.html</a></p>

<h4>ä¾‹å­</h4>

<p>å¯ä»¥çœ‹ä¸‹ä¸‹é¢çš„ä¾‹å­</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">data</span> <span class="o">=</span> <span class="s1">&#39;æˆ‘æ˜¯æ˜æ–‡ï¼Œç»™æˆ‘åŠ å¯†å•Š&#39;</span>
</span><span class='line'><span class="n">digest</span> <span class="o">=</span> <span class="no">OpenSSL</span><span class="o">::</span><span class="no">Digest</span><span class="o">::</span><span class="no">SHA256</span><span class="o">.</span><span class="n">new</span>
</span><span class='line'><span class="n">pkey</span> <span class="o">=</span> <span class="no">OpenSSL</span><span class="o">::</span><span class="no">PKey</span><span class="o">::</span><span class="no">RSA</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="mi">2048</span><span class="p">)</span>  <span class="c1">#ç”Ÿæˆ2048ä½çš„ç§é’¥</span>
</span><span class='line'><span class="n">signature</span> <span class="o">=</span> <span class="n">pkey</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">digest</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>  <span class="c1">#ç”Ÿæˆç­¾å</span>
</span><span class='line'>
</span><span class='line'><span class="n">pub_key</span> <span class="o">=</span> <span class="n">pkey</span><span class="o">.</span><span class="n">public_key</span> <span class="c1">#ç”Ÿæˆå…¬é’¥</span>
</span><span class='line'><span class="n">pub_key</span><span class="o">.</span><span class="n">verify</span><span class="p">(</span><span class="n">digest</span><span class="p">,</span> <span class="n">signature</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>  <span class="c1">#éªŒç­¾ç­¾åæ˜¯å¦æ­£ç¡®</span>
</span></code></pre></td></tr></table></div></figure>


<p>ä¸‹é¢æ˜¯ç§é’¥å’Œå…¬é’¥çš„æ•°æ®æ ¼å¼</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">pkey</span><span class="o">.</span><span class="n">to_pem</span>
</span><span class='line'>
</span><span class='line'><span class="o">-----</span><span class="k">BEGIN</span> <span class="no">RSA</span> <span class="no">PRIVATE</span> <span class="no">KEY</span><span class="o">-----</span><span class="p">\</span><span class="n">nMIIEowIBAAKCAQEAw4a9XP0wqRORAm6hvKjrltdX0mfGIOWi4YqLyB4HYwFC0meR</span><span class="p">\</span><span class="n">nZbQ8ZtGxZ6wJAZ6uuJm7n4ZmMToPqiQywggCEfFjzjnX9HVPkLzuajXSTAqjihhb</span><span class="p">\</span><span class="n">nzs31VrPzwlCNiC</span><span class="o">+</span><span class="n">gJoN</span><span class="o">/</span><span class="no">UofwBQIVh19fAPPGTPL0Mf4n2zIylJudYQbiaL3Honx1</span><span class="p">\</span><span class="n">nL73hmzBeNMR1BbbE</span><span class="o">/</span><span class="n">u5ku3RhgYFetY</span><span class="o">+</span><span class="n">nxQRqxup8ekO3om6Q3Fd</span><span class="o">+</span><span class="mi">1</span><span class="n">gQw0EGdLvl5</span><span class="p">\</span><span class="n">nJb7kCR5ZC6o9cB8vUl</span><span class="o">+</span><span class="n">f</span><span class="o">/</span><span class="n">c1jLm4Buz9AQXpqUAWIbJF2</span><span class="o">+</span><span class="n">g3nvGnPQBKHqyOqlzbD</span><span class="p">\</span><span class="n">nWgm4K</span><span class="o">+</span><span class="no">Bid8gGCUfL9oX4fzJ</span><span class="o">/</span><span class="no">DFzLZOpsCesQKQIDAQABAoIBAF4236oeCkN</span><span class="o">+</span><span class="no">PSJ5</span><span class="p">\</span><span class="n">n4o9AqfyOGTA2dt7FKB4bn003QwHuyp8N7p6eIXi91AkLeW</span><span class="o">+</span><span class="no">BYdlrol</span><span class="o">+</span><span class="mo">06</span><span class="no">CsSOhgW</span><span class="p">\</span><span class="n">nxyp9p1m0Ag6OCsQtfsBUeWFOO94ORk01fY</span><span class="o">+</span><span class="no">B6JT1syBPplMX98h3FnPTMtGG9o67</span><span class="p">\</span><span class="n">nYtDXphbP</span><span class="o">/</span><span class="n">uDUAap6XqsC7Oui4Jfs</span><span class="o">+</span><span class="n">k2uPmDFQ139sgIKme4jS9Ee7XQ</span><span class="o">+</span><span class="no">IReL25VA</span><span class="p">\</span><span class="n">nSF2V2ADgrxHqZ7126YCtJyKxA2K8h8PLy47hw0slln</span><span class="o">/</span><span class="n">W</span><span class="o">+</span><span class="no">FJ4ArAPsRbN1yiQDrAn</span><span class="p">\</span><span class="n">nldRublnTBMvAGBWqSRgZUqT4KvfmnIySGzyfe2</span><span class="o">/</span><span class="no">HdSzW5gHIRgWqTtUecL</span><span class="o">+</span><span class="n">rYbah</span><span class="p">\</span><span class="n">neJeY9AECgYEA8B2NrZ1</span><span class="o">/</span><span class="n">neYZXdE0NFQAx3U4JeMD9WxSk8PJib8t1IxG2D8</span><span class="o">/</span><span class="n">mXug</span><span class="p">\</span><span class="n">n8TGf5TwqWHo79X3YXE25fX0WmNjI6gw7CwYd8vskldvjt2Aw3hiJfTNXrUKtcyAi</span><span class="p">\</span><span class="n">nIfGqXT</span><span class="o">/</span><span class="n">hiWoeYMsRtv9oZ4INcIrSWychcyGxNdKobRXs7oHe0jjFPqkCgYEA0HYN</span><span class="p">\</span><span class="n">ndnjhYqw4fXf2hsc</span><span class="o">/</span><span class="n">medewPrtoHI9TXgBRDsEJDYT5RAMBklhg33RNd</span><span class="o">/</span><span class="no">LQKFRPtqh</span><span class="p">\</span><span class="n">ngMLNqnku6rkIi18GRP</span><span class="o">/</span><span class="n">hdOyuzR</span><span class="o">/</span><span class="n">lbGTQey1K0pnoX32LTBNMACP7hIe6YIvt9jdj</span><span class="p">\</span><span class="n">n8wfxzjmnMZvsyKt564m4ZCexgpZleaEBzFARtYECgYBMRfcFWWx6aedQ5</span><span class="o">+</span><span class="mi">2</span><span class="n">fWbfN</span><span class="p">\</span><span class="n">npCyrzEsroLcyfRT</span><span class="o">+</span><span class="no">Dp6uT8kJVD4NsTnUpCDYnp4M8Pcu6kTaPU5Y0G1nLCXWQwBW</span><span class="p">\</span><span class="n">nZiEJWEGs4OabD5E2W7EA9lg5j16tnV16TtwBNxObpPv1X0xHRyaRCrzeLRrZHbsA</span><span class="p">\</span><span class="n">naYlzQXGDBV33</span><span class="o">/</span><span class="no">YUcXjA50QKBgQC12bYm2o6reFeTRJpfuuNFzCvBp2SyadYGhaB9</span><span class="p">\</span><span class="n">nOAqF2FMEqToEJfGWNqTSHZd</span><span class="o">+</span><span class="n">mvt4HFt1KvslMq</span><span class="o">/</span><span class="mi">1</span><span class="o">/</span><span class="no">VJx2oRqntm8GVjoAmIua8ff</span><span class="p">\</span><span class="n">nHITAMZkf7DIfPFo5aSpZ09mHran59xoPAag0YeDzivVFnSkviyW64VGd</span><span class="o">/</span><span class="no">LsrHoSm</span><span class="p">\</span><span class="n">nCldYgQKBgBzMtLh</span><span class="o">+</span><span class="no">YLQlDfBPt6IDggi</span><span class="o">+</span><span class="n">p1qdMEU8v</span><span class="o">+</span><span class="n">e6pBm7sBTRPplAoXeQfCvJ</span><span class="p">\</span><span class="n">nv9Ix60</span><span class="o">+</span><span class="mi">2</span><span class="no">NH5KKSAqvSYpNqRtWNGIA2zi</span><span class="o">/</span><span class="mi">5</span><span class="n">an1clmKBVpK9EVtOy5qiTcNziyhHdQ</span><span class="p">\</span><span class="n">nq8m7UWJRpck8R88N1DFadxEqb6HfwnW</span><span class="o">/</span><span class="mi">6</span><span class="no">DclKbKIgwxQYQA</span><span class="o">/</span><span class="no">Ug2y</span><span class="p">\</span><span class="n">n</span><span class="o">-----</span><span class="k">END</span> <span class="no">RSA</span> <span class="no">PRIVATE</span> <span class="no">KEY</span><span class="o">-----</span><span class="p">\</span><span class="n">n</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="n">pub_key</span><span class="o">.</span><span class="n">to_pem</span>
</span><span class='line'>
</span><span class='line'><span class="o">-----</span><span class="k">BEGIN</span> <span class="no">PUBLIC</span> <span class="no">KEY</span><span class="o">-----</span><span class="p">\</span><span class="n">nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAw4a9XP0wqRORAm6hvKjr</span><span class="p">\</span><span class="n">nltdX0mfGIOWi4YqLyB4HYwFC0meRZbQ8ZtGxZ6wJAZ6uuJm7n4ZmMToPqiQywggC</span><span class="p">\</span><span class="n">nEfFjzjnX9HVPkLzuajXSTAqjihhbzs31VrPzwlCNiC</span><span class="o">+</span><span class="n">gJoN</span><span class="o">/</span><span class="no">UofwBQIVh19fAPPG</span><span class="p">\</span><span class="n">nTPL0Mf4n2zIylJudYQbiaL3Honx1L73hmzBeNMR1BbbE</span><span class="o">/</span><span class="n">u5ku3RhgYFetY</span><span class="o">+</span><span class="n">nxQRq</span><span class="p">\</span><span class="n">nxup8ekO3om6Q3Fd</span><span class="o">+</span><span class="mi">1</span><span class="n">gQw0EGdLvl5Jb7kCR5ZC6o9cB8vUl</span><span class="o">+</span><span class="n">f</span><span class="o">/</span><span class="n">c1jLm4Buz9AQXpq</span><span class="p">\</span><span class="n">nUAWIbJF2</span><span class="o">+</span><span class="n">g3nvGnPQBKHqyOqlzbDWgm4K</span><span class="o">+</span><span class="no">Bid8gGCUfL9oX4fzJ</span><span class="o">/</span><span class="no">DFzLZOpsCesQ</span><span class="p">\</span><span class="n">nKQIDAQAB</span><span class="p">\</span><span class="n">n</span><span class="o">-----</span><span class="k">END</span> <span class="no">PUBLIC</span> <span class="no">KEY</span><span class="o">-----</span><span class="p">\</span><span class="n">n</span>
</span></code></pre></td></tr></table></div></figure>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Appè‡ªåŠ¨åŒ–æµ‹è¯•å¹³å°æ­å»ºè®°å½•ä¹‹rspecä¸appiumçš„å®Œç¾ç»„åˆ]]></title>
    <link href="http://xuyao.club/blog/2016/08/04/app-test-automation-platform-building-record-of-rspec-and-appium/"/>
    <updated>2016-08-04T18:31:04+08:00</updated>
    <id>http://xuyao.club/blog/2016/08/04/app-test-automation-platform-building-record-of-rspec-and-appium</id>
    <content type="html"><![CDATA[<p>æˆ‘ä»¬çš„é¢„æœŸç›®æ ‡æ˜¯æ¯å¤©å®šæ—¶è·‘æµ‹è¯•ä»£ç ï¼Œå¹¶ç”Ÿæˆç›¸åº”çš„æµ‹è¯•æŠ¥å‘Šï¼Œæ‰€ä»¥è¿™é‡Œéœ€è¦ä¸€ä¸ªæ¯”è¾ƒå®Œå–„çš„æµ‹è¯•æ¡†æ¶æ¥åšè¿™äº›äº‹æƒ…ï¼Œè¿™é‡Œæˆ‘é€‰æ‹©çš„æ˜¯rspecï¼Œ</p>

<h4>rspecä¸appiumç»„åˆ</h4>

<ul>
<li>å°†app(ioså’Œandroid)ç«¯æ¯ä¸ªé¡µé¢å°è£…æˆè‡ªå·±çš„ç±»ï¼Œé¡µé¢ä¸­çš„æ¯ä¸ªæ§ä»¶å®ä¾‹æˆæ–¹æ³•ï¼Œä½¿ç”¨åˆ°å“ªä¸ªé¡µé¢åªéœ€å°†å¯¹åº”çš„ç±»åˆå§‹åŒ–ä¸€ä¸‹ã€‚</li>
<li>å†™æµ‹è¯•ç”¨ä¾‹çš„äººå‘˜åªéœ€å†™å¯¹åº”çš„æµ‹è¯•ç”¨ä¾‹ï¼Œè€Œä¸éœ€è¦å…³æ³¨æ¯ä¸ªé¡µé¢çš„æ§ä»¶å°é—­ï¼Œè€Œå†™æ§ä»¶å°è£…çš„äººï¼Œåˆ™åªéœ€å†™ç±»çš„å°è£…ï¼Œä¹Ÿä¸å¿…å…³æ³¨æµ‹è¯•ç”¨ä¾‹ï¼Œè¿™æ ·æå¤§çš„æé«˜äº†å¼€å‘æ•ˆç‡</li>
<li>è€ƒè™‘åˆ°iosä¸androidä¸­å¤§éƒ¨åˆ†é¡µé¢çš„æ§ä»¶ä»¥åŠé€»è¾‘éƒ½æ˜¯ä¸€æ ·çš„ï¼Œæ‰€ä»¥é’ˆå¯¹ioså’Œandroidæµ‹è¯•ï¼Œspecä»£ç åªéœ€å†™ä¸€ä»½ï¼Œè¿™æ ·åšçš„å¥½å¤„æ˜¯å°†æµ‹è¯•ç”¨ä¾‹ä¸é€»è¾‘ä»£ç åˆ†ç¦»ï¼Œä¾¿äºä»¥åç»´æŠ¤ï¼ŒåŒæ—¶æµ‹è¯•ç”¨ä¾‹çš„æ‰©å±•æ€§å’Œé‡ç”¨æ€§ä¹Ÿå¤§å¤§å¾—åˆ°çš„æé«˜</li>
</ul>


<!-- more -->


<h4>ï¼ˆé¡µé¢ï¼‰ç±»çš„å°è£…</h4>

<p>æµ‹è¯•å¼€å‘æµç¨‹å…·ä½“å¦‚ä¸‹ï¼Œä»¥appä¸Šçš„æ·»åŠ äº²å‹ä¸ºä¾‹
<img src="http://7xjibn.com1.z0.glb.clouddn.com/Screenshot_2016-08-06-17-58-40_com.yydys.png" alt="img" />
å¯ä»¥çœ‹åˆ°æ·»åŠ äº²å‹é¡µé¢ä¸Šæœ‰4ä¸ªæ§ä»¶ï¼Œé‚£ä¹ˆå¯ä»¥å°†è¿™ä¸ªé¡µé¢å°è£…æˆä¸€ä¸ªç±»ï¼Œè¿™äº›æ§ä»¶å°±æ˜¯å¯¹åº”çš„å®ä¾‹æ–¹æ³•</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1">#androidå¯¹åº”çš„ç±»</span>
</span><span class='line'><span class="k">module</span> <span class="nn">Simulator</span>
</span><span class='line'>  <span class="k">module</span> <span class="nn">Android</span>
</span><span class='line'>    <span class="k">module</span> <span class="nn">Pages</span>
</span><span class='line'>      <span class="k">module</span> <span class="nn">Patient</span>
</span><span class='line'>        <span class="k">class</span> <span class="nc">AddRelative</span> <span class="o">&lt;</span> <span class="no">Simulator</span><span class="o">::</span><span class="no">Android</span><span class="o">::</span><span class="no">Pages</span><span class="o">::</span><span class="no">Patient</span><span class="o">::</span><span class="no">Base</span>
</span><span class='line'>
</span><span class='line'>          <span class="k">def</span> <span class="nf">my_relatives_link</span>
</span><span class='line'>            <span class="n">text</span><span class="p">(</span><span class="s2">&quot;æˆ‘çš„äº²å‹&quot;</span><span class="p">)</span>
</span><span class='line'>          <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>          <span class="k">def</span> <span class="nf">add_relative_button</span>
</span><span class='line'>            <span class="n">find</span><span class="p">(</span><span class="nb">id</span><span class="p">:</span> <span class="s2">&quot;com.yydys:id/add_folks&quot;</span><span class="p">)</span>
</span><span class='line'>          <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>          <span class="k">def</span> <span class="nf">relative_select</span>
</span><span class='line'>            <span class="c1">#text(&quot;æ˜¯ä½ çš„&quot;)</span>
</span><span class='line'>            <span class="n">find</span><span class="p">(</span><span class="nb">id</span><span class="p">:</span> <span class="s2">&quot;com.yydys:id/role_name&quot;</span><span class="p">)</span>
</span><span class='line'>          <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>          <span class="k">def</span> <span class="nf">name_option_selected</span> <span class="nb">name</span><span class="o">=</span><span class="s2">&quot;çˆ¸çˆ¸&quot;</span>
</span><span class='line'>            <span class="n">text</span><span class="p">(</span><span class="nb">name</span><span class="p">)</span>
</span><span class='line'>          <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>          <span class="k">def</span> <span class="nf">mobile_num_text_field</span>
</span><span class='line'>            <span class="n">find</span><span class="p">(</span><span class="nb">id</span><span class="p">:</span> <span class="s2">&quot;com.yydys:id/mobile&quot;</span><span class="p">)</span>
</span><span class='line'>          <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>          <span class="k">def</span> <span class="nf">glucose_sms_reminder</span>
</span><span class='line'>            <span class="n">find</span><span class="p">(</span><span class="nb">id</span><span class="p">:</span> <span class="s2">&quot;com.yydys:id/glucose_exception_togglebtn&quot;</span><span class="p">)</span>
</span><span class='line'>          <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>          <span class="k">def</span> <span class="nf">medicine_sms_reminder</span>
</span><span class='line'>            <span class="n">find</span><span class="p">(</span><span class="nb">id</span><span class="p">:</span> <span class="s2">&quot;com.yydys:id/forget_medication_togglebtn&quot;</span><span class="p">)</span>
</span><span class='line'>          <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>          <span class="k">def</span> <span class="nf">save_button</span>
</span><span class='line'>            <span class="n">find</span><span class="p">(</span><span class="nb">id</span><span class="p">:</span> <span class="s2">&quot;com.yydys:id/right_btn&quot;</span><span class="p">)</span>
</span><span class='line'>          <span class="k">end</span>
</span><span class='line'>        <span class="k">end</span>
</span><span class='line'>      <span class="k">end</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="c1">#ioså¯¹åº”çš„ç±»</span>
</span><span class='line'><span class="k">module</span> <span class="nn">Simulator</span>
</span><span class='line'>  <span class="k">module</span> <span class="nn">Ios</span>
</span><span class='line'>    <span class="k">module</span> <span class="nn">Pages</span>
</span><span class='line'>      <span class="k">module</span> <span class="nn">Patient</span>
</span><span class='line'>        <span class="k">class</span> <span class="nc">AddRelative</span> <span class="o">&lt;</span> <span class="no">Simulator</span><span class="o">::</span><span class="no">Ios</span><span class="o">::</span><span class="no">Pages</span><span class="o">::</span><span class="no">Patient</span><span class="o">::</span><span class="no">Base</span>
</span><span class='line'>          <span class="k">def</span> <span class="nf">my_relatives_link</span>
</span><span class='line'>            <span class="n">text</span><span class="p">(</span><span class="s2">&quot;æˆ‘çš„äº²å‹&quot;</span><span class="p">)</span>
</span><span class='line'>          <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>          <span class="k">def</span> <span class="nf">add_relative_button</span>
</span><span class='line'>            <span class="n">button_exact</span><span class="p">(</span><span class="s2">&quot;æ·»åŠ äº²å‹&quot;</span><span class="p">)</span>
</span><span class='line'>          <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>          <span class="k">def</span> <span class="nf">relative_select</span>
</span><span class='line'>            <span class="n">text</span><span class="p">(</span><span class="s2">&quot;æ˜¯æ‚¨çš„&quot;</span><span class="p">)</span>
</span><span class='line'>          <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>          <span class="k">def</span> <span class="nf">name_option_selected</span> <span class="nb">name</span><span class="o">=</span><span class="s2">&quot;çˆ¸çˆ¸&quot;</span>
</span><span class='line'>            <span class="n">text</span><span class="p">(</span><span class="nb">name</span><span class="p">)</span>
</span><span class='line'>          <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>          <span class="k">def</span> <span class="nf">mobile_num_text_field</span>
</span><span class='line'>            <span class="n">textfield_exact</span><span class="p">(</span><span class="s2">&quot;è¯·è¾“å…¥æ‰‹æœºå·&quot;</span><span class="p">)</span>
</span><span class='line'>          <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>          <span class="k">def</span> <span class="nf">glucose_sms_reminder</span>
</span><span class='line'>            <span class="n">find</span><span class="p">(</span><span class="ss">xpath</span><span class="p">:</span> <span class="s2">&quot;//UIAApplication[1]/UIAWindow[1]/UIATableView[1]/UIATableCell[3]/UIASwitch[1]&quot;</span><span class="p">)</span>
</span><span class='line'>          <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>          <span class="k">def</span> <span class="nf">medicine_sms_reminder</span>
</span><span class='line'>            <span class="n">find</span><span class="p">(</span><span class="ss">xpath</span><span class="p">:</span> <span class="s2">&quot;//UIAApplication[1]/UIAWindow[1]/UIATableView[1]/UIATableCell[3]/UIASwitch[2]&quot;</span><span class="p">)</span>
</span><span class='line'>          <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>          <span class="k">def</span> <span class="nf">save_button</span>
</span><span class='line'>            <span class="n">button_exact</span><span class="p">(</span><span class="s2">&quot;ä¿å­˜&quot;</span><span class="p">)</span>
</span><span class='line'>            <span class="c1">#find(xpath: &quot;//UIAApplication[1]/UIAWindow[1]/UIATableView[1]/UIATableCell[4]/UIASwitch[1]&quot;)</span>
</span><span class='line'>          <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>          <span class="k">def</span> <span class="nf">return_button</span>
</span><span class='line'>            <span class="n">button_exact</span><span class="p">(</span><span class="s2">&quot;è¿”å›&quot;</span><span class="p">)</span>
</span><span class='line'>          <span class="k">end</span>
</span><span class='line'>        <span class="k">end</span>
</span><span class='line'>      <span class="k">end</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>å¯ä»¥çœ‹åˆ°å¯¹åº”é¡µé¢ä¸Šçš„æ¯ä¸ªæ§ä»¶ï¼Œioså’Œandroidéƒ½ä¼šæœ‰è‡ªå·±çš„å°é—­æ–¹æ³•ï¼Œè¿™æ ·åšæé«˜äº†ä»£ç çš„é‡ç”¨æ€§ï¼Œä¸æµ‹è¯•ä»£ç åˆ†ç¦»ï¼Œä¾¿äºä»¥åç»´æŠ¤</p>

<h4>æµ‹è¯•ç”¨ä¾‹</h4>

<p>ä¸Šé¢è¯´é“ä¸€èˆ¬ioså’Œandroidé¡µé¢ä¸Šçš„æ§ä»¶æ˜¯ä¸€æ ·çš„ï¼Œæ‰€ä»¥æ­£å¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åªéœ€å†™ä¸€ä»½æµ‹è¯•ä»£ç å°±å¯ä»¥ï¼Œä½†æ˜¯ioså’Œandroidçš„æµ‹è¯•ä»£ç è¿˜æ˜¯è¦åˆ†å¼€è·‘çš„ï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘å¼•ç”¨äº†rpsecçš„<a href="http://rspec.info/documentation/3.5/rspec-core/#Shared_Examples_and_Contexts">share_example</a>æ¥åš</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1">#androidçš„æµ‹è¯•ç”¨ä¾‹</span>
</span><span class='line'><span class="n">require_relative</span> <span class="s1">&#39;../../../shared/patient/v1/add_relative_spec&#39;</span>
</span><span class='line'><span class="no">RSpec</span><span class="o">.</span><span class="n">describe</span> <span class="s2">&quot;AddRelative   &quot;</span> <span class="k">do</span>
</span><span class='line'>  <span class="n">include_examples</span> <span class="s2">&quot;share_add_relative&quot;</span>  <span class="p">,</span> <span class="s2">&quot;android&quot;</span>
</span><span class='line'><span class="k">end</span>    
</span><span class='line'>
</span><span class='line'><span class="c1">#iosçš„æµ‹è¯•ç”¨ä¾‹</span>
</span><span class='line'><span class="n">require_relative</span> <span class="s1">&#39;../../../shared/patient/v1/add_relative_spec&#39;</span>
</span><span class='line'><span class="no">RSpec</span><span class="o">.</span><span class="n">describe</span> <span class="s2">&quot;AddRelative&quot;</span> <span class="k">do</span>
</span><span class='line'>  <span class="n">include_examples</span> <span class="s2">&quot;share_add_relative&quot;</span>  <span class="p">,</span> <span class="s2">&quot;ios&quot;</span>
</span><span class='line'><span class="k">end</span>    
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="c1">#sharedéƒ¨åˆ†</span>
</span><span class='line'><span class="n">require_relative</span> <span class="s1">&#39;../../../spec_helper&#39;</span>
</span><span class='line'><span class="no">RSpec</span><span class="o">.</span><span class="n">shared_examples</span> <span class="s2">&quot;share_add_relative&quot;</span> <span class="k">do</span> <span class="o">|</span><span class="n">device</span><span class="o">|</span>
</span><span class='line'>  <span class="n">before</span><span class="p">(</span><span class="ss">:all</span><span class="p">)</span> <span class="k">do</span>
</span><span class='line'>    <span class="n">login</span> <span class="n">device</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1">#Appium.promote_appium_methods Object</span>
</span><span class='line'>  <span class="n">it</span> <span class="s2">&quot;add relative&quot;</span> <span class="k">do</span>
</span><span class='line'>      <span class="k">begin</span>
</span><span class='line'>              <span class="nb">sleep</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
</span><span class='line'>          <span class="n">wait</span> <span class="p">{</span><span class="n">add_relative_page</span><span class="o">.</span><span class="n">user_center_bar</span><span class="o">.</span><span class="n">click</span><span class="p">}</span>
</span><span class='line'>          <span class="n">wait</span> <span class="p">{</span><span class="n">add_relative_page</span><span class="o">.</span><span class="n">my_relatives_link</span><span class="o">.</span><span class="n">click</span><span class="p">}</span>
</span><span class='line'>          <span class="n">wait</span> <span class="p">{</span><span class="n">add_relative_page</span><span class="o">.</span><span class="n">add_relative_button</span><span class="o">.</span><span class="n">click</span><span class="p">}</span>
</span><span class='line'>          <span class="k">if</span> <span class="vi">@device</span><span class="o">.</span><span class="n">appium_device</span> <span class="o">==</span>  <span class="ss">:android</span>
</span><span class='line'>              <span class="n">wait</span> <span class="p">{</span><span class="n">add_relative_page</span><span class="o">.</span><span class="n">relative_select</span><span class="o">.</span><span class="n">click</span><span class="p">}</span>
</span><span class='line'>              <span class="n">wait</span> <span class="p">{</span><span class="n">add_relative_page</span><span class="o">.</span><span class="n">name_option_selected</span><span class="p">(</span><span class="s2">&quot;çˆ¸çˆ¸&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">}</span>
</span><span class='line'>          <span class="k">else</span>
</span><span class='line'>              <span class="n">wait</span> <span class="p">{</span><span class="n">add_relative_page</span><span class="o">.</span><span class="n">relative_select</span><span class="o">.</span><span class="n">click</span><span class="p">}</span>
</span><span class='line'>              <span class="n">wait</span> <span class="p">{</span><span class="n">add_relative_page</span><span class="o">.</span><span class="n">return_button</span><span class="o">.</span><span class="n">click</span><span class="p">}</span>
</span><span class='line'>          <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>          <span class="n">wait</span> <span class="p">{</span><span class="n">add_relative_page</span><span class="o">.</span><span class="n">mobile_num_text_field</span><span class="o">.</span><span class="n">type</span><span class="p">(</span><span class="s2">&quot;13524836959&quot;</span><span class="p">)}</span>
</span><span class='line'>          <span class="k">if</span> <span class="vi">@device</span><span class="o">.</span><span class="n">appium_device</span> <span class="o">==</span>  <span class="ss">:android</span>
</span><span class='line'>              <span class="c1">#screen = wait {add_relative_page.boot_screen}</span>
</span><span class='line'>              <span class="c1">#size = screen.window_size</span>
</span><span class='line'>              <span class="c1">#start_x, end_x, start_y, end_y = size.width - 5, size.width/100, size.height/2, size.height/2</span>
</span><span class='line'>              <span class="c1">#wait {exists{swipe(start_x:start_x,start_y:start_y, end_x:end_x,end_y:end_y, duration:1000)}}</span>
</span><span class='line'>          <span class="k">else</span>
</span><span class='line'>              <span class="n">wait</span> <span class="p">{</span><span class="n">add_relative_page</span><span class="o">.</span><span class="n">glucose_sms_reminder</span><span class="o">.</span><span class="n">click</span><span class="p">}</span>
</span><span class='line'>              <span class="c1">#wait {add_relative_page.medicine_sms_reminder.click}</span>
</span><span class='line'>          <span class="k">end</span>
</span><span class='line'>          <span class="c1">#wait {add_relative_page.glucose_sms_reminder.}</span>
</span><span class='line'>          <span class="c1">#wait {add_relative_page.mobile_num_text_field.type(&quot;11000009123&quot;)}</span>
</span><span class='line'>          <span class="n">wait</span> <span class="p">{</span><span class="n">add_relative_page</span><span class="o">.</span><span class="n">save_button</span><span class="o">.</span><span class="n">click</span><span class="p">}</span>
</span><span class='line'>          <span class="n">expect</span><span class="p">(</span><span class="n">exists</span><span class="p">{</span><span class="n">add_relative_page</span><span class="o">.</span><span class="n">add_relative_button</span><span class="p">})</span><span class="o">.</span><span class="n">to</span> <span class="n">be_truthy</span>
</span><span class='line'>  <span class="k">rescue</span> <span class="o">=&gt;</span> <span class="n">e</span>
</span><span class='line'>          <span class="nb">puts</span> <span class="n">e</span><span class="o">.</span><span class="n">message</span>
</span><span class='line'>          <span class="vi">@driver</span><span class="o">.</span><span class="n">quit</span> <span class="k">if</span> <span class="vi">@driver</span>
</span><span class='line'>          <span class="k">raise</span> <span class="n">e</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">after</span> <span class="k">do</span>
</span><span class='line'>    <span class="vi">@driver</span><span class="o">.</span><span class="n">quit</span> <span class="k">if</span> <span class="vi">@driver</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>å¯ä»¥çœ‹åˆ°å†™æµ‹è¯•ç”¨ä¾‹çš„äººå‘˜ï¼Œä¸å¿…å…³æ³¨åº•å±‚æ§ä»¶çš„å°è£…ï¼Œåªéœ€æŒ‰æ­£å¸¸é€»è¾‘å†™æµ‹è¯•ç”¨ä¾‹å°±å¯</p>

<h4>æµ‹è¯•æŠ¥å‘Š</h4>

<p><img src="http://7xjibn.com1.z0.glb.clouddn.com/C8EA5B20-316A-45CB-A950-5F393B4AEC85.png" alt="img" /></p>

<h4>æœªå®Œæˆçš„å·¥ä½œ</h4>

<ul>
<li>é…ç½®jenkinsï¼Œä½¿å…¶æ¯å¤©å®šæ—¶æ‰“åŒ…æœ€æ–°çš„ä»£ç </li>
<li>åŠ¨æ€æ•°æ®çš„è½½å…¥</li>
<li>ä¸åŒappç‰ˆæœ¬çš„æµ‹è¯•</li>
<li>æ··åˆï¼Œh5é¡µé¢çš„æµ‹è¯•</li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Appè‡ªåŠ¨åŒ–æµ‹è¯•å¹³å°æ­å»ºè®°å½•ä¹‹å¦‚ä½•ä¼˜é›…åœ°æ‰¾åˆ°æ§ä»¶]]></title>
    <link href="http://xuyao.club/blog/2016/07/10/app-test-automation-platform-building-record-of-how-to-find-the-ui/"/>
    <updated>2016-07-10T22:22:44+08:00</updated>
    <id>http://xuyao.club/blog/2016/07/10/app-test-automation-platform-building-record-of-how-to-find-the-ui</id>
    <content type="html"><![CDATA[<p>è¿™ç¯‡è®²ä¸€ä¸‹å¦‚æœæ‰¾åˆ°å¯¹åº”ios/androidé‡Œçš„UIæ§ä»¶ï¼Œä»¥ä¾¿æˆ‘ä»¬å¿«é€Ÿåœ°å†™æµ‹è¯•ä»£ç ï¼Œæœ¬ç³»åˆ—æ–‡ç« æœªç‰¹æ®Šæåˆ°ä½¿ç”¨ä»€ä¹ˆè¯­è¨€æ—¶ï¼Œé»˜è®¤ä½¿ç”¨rubyè„šæœ¬è¯­è¨€ã€‚ios/androidè®¾å¤‡çš„UIæ§ä»¶æœ‰å¾ˆå¤šç§ï¼Œä¸‹é¢è®²ä¸€ä¸‹ä½¿ç”¨appium Inspectorå’Œappium ruby console(arc)æ¥æŸ¥æ‰¾UIæ§ä»¶</p>

<!-- more -->


<h4>Appium Inspector GUI</h4>

<p>appiumæœåŠ¡å¯åŠ¨åï¼Œç‚¹å‡»inspector,å¯åŠ¨client GUIï¼Œå¦‚ä¸‹å›¾,GUIå·²å¸®æˆ‘ä»¬è·å–åˆ°æ‰€æœ‰çš„Uiæ§ä»¶ï¼Œå¹¶ä¸”æœ‰å¾ˆå¤šæ¨¡æ‹Ÿæ“ä½œï¼Œéå¸¸é€‚åˆæˆ‘ä»¬è°ƒè¯•ç”¨ï¼Œç‚¹å‡»recordï¼Œæ¯ä¸ªæ¨¡æ‹Ÿæ“ä½œéƒ½ä¼šç”Ÿæˆç›¸åº”çš„ä»£ç ï¼Œè€Œä¸”ä»£ç è¿˜å¯ä»¥é€‰æ‹©ä½ éœ€è¦çš„è¯­è¨€ç‰ˆæœ¬ã€‚
<img src="http://7xjibn.com1.z0.glb.clouddn.com/android_detail.png" alt="android_detail" />
<img src="http://7xjibn.com1.z0.glb.clouddn.com/android_record.png" alt="android_record" /><br/>
æˆ‘ä»¬å…·ä½“å®šä½åˆ°æŸä¸ªæ§ä»¶ï¼Œå¯ä»¥çœ‹åˆ°è¿™ä¸ªæ§ä»¶çš„è¯¦ç»†ä¿¡æ¯ï¼Œæ¯”å¦‚æˆ‘ç°åœ¨æ‰¾åˆ°ä¸€ä¸ªç™»å½•æŒ‰é’®ï¼Œä¸‹é¢æ˜¯è¿™ä¸ªç™»å½•æŒ‰é’®çš„ä¿¡æ¯</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1">#androidæŸä¸ªæ§ä»¶çš„è¯¦ç»†ä¿¡æ¯</span>
</span><span class='line'><span class="n">content</span><span class="o">-</span><span class="ss">desc</span><span class="p">:</span>
</span><span class='line'><span class="ss">type</span><span class="p">:</span> <span class="n">android</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="n">Button</span>
</span><span class='line'><span class="ss">text</span><span class="p">:</span> <span class="err">ç™»å½•</span>
</span><span class='line'><span class="ss">index</span><span class="p">:</span> <span class="mi">1</span>
</span><span class='line'><span class="ss">enabled</span><span class="p">:</span> <span class="kp">true</span>
</span><span class='line'><span class="ss">location</span><span class="p">:</span> <span class="p">{</span><span class="mi">418</span><span class="p">,</span> <span class="mi">1054</span><span class="p">}</span>
</span><span class='line'><span class="ss">size</span><span class="p">:</span> <span class="p">{</span><span class="mi">262</span><span class="p">,</span> <span class="mi">89</span><span class="p">}</span>
</span><span class='line'><span class="ss">checkable</span><span class="p">:</span> <span class="kp">false</span>
</span><span class='line'><span class="ss">checked</span><span class="p">:</span> <span class="kp">false</span>
</span><span class='line'><span class="ss">focusable</span><span class="p">:</span> <span class="kp">true</span>
</span><span class='line'><span class="ss">clickable</span><span class="p">:</span> <span class="kp">true</span>
</span><span class='line'><span class="n">long</span><span class="o">-</span><span class="ss">clickable</span><span class="p">:</span> <span class="kp">false</span>
</span><span class='line'><span class="ss">package</span><span class="p">:</span> <span class="n">com</span><span class="o">.</span><span class="n">yydys</span>
</span><span class='line'><span class="ss">password</span><span class="p">:</span> <span class="kp">false</span>
</span><span class='line'><span class="n">resource</span><span class="o">-</span><span class="nb">id</span><span class="p">:</span> <span class="n">com</span><span class="o">.</span><span class="n">yydys</span><span class="ss">:id</span><span class="o">/</span><span class="n">immediate_experience</span>
</span><span class='line'><span class="ss">scrollable</span><span class="p">:</span> <span class="kp">false</span>
</span><span class='line'><span class="ss">selected</span><span class="p">:</span> <span class="kp">false</span>
</span><span class='line'><span class="ss">xpath</span><span class="p">:</span> <span class="sr">//</span><span class="n">android</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="n">LinearLayout</span><span class="o">[</span><span class="mi">1</span><span class="o">]/</span><span class="n">android</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="n">FrameLayout</span><span class="o">[</span><span class="mi">1</span><span class="o">]/</span><span class="n">android</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="n">LinearLayout</span><span class="o">[</span><span class="mi">1</span><span class="o">]/</span><span class="n">android</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="n">LinearLayout</span><span class="o">[</span><span class="mi">1</span><span class="o">]/</span><span class="n">android</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="n">LinearLayout</span><span class="o">[</span><span class="mi">2</span><span class="o">]/</span><span class="n">android</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="n">Button</span><span class="o">[</span><span class="mi">2</span><span class="o">]</span>
</span><span class='line'>
</span><span class='line'><span class="c1">#iosæŸä¸ªæ§ä»¶ä¸‹çš„è¯¦æƒ…ä¿¡æ¯</span>
</span><span class='line'><span class="nb">name</span><span class="p">:</span> <span class="err">ç™»å½•</span>
</span><span class='line'><span class="ss">type</span><span class="p">:</span> <span class="no">UIAButton</span>
</span><span class='line'><span class="ss">value</span><span class="p">:</span>
</span><span class='line'><span class="ss">label</span><span class="p">:</span> <span class="err">ç™»å½•</span>
</span><span class='line'><span class="ss">hint</span><span class="p">:</span>
</span><span class='line'><span class="ss">enabled</span><span class="p">:</span> <span class="kp">true</span>
</span><span class='line'><span class="ss">visible</span><span class="p">:</span> <span class="kp">true</span>
</span><span class='line'><span class="ss">valid</span><span class="p">:</span> <span class="kp">true</span>
</span><span class='line'><span class="ss">location</span><span class="p">:</span> <span class="p">{</span><span class="mi">192</span><span class="o">.</span><span class="mi">5</span><span class="p">,</span> <span class="mi">575</span><span class="p">}</span>
</span><span class='line'><span class="ss">size</span><span class="p">:</span> <span class="p">{</span><span class="mi">167</span><span class="o">.</span><span class="mi">5</span><span class="p">,</span> <span class="mi">44</span><span class="p">}</span>
</span><span class='line'><span class="ss">xpath</span><span class="p">:</span> <span class="sr">//</span><span class="no">UIAApplication</span><span class="o">[</span><span class="mi">1</span><span class="o">]/</span><span class="no">UIAWindow</span><span class="o">[</span><span class="mi">2</span><span class="o">]/</span><span class="no">UIAScrollView</span><span class="o">[</span><span class="mi">1</span><span class="o">]/</span><span class="no">UIAButton</span><span class="o">[</span><span class="mi">2</span><span class="o">]</span>
</span></code></pre></td></tr></table></div></figure>


<h4>appium ruby console(arc)</h4>

<p><a href="https://github.com/appium/ruby_console">ruby_console</a>æ˜¯é’ˆå¯¹rubyæ‰“é€ çš„ä¸€ä¸ªconsoleç«¯çš„gemï¼Œä½¿ç”¨èµ·æ¥ä¹Ÿå¾ˆæ–¹ä¾¿ï¼Œç›´æ¥åœ¨consoleé‡Œä½¿ç”¨å‘½ä»¤arcå°±èƒ½å¯åŠ¨è®¾å¤‡ï¼Œä¸è¿‡ä»–å¹¶ä¸èƒ½è¯»å–æˆ‘ä»¬åœ¨appiumé‡Œé¢çš„é…ç½®ä¿¡æ¯ï¼Œæ‰€ä»¥éœ€è¦æˆ‘ä»¬æ‰‹åŠ¨åˆ›å»ºä¸€ä¸ªappium.txtæ–‡ä»¶ï¼Œåœ¨æ­¤æ–‡ä»¶ç›®å½•ä¸‹é¢å¯åŠ¨ï¼Œä¸‹é¢çš„android/iosçš„appium.txtæ–‡ä»¶</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1">#android</span>
</span><span class='line'><span class="o">[</span><span class="n">caps</span><span class="o">]</span>
</span><span class='line'><span class="n">platformName</span> <span class="o">=</span> <span class="s2">&quot;Android&quot;</span>
</span><span class='line'><span class="n">platformVersion</span> <span class="o">=</span> <span class="s1">&#39;5.1&#39;</span>
</span><span class='line'><span class="n">app</span> <span class="o">=</span> <span class="s2">&quot;/Users/xuyao/Downloads/Yydys0627.apk&quot;</span>
</span><span class='line'><span class="n">deviceName</span> <span class="o">=</span> <span class="s2">&quot;Android Simulator&quot;</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="c1">#ios</span>
</span><span class='line'><span class="o">[</span><span class="n">caps</span><span class="o">]</span>
</span><span class='line'><span class="n">platformName</span> <span class="o">=</span> <span class="s2">&quot;ios&quot;</span>
</span><span class='line'><span class="n">platformVersion</span> <span class="o">=</span> <span class="s1">&#39;8.2&#39;</span>
</span><span class='line'><span class="n">app</span> <span class="o">=</span> <span class="s2">&quot;/Users/xuyao/Downloads/Cloudoc-Patient.app&quot;</span>
</span><span class='line'><span class="n">deviceName</span> <span class="o">=</span> <span class="s2">&quot;iPhone Simulator&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="c1">#å¯åŠ¨arc</span>
</span><span class='line'><span class="err">âœ</span> <span class="n">ls</span>
</span><span class='line'><span class="n">appium</span><span class="o">.</span><span class="n">txt</span>
</span><span class='line'><span class="err">âœ</span> <span class="n">arc</span>
</span><span class='line'><span class="o">[</span><span class="mi">1</span><span class="o">]</span> <span class="n">pry</span><span class="p">(</span><span class="n">main</span><span class="p">)</span><span class="o">&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>å¯åŠ¨åï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡pageæ–¹æ³•æŸ¥çœ‹å½“å‰é¡µé¢æ‰€æœ‰çš„å…ƒç´ </p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="o">[</span><span class="mi">4</span><span class="o">]</span> <span class="n">pry</span><span class="p">(</span><span class="n">main</span><span class="p">)</span><span class="o">&gt;</span> <span class="n">page</span>
</span><span class='line'>
</span><span class='line'><span class="n">android</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="n">FrameLayout</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span class='line'>  <span class="nb">id</span><span class="p">:</span> <span class="ss">android</span><span class="p">:</span><span class="nb">id</span><span class="o">/</span><span class="n">content</span>
</span><span class='line'>
</span><span class='line'><span class="n">android</span><span class="o">.</span><span class="n">support</span><span class="o">.</span><span class="n">v4</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">ViewPager</span> <span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span class='line'>  <span class="nb">id</span><span class="p">:</span> <span class="n">com</span><span class="o">.</span><span class="n">yydys</span><span class="ss">:id</span><span class="o">/</span><span class="n">vp_welcome</span>
</span><span class='line'>
</span><span class='line'><span class="n">android</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="n">ImageView</span> <span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span class='line'>  <span class="nb">id</span><span class="p">:</span> <span class="n">com</span><span class="o">.</span><span class="n">yydys</span><span class="ss">:id</span><span class="o">/</span><span class="n">wel_img</span>
</span><span class='line'>
</span><span class='line'><span class="n">android</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="n">Button</span> <span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span class='line'>  <span class="ss">text</span><span class="p">:</span> <span class="err">é€›ä¸€é€›</span>
</span><span class='line'>  <span class="nb">id</span><span class="p">:</span> <span class="n">com</span><span class="o">.</span><span class="n">yydys</span><span class="ss">:id</span><span class="o">/</span><span class="n">direct_access</span>
</span><span class='line'>  <span class="n">strings</span><span class="o">.</span><span class="n">xml</span><span class="p">:</span> <span class="n">direct_access</span>
</span><span class='line'>
</span><span class='line'><span class="n">android</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="n">Button</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span class='line'>  <span class="ss">text</span><span class="p">:</span> <span class="err">ç™»å½•</span>
</span><span class='line'>  <span class="nb">id</span><span class="p">:</span> <span class="n">com</span><span class="o">.</span><span class="n">yydys</span><span class="ss">:id</span><span class="o">/</span><span class="n">immediate_experience</span>
</span><span class='line'>  <span class="n">strings</span><span class="o">.</span><span class="n">xml</span><span class="p">:</span> <span class="n">immediate_experience</span>
</span><span class='line'>               <span class="n">login</span>
</span><span class='line'><span class="kp">nil</span>
</span></code></pre></td></tr></table></div></figure>


<p>å¦‚æœè§‰å¾—é¡µé¢ä¿¡æ¯å¾ˆå¤šï¼Œæ‰¾ä¸åˆ°è‡ªå·±æƒ³è¦çš„æ§ä»¶ï¼Œpageæ–¹æ³•åé¢å¯ä»¥å¸¦ä¸ªå‚æ•°class_nameæ¥è¿‡æ»¤å…ƒç´ ï¼Œå¦‚ä¸‹</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="o">[</span><span class="mi">5</span><span class="o">]</span> <span class="n">pry</span><span class="p">(</span><span class="n">main</span><span class="p">)</span><span class="o">&gt;</span> <span class="n">page</span> <span class="ss">:Button</span>
</span><span class='line'>
</span><span class='line'><span class="n">android</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="n">Button</span> <span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span class='line'>  <span class="ss">text</span><span class="p">:</span> <span class="err">é€›ä¸€é€›</span>
</span><span class='line'>  <span class="nb">id</span><span class="p">:</span> <span class="n">com</span><span class="o">.</span><span class="n">yydys</span><span class="ss">:id</span><span class="o">/</span><span class="n">direct_access</span>
</span><span class='line'>  <span class="n">strings</span><span class="o">.</span><span class="n">xml</span><span class="p">:</span> <span class="n">direct_access</span>
</span><span class='line'>
</span><span class='line'><span class="n">android</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="n">Button</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span class='line'>  <span class="ss">text</span><span class="p">:</span> <span class="err">ç™»å½•</span>
</span><span class='line'>  <span class="nb">id</span><span class="p">:</span> <span class="n">com</span><span class="o">.</span><span class="n">yydys</span><span class="ss">:id</span><span class="o">/</span><span class="n">immediate_experience</span>
</span><span class='line'>  <span class="n">strings</span><span class="o">.</span><span class="n">xml</span><span class="p">:</span> <span class="n">immediate_experience</span>
</span><span class='line'>               <span class="n">login</span>
</span><span class='line'><span class="kp">nil</span>
</span></code></pre></td></tr></table></div></figure>


<p>è¿™æ ·å°±èƒ½æ‰¾åˆ°æŒ‰é’®çš„å…ƒç´ äº†</p>

<h6>find_element()æ–¹æ³•</h6>

<p>æ ¹æ®ä¸Šé¢çš„ä¿¡æ¯æˆ‘ä»¬å¯ä»¥é€šè¿‡find_elmentæ–¹æ³•æ¥æŸ¥æ‰¾android/iosä¸‹çš„xpath,æ¨¡æ‹Ÿç‚¹å‡»æ“ä½œ</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1">#android</span>
</span><span class='line'><span class="n">find_element</span><span class="p">(</span><span class="ss">xpath</span><span class="p">:</span> <span class="s2">&quot;//android.widget.LinearLayout[1]/android.widget.FrameLayout[1]/android.widget.LinearLayout[1]/android.widget.LinearLayout[1]/android.widget.LinearLayout[2]/android.widget.Button[2]&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">click</span>
</span><span class='line'><span class="c1">#androidæˆ‘ä»¬è¿˜å¯ä»¥æ ¹æ®ä»–çš„recource-idï¼Œæ¥æŸ¥æ‰¾ä»–çš„å”¯ä¸€æ§ä»¶</span>
</span><span class='line'><span class="n">find_element</span><span class="p">(</span><span class="nb">id</span><span class="p">:</span> <span class="s2">&quot;com.yydys:id/immediate_experience&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">click</span>
</span><span class='line'><span class="c1">#ios</span>
</span><span class='line'><span class="n">find_element</span><span class="p">(</span><span class="ss">xpath</span><span class="p">:</span> <span class="s2">&quot;//UIAApplication[1]/UIAWindow[2]/UIAScrollView[1]/UIAButton[2]&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">click</span>
</span><span class='line'><span class="c1">#å½“ç„¶ä½ ä¹Ÿå¯ä»¥é€šè¿‡class_nameæ¥æŸ¥æ‰¾ï¼Œå¦‚æœä¸€ä¸ªé¡µé¢ä¸Šæœ‰å¤šä¸ªç›¸åŒçš„class_name,ä¼šè¿”å›ç¬¬ä¸€ä¸ªtag</span>
</span><span class='line'><span class="n">find_element</span><span class="p">(</span><span class="ss">class_name</span><span class="p">:</span> <span class="s2">&quot;android.widget.Button&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">click</span>  <span class="c1">#android</span>
</span><span class='line'><span class="n">find_element</span><span class="p">(</span><span class="ss">class_name</span><span class="p">:</span> <span class="s2">&quot;UIAButton&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">click</span>
</span></code></pre></td></tr></table></div></figure>


<h6>button_exactæ–¹æ³•</h6>

<p>æœ‰æ—¶å€™æˆ‘ä»¬çŸ¥é“è¦æ‰¾ä¸€ä¸ªæŒ‰é’®ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ä½¿ç”¨button_exactæ¥ç›´æ¥æŸ¥æ‰¾ä¸€ä¸ªbutton,button_exactæ–¹æ³•ä¼šæ‰¾åˆ°ç¬¬ä¸€ä¸ªé…ç½®åˆ°çš„å…ƒç´ </p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="o">[</span><span class="mi">8</span><span class="o">]</span> <span class="n">pry</span><span class="p">(</span><span class="n">main</span><span class="p">)</span><span class="o">&gt;</span> <span class="n">button_exact</span><span class="p">(</span><span class="s2">&quot;ç™»å½•&quot;</span><span class="p">)</span>
</span><span class='line'><span class="c1">#&lt;Selenium::WebDriver::Element:0x5dffe05a97580bc2 id=&quot;3&quot;&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<h6>textfield_exact()æ–¹æ³•</h6>

<p>æ ¹æ®ç»™å®šçš„å€¼æ‰¾åˆ°EditText/TextFeildç¬¬ä¸€ä¸ªå…ƒç´ </p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="o">[</span><span class="mi">24</span><span class="o">]</span> <span class="n">pry</span><span class="p">(</span><span class="n">main</span><span class="p">)</span><span class="o">&gt;</span> <span class="n">textfield_exact</span><span class="p">(</span><span class="s2">&quot;com.yydys:id/login_input&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">type</span> <span class="s2">&quot;9123&quot;</span>
</span><span class='line'><span class="kp">true</span>
</span></code></pre></td></tr></table></div></figure>


<h6>exists()æ–¹æ³•</h6>

<p>æµ‹è¯•çš„æ—¶å€™ä¸€èˆ¬éœ€è¦åˆ¤æ–­æŸä¸ªå…ƒç´ æ˜¯å¦å­˜åœ¨ï¼Œå¯ä»¥ä½¿ç”¨exists</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="o">[</span><span class="mi">40</span><span class="o">]</span> <span class="n">pry</span><span class="p">(</span><span class="n">main</span><span class="p">)</span><span class="o">&gt;</span> <span class="n">exists</span><span class="p">{</span><span class="n">button_exact</span><span class="p">(</span><span class="s2">&quot;com.yydys:id/login_btn&quot;</span><span class="p">)}</span>
</span><span class='line'><span class="kp">true</span>
</span></code></pre></td></tr></table></div></figure>


<p>ä»¥ä¸Šå°±æ˜¯ä¸€äº›æ¯”è¾ƒå¸¸ç”¨çš„æ–¹æ³•ï¼Œä»¥åç”¨åˆ°å†æ›´æ–°ä¸€äº›æ–°çš„æ–¹æ³•</p>

<h5>å‚è€ƒèµ„æ–™</h5>

<p><a href="https://github.com/appium/ruby_lib/blob/master/docs/android_docs.md">https://github.com/appium/ruby_lib/blob/master/docs/android_docs.md</a><br/>
<a href="https://github.com/appium/ruby_lib/blob/master/docs/ios_docs.md">https://github.com/appium/ruby_lib/blob/master/docs/ios_docs.md</a><br/>
<a href="https://ruby-china.org/topics/30154">https://ruby-china.org/topics/30154</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Appè‡ªåŠ¨åŒ–æµ‹è¯•å¹³å°æ­å»ºè®°å½•ä¹‹Androidæ¨¡æ‹Ÿå™¨/çœŸæœºçš„é…ç½®]]></title>
    <link href="http://xuyao.club/blog/2016/07/10/app-test-automation-platform-building-record-of-how-to-setting-android-config/"/>
    <updated>2016-07-10T00:12:30+08:00</updated>
    <id>http://xuyao.club/blog/2016/07/10/app-test-automation-platform-building-record-of-how-to-setting-android-config</id>
    <content type="html"><![CDATA[<p>ä¸Šä¸€ç¯‡è®²äº†å®‰è£…appiumåŠiosçš„é…ç½®ï¼Œå¦‚æœæ²¡çœ‹è¿‡è¿™ç¯‡æ–‡ç« ï¼Œå»ºè®®å…ˆçœ‹ä¸€ä¸‹ï¼Œ<a href="http://www.jianshu.com/p/8ac5491436b2">ä¼ é€é—¨</a>
æ—¢ç„¶æ˜¯é…ç½®Androidæ¨¡æ‹Ÿå™¨ï¼Œé‚£ä¹ˆJavaå’ŒAndroid sdkçš„å®‰è£…æ˜¯å¿…ä¸å¯å°‘çš„äº†</p>

<!-- more -->


<h4>å®‰è£…Javaç¯å¢ƒ</h4>

<p>å®‰è£…Javaç¯å¢ƒå°±ä¸å¤šè®²äº†ï¼Œå¤§å®¶å„æ˜¾ç¥é€šå§</p>

<h4>å®‰è£…Android SDK</h4>

<p>åˆ°Android<a href="https://developer.android.com/studio/index.html">å®˜ç½‘</a>ï¼Œä¸‹è½½ä¸€ä¸ªmacç‰ˆçš„sdk,è§£å‹å‡ºæ¥
è¿›å…¥toolsæ–‡ä»¶å¤¹ï¼Œæ‰§è¡Œandroidæ–‡ä»¶ï¼Œå‡ºç°å¦‚ä¸‹ç•Œé¢ï¼Œé€‰æ‹©éœ€è¦å®‰è£…çš„ç‰ˆæœ¬
<img src="http://7xjibn.com1.z0.glb.clouddn.com/android_sdk_download.png" alt="android_sdk_download" />
ä¸‹è½½å®Œæˆå,è¿›å…¥android sdkç›®å½•ä¸‹é¢æ‰§è¡Œ</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">android</span> <span class="n">avd</span>
</span></code></pre></td></tr></table></div></figure>


<p>æ‰“å¼€android avdç®¡ç†ç•Œé¢ï¼Œæ·»åŠ ä¸€ä¸ªavdè®¾å¤‡
<img src="http://7xjibn.com1.z0.glb.clouddn.com/avd_manger.png" alt="avd_manger" />
<img src="http://7xjibn.com1.z0.glb.clouddn.com/create_avd.png" alt="create_avd" />
æ–°å»ºå®Œæˆåï¼Œå¯ä»¥å¯åŠ¨çœ‹ä¸€ä¸‹android è™šæ‹Ÿè®¾å¤‡<br/>
æœ€åè¿›å…¥platform-toolsä½¿ç”¨å‘½ä»¤ï¼ŒæŸ¥çœ‹å½“å‰çš„androidå¯ç”¨è®¾å¤‡
å¦‚æœæ˜¯çœŸæœºæµ‹è¯•çš„è¯ï¼Œä½¿ç”¨USBçº¿è¿æ¥ç”µè„‘ï¼Œæ‰“å¼€å¼€å‘è€…æ¨¡å¼ï¼ŒåŒæ„æ­¤ç”µè„‘è¿æ¥è®¾å¤‡ï¼Œappiumå¯åŠ¨æ—¶,ä¼šæŸ¥æ‰¾å½“å‰å¯ç”¨çš„androidè®¾å¤‡</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">adb</span> <span class="n">devices</span>
</span><span class='line'><span class="c1">#è¿™é‡Œä¼šæ˜¾ç¤ºå½“å‰å¯ç”¨çš„androidè®¾å¤‡</span>
</span><span class='line'><span class="no">List</span> <span class="n">of</span> <span class="n">devices</span> <span class="n">attached</span>
</span><span class='line'><span class="mi">88</span><span class="no">EKBME225K8</span>  <span class="n">device</span>
</span></code></pre></td></tr></table></div></figure>


<p>æœ€åé…ç½®ç¯å¢ƒå˜é‡ï¼Œç¯å¢ƒå˜é‡åŒ…æ‹¬JAVA_HOMEå’ŒANDROID_HOME
ç¼–è¾‘.profileï¼ˆå¦‚æœå®‰è£…äº†zshrcï¼Œåº”è¯¥æ˜¯.zshrcï¼‰
æ·»åŠ ä»¥ä¸‹ä»£ç </p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">export</span> <span class="no">ANDROID_HOME</span><span class="o">=</span><span class="sr">/Users/xu</span><span class="n">yao</span><span class="o">/</span><span class="no">Downloads</span><span class="o">/</span><span class="n">android</span><span class="o">-</span><span class="n">sdk</span><span class="o">-</span><span class="n">macosx</span>
</span><span class='line'><span class="n">export</span> <span class="no">JAVA_HOME</span><span class="o">=</span><span class="sr">/Library/</span><span class="no">Java</span><span class="o">/</span><span class="no">JavaVirtualMachines</span><span class="o">/</span><span class="n">jdk1</span><span class="o">.</span><span class="mi">8</span><span class="o">.</span><span class="mo">0_71</span><span class="o">.</span><span class="n">jdk</span><span class="o">/</span><span class="no">Contents</span><span class="o">/</span><span class="no">Home</span>
</span><span class='line'><span class="no">PATH</span><span class="o">=</span><span class="vg">$PATH</span><span class="ss">:/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">npm</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span>
</span><span class='line'><span class="no">PATH</span><span class="o">=</span><span class="vg">$PATH</span><span class="p">:</span><span class="vg">$ANDROID_HOME</span><span class="o">/</span><span class="n">build</span><span class="o">-</span><span class="n">tools</span>
</span><span class='line'><span class="no">PATH</span><span class="o">=</span><span class="vg">$PATH</span><span class="p">:</span><span class="vg">$ANDROID_HOME</span><span class="o">/</span><span class="n">platform</span><span class="o">-</span><span class="n">tools</span>
</span><span class='line'><span class="no">PATH</span><span class="o">=</span><span class="vg">$PATH</span><span class="p">:</span><span class="vg">$ANDROID_HOME</span><span class="o">/</span><span class="n">tools</span>
</span><span class='line'><span class="n">export</span> <span class="no">PATH</span>
</span></code></pre></td></tr></table></div></figure>


<p> <br/>
ä¿å­˜åï¼Œä¸ºä½¿å…¶ç”Ÿæ•ˆï¼Œéœ€è¦é‡æ–°sourcesä¸€ä¸‹,source .profile(.zshrc)<br/>
è¾“å‡ºä¸€ä¸‹ï¼Œæ£€æŸ¥æ˜¯å¦æˆåŠŸ</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">echo</span> <span class="vg">$ANDROID_HOME</span>
</span><span class='line'><span class="sr">/Users/xu</span><span class="n">yao</span><span class="o">/</span><span class="no">Downloads</span><span class="o">/</span><span class="n">android</span><span class="o">-</span><span class="n">sdk</span><span class="o">-</span><span class="n">macosx</span>
</span><span class='line'><span class="n">echo</span> <span class="vg">$JAVA_HOME</span>
</span><span class='line'><span class="sr">/Library/</span><span class="no">Java</span><span class="o">/</span><span class="no">JavaVirtualMachines</span><span class="o">/</span><span class="n">jdk1</span><span class="o">.</span><span class="mi">8</span><span class="o">.</span><span class="mo">0_71</span><span class="o">.</span><span class="n">jdk</span><span class="o">/</span><span class="no">Contents</span><span class="o">/</span><span class="no">Home</span>
</span></code></pre></td></tr></table></div></figure>


<p>ä¸€åˆ‡å‡†å¤‡å°±ç»ªï¼Œæ¥ä¸‹æ¥å°±å¼€å§‹åœ¨appiumé‡Œé…ç½®androidä¿¡æ¯äº†
<img src="http://7xjibn.com1.z0.glb.clouddn.com/android_config.png" alt="android_config" />
platform Versionté€‰æ‹©çš„æ—¶å€™ï¼Œå¦‚æœæ˜¯çœŸæœºæµ‹è¯•æ—¶ï¼Œç¡®å®šæ‰€é€‰ç‰ˆæœ¬å’Œæœºå­ä¸Šçš„androidç‰ˆæœ¬ä¸€æ ·ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚
é…ç½®å®Œæˆåï¼Œæ¥ä¸‹æ¥å°±æ˜¯å¯åŠ¨serverå’Œclient,è¿™é‡Œçš„æ­¥éª¤ä¸€iosæ˜¯ä¸€æ ·çš„ï¼Œå…·ä½“å¯æŸ¥çœ‹ä¸Šä¸€ç¯‡æ–‡ç« ï¼Œæˆªä¸€ä¸ªandroidç‰ˆæœ¬çš„clientå¯åŠ¨æˆåŠŸçš„Inspector guiçš„å›¾
<img src="http://7xjibn.com1.z0.glb.clouddn.com/android_inspect.png" alt="img" /></p>

<h6>æ³¨æ„çš„åœ°æ–¹</h6>

<p>å¦‚æœå¯åŠ¨clientçš„æ—¶å€™æŠ¥ä¸‹é¢çš„é”™</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="o">[</span><span class="no">MJSONWP</span><span class="o">]</span> <span class="no">Encountered</span> <span class="n">internal</span> <span class="n">error</span> <span class="n">running</span> <span class="ss">command</span><span class="p">:</span> <span class="ss">Error</span><span class="p">:</span> <span class="no">Could</span> <span class="ow">not</span> <span class="n">find</span> <span class="n">a</span> <span class="n">connected</span> <span class="no">Android</span> <span class="n">device</span><span class="o">.</span>
</span></code></pre></td></tr></table></div></figure>


<p>è¯´æ˜clientç«¯æ‰¾ä¸åˆ°å¯ä»¥è¿æ¥çš„androidè®¾å¤‡ï¼Œæ£€æŸ¥ä¸€ä¸‹avdæ˜¯å¦å¯åŠ¨æˆ–è€…çœŸæœºè¿æ¥æ˜¯å¦æ­£ç¡®</p>

<h6>å‚è€ƒèµ„æ–™</h6>

<p><a href="https://developer.android.com/studio/index.html">https://developer.android.com/studio/index.html</a></p>
]]></content>
  </entry>
  
</feed>
